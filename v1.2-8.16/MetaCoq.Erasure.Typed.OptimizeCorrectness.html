<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="../">Project Page</a>
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">Library MetaCoq.Erasure.Typed.OptimizeCorrectness</h1>

<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaCoq.Erasure.Typed</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaCoq.Erasure.Typed.Utils.html#"><span class="id" title="library">Utils</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaCoq.Erasure.Typed</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaCoq.Erasure.Typed.ClosedAux.html#"><span class="id" title="library">ClosedAux</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaCoq.Erasure.Typed</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#"><span class="id" title="library">ExAst</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaCoq.Erasure.Typed</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#"><span class="id" title="library">Optimize</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaCoq.Erasure.Typed</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaCoq.Erasure.Typed.Transform.html#"><span class="id" title="library">Transform</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaCoq.Erasure.Typed</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#"><span class="id" title="library">WcbvEvalAux</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.btauto.Btauto.html#"><span class="id" title="library">Btauto</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#"><span class="id" title="library">List</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.ssr.ssrbool.html#"><span class="id" title="library">ssrbool</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#"><span class="id" title="library">PeanoNat</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="keyword">Equations</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">Equations</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaCoq.Erasure</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaCoq.Erasure.EAstUtils.html#"><span class="id" title="library">EAstUtils</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaCoq.Erasure</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaCoq.Erasure.ECSubst.html#"><span class="id" title="library">ECSubst</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaCoq.Erasure</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaCoq.Erasure.EInduction.html#"><span class="id" title="library">EInduction</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaCoq.Erasure</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#"><span class="id" title="library">ELiftSubst</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaCoq.Erasure</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#"><span class="id" title="library">EWcbvEval</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaCoq.Erasure</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#"><span class="id" title="library">EGlobalEnv</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaCoq.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaCoq.Utils.MCList.html#"><span class="id" title="library">MCList</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaCoq.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaCoq.Utils.MCPrelude.html#"><span class="id" title="library">MCPrelude</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaCoq.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaCoq.Utils.utils.html#"><span class="id" title="library">utils</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaCoq.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#"><span class="id" title="library">All_Forall</span></a>.<br/>

<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#"><span class="id" title="module">ExAst</span></a>.<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="MetaCoq.Common.Kernames.html#"><span class="id" title="module">Kernames</span></a>.<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ListNotations"><span class="id" title="module">ListNotations</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="lookup_env_trans_env" class="idref" href="#lookup_env_trans_env"><span class="id" title="lemma">lookup_env_trans_env</span></a> <a id="0101b9beac487b383a5ba2a8f6922788" class="idref" href="#0101b9beac487b383a5ba2a8f6922788"><span class="id" title="binder">Σ</span></a> <a id="kn:2" class="idref" href="#kn:2"><span class="id" title="binder">kn</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#lookup_env"><span class="id" title="definition">EGlobalEnv.lookup_env</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#0101b9beac487b383a5ba2a8f6922788"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#kn:2"><span class="id" title="variable">kn</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#option_map"><span class="id" title="definition">option_map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_global_decl"><span class="id" title="definition">trans_global_decl</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#0101b9beac487b383a5ba2a8f6922788"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#kn:2"><span class="id" title="variable">kn</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Σ</span> <span class="id" title="keyword">as</span> [|((<span class="id" title="var">kn'</span> &amp; <span class="id" title="var">has_deps'</span>) &amp; <span class="id" title="var">cst'</span>) <span class="id" title="var">Σ</span> <span class="id" title="var">IH</span>]; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Utils.ReflectEq.html#eqb"><span class="id" title="method">ReflectEq.eqb</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaCoq.Common.Kernames.html#Kername.reflect_kername"><span class="id" title="instance">Kername.reflect_kername</span></a> <span class="id" title="keyword">as</span> [<span class="id" title="var">eq</span> <span class="id" title="var">Heq</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="var">Heq</span> <span class="id" title="var">kn</span> <span class="id" title="var">kn'</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="declared_constant_trans_env" class="idref" href="#declared_constant_trans_env"><span class="id" title="lemma">declared_constant_trans_env</span></a> <a id="eb9571817dd417966f307c3a9de8fe7f" class="idref" href="#eb9571817dd417966f307c3a9de8fe7f"><span class="id" title="binder">Σ</span></a> <a id="kn:4" class="idref" href="#kn:4"><span class="id" title="binder">kn</span></a> <a id="ecst:5" class="idref" href="#ecst:5"><span class="id" title="binder">ecst</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#declared_constant"><span class="id" title="definition">declared_constant</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#eb9571817dd417966f307c3a9de8fe7f"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#kn:4"><span class="id" title="variable">kn</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ecst:5"><span class="id" title="variable">ecst</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="cst:6" class="idref" href="#cst:6"><span class="id" title="binder">cst</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ecst:5"><span class="id" title="variable">ecst</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_cst"><span class="id" title="definition">trans_cst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#cst:6"><span class="id" title="variable">cst</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#eb9571817dd417966f307c3a9de8fe7f"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#kn:4"><span class="id" title="variable">kn</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#ConstantDecl"><span class="id" title="constructor">ConstantDecl</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#cst:6"><span class="id" title="variable">cst</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">∨</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="ta:7" class="idref" href="#ta:7"><span class="id" title="binder">ta</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ecst:5"><span class="id" title="variable">ecst</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">{|</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#cst_body"><span class="id" title="projection">EAst.cst_body</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#option_map"><span class="id" title="definition">option_map</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <a class="idref" href="MetaCoq.Erasure.EAst.html#tBox"><span class="id" title="constructor">tBox</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ta:7"><span class="id" title="variable">ta</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">|}</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#eb9571817dd417966f307c3a9de8fe7f"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#kn:4"><span class="id" title="variable">kn</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#TypeAliasDecl"><span class="id" title="constructor">TypeAliasDecl</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ta:7"><span class="id" title="variable">ta</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#declared_constant"><span class="id" title="definition">declared_constant</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_env_trans_env"><span class="id" title="lemma">lookup_env_trans_env</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">decl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> <span class="id" title="var">Σ</span> <span class="id" title="var">kn</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">cst</span>|]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [|<span class="id" title="tactic">congruence</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">cst</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [|<span class="id" title="tactic">congruence</span>|]; <span class="id" title="var">noconf</span> <span class="id" title="var">decl</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="dearg_lambdas_nil" class="idref" href="#dearg_lambdas_nil"><span class="id" title="lemma">dearg_lambdas_nil</span></a> <a id="t:8" class="idref" href="#t:8"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_lambdas"><span class="id" title="definition">dearg_lambdas</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:8"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:8"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt2</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
We use our own "properly ordered" contexts to represent the lambdas/lets
    that we debox away. Unlike the rest of MetaCoq, these contexts actually
    have the first declaration at the beginning. 
</div>
<div class="code">
<span class="id" title="keyword">Fixpoint</span> <a id="subst_context" class="idref" href="#subst_context"><span class="id" title="definition">subst_context</span></a> (<a id="t:9" class="idref" href="#t:9"><span class="id" title="binder">t</span></a> : <a class="idref" href="MetaCoq.Erasure.EAst.html#term"><span class="id" title="inductive">term</span></a>) (<a id="k:10" class="idref" href="#k:10"><span class="id" title="binder">k</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="8a5fb5e1be55058be9aa6b31d1a8bfab" class="idref" href="#8a5fb5e1be55058be9aa6b31d1a8bfab"><span class="id" title="binder">Γ</span></a> : <a class="idref" href="MetaCoq.Erasure.EAst.html#context"><span class="id" title="definition">context</span></a>) : <a class="idref" href="MetaCoq.Erasure.EAst.html#context"><span class="id" title="definition">context</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#8a5fb5e1be55058be9aa6b31d1a8bfab"><span class="id" title="variable">Γ</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">cd</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">Γ</span> ⇒ <a class="idref" href="MetaCoq.Erasure.EAst.html#map_decl"><span class="id" title="definition">map_decl</span></a> (<a class="idref" href="MetaCoq.Erasure.ECSubst.html#csubst"><span class="id" title="definition">csubst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:9"><span class="id" title="variable">t</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:10"><span class="id" title="variable">k</span></a>) <span class="id" title="var">cd</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#subst_context:12"><span class="id" title="definition">subst_context</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:9"><span class="id" title="variable">t</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:10"><span class="id" title="variable">k</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#8a5fb5e1be55058be9aa6b31d1a8bfab"><span class="id" title="variable">Γ</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="mkLambda_or_LetIn" class="idref" href="#mkLambda_or_LetIn"><span class="id" title="definition">mkLambda_or_LetIn</span></a> (<a id="cd:14" class="idref" href="#cd:14"><span class="id" title="binder">cd</span></a> : <a class="idref" href="MetaCoq.Erasure.EAst.html#context_decl"><span class="id" title="record">context_decl</span></a>) (<a id="t:15" class="idref" href="#t:15"><span class="id" title="binder">t</span></a> : <a class="idref" href="MetaCoq.Erasure.EAst.html#term"><span class="id" title="inductive">term</span></a>) : <a class="idref" href="MetaCoq.Erasure.EAst.html#term"><span class="id" title="inductive">term</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="MetaCoq.Erasure.EAst.html#decl_body"><span class="id" title="projection">decl_body</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#cd:14"><span class="id" title="variable">cd</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="MetaCoq.Erasure.EAst.html#tLambda"><span class="id" title="constructor">tLambda</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#decl_name"><span class="id" title="projection">decl_name</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#cd:14"><span class="id" title="variable">cd</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:15"><span class="id" title="variable">t</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">body</span> ⇒ <a class="idref" href="MetaCoq.Erasure.EAst.html#tLetIn"><span class="id" title="constructor">tLetIn</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#decl_name"><span class="id" title="projection">decl_name</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#cd:14"><span class="id" title="variable">cd</span></a>) <span class="id" title="var">body</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:15"><span class="id" title="variable">t</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="it_mkLambda_or_LetIn" class="idref" href="#it_mkLambda_or_LetIn"><span class="id" title="definition">it_mkLambda_or_LetIn</span></a> (<a id="a2b47ff948e41f039782f954507c588d" class="idref" href="#a2b47ff948e41f039782f954507c588d"><span class="id" title="binder">Γ</span></a> : <a class="idref" href="MetaCoq.Erasure.EAst.html#context"><span class="id" title="definition">context</span></a>) (<a id="u:17" class="idref" href="#u:17"><span class="id" title="binder">u</span></a> : <a class="idref" href="MetaCoq.Erasure.EAst.html#term"><span class="id" title="inductive">term</span></a>) : <a class="idref" href="MetaCoq.Erasure.EAst.html#term"><span class="id" title="inductive">term</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#fold_right"><span class="id" title="definition">fold_right</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mkLambda_or_LetIn"><span class="id" title="definition">mkLambda_or_LetIn</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#u:17"><span class="id" title="variable">u</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#a2b47ff948e41f039782f954507c588d"><span class="id" title="variable">Γ</span></a>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a id="decompose_body_masked" class="idref" href="#decompose_body_masked"><span class="id" title="definition">decompose_body_masked</span></a> (<a id="mask:18" class="idref" href="#mask:18"><span class="id" title="binder">mask</span></a> : <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#bitmask"><span class="id" title="definition">bitmask</span></a>) (<a id="t:19" class="idref" href="#t:19"><span class="id" title="binder">t</span></a> : <a class="idref" href="MetaCoq.Erasure.EAst.html#term"><span class="id" title="inductive">term</span></a>) : <a class="idref" href="MetaCoq.Erasure.EAst.html#context"><span class="id" title="definition">context</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#term"><span class="id" title="inductive">term</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:18"><span class="id" title="variable">mask</span></a>, <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:19"><span class="id" title="variable">t</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span>, <a class="idref" href="MetaCoq.Erasure.EAst.html#tLetIn"><span class="id" title="constructor">tLetIn</span></a> <span class="id" title="var">na</span> <span class="id" title="var">val</span> <span class="id" title="var">body</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<a id="417529803507aa9a7b30461ccba6fdf8" class="idref" href="#417529803507aa9a7b30461ccba6fdf8"><span class="id" title="binder">Γ</span></a>, <a id="t:24" class="idref" href="#t:24"><span class="id" title="binder">t</span></a>) := <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#decompose_body_masked:20"><span class="id" title="definition">decompose_body_masked</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:18"><span class="id" title="variable">mask</span></a> <span class="id" title="var">body</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.EAst.html#vdef"><span class="id" title="definition">vdef</span></a> <span class="id" title="var">na</span> <span class="id" title="var">val</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#417529803507aa9a7b30461ccba6fdf8"><span class="id" title="variable">Γ</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:24"><span class="id" title="variable">t</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">b</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">mask</span>, <a class="idref" href="MetaCoq.Erasure.EAst.html#tLambda"><span class="id" title="constructor">tLambda</span></a> <span class="id" title="var">na</span> <span class="id" title="var">body</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<a id="8ca488d962adcdfae0a5af1368ee12c6" class="idref" href="#8ca488d962adcdfae0a5af1368ee12c6"><span class="id" title="binder">Γ</span></a>, <a id="t:26" class="idref" href="#t:26"><span class="id" title="binder">t</span></a>) := <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#decompose_body_masked:20"><span class="id" title="definition">decompose_body_masked</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:18"><span class="id" title="variable">mask</span></a> <span class="id" title="var">body</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.EAst.html#vass"><span class="id" title="definition">vass</span></a> <span class="id" title="var">na</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#8ca488d962adcdfae0a5af1368ee12c6"><span class="id" title="variable">Γ</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:26"><span class="id" title="variable">t</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span>, <span class="id" title="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:19"><span class="id" title="variable">t</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="vasses" class="idref" href="#vasses"><span class="id" title="definition">vasses</span></a> (<a id="4832fec869a4ebb2d0fe43325389536a" class="idref" href="#4832fec869a4ebb2d0fe43325389536a"><span class="id" title="binder">Γ</span></a> : <a class="idref" href="MetaCoq.Erasure.EAst.html#context"><span class="id" title="definition">context</span></a>) : <a class="idref" href="MetaCoq.Erasure.EAst.html#context"><span class="id" title="definition">context</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> (<span class="id" title="keyword">fun</span> <a id="cd:28" class="idref" href="#cd:28"><span class="id" title="binder">cd</span></a> ⇒ <span class="id" title="keyword">match</span> <a class="idref" href="MetaCoq.Erasure.EAst.html#decl_body"><span class="id" title="projection">decl_body</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#cd:28"><span class="id" title="variable">cd</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#4832fec869a4ebb2d0fe43325389536a"><span class="id" title="variable">Γ</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="vasses_app" class="idref" href="#vasses_app"><span class="id" title="lemma">vasses_app</span></a> <a id="0b505d350bf3c4269fbe0253bf0ba4a2" class="idref" href="#0b505d350bf3c4269fbe0253bf0ba4a2"><span class="id" title="binder">Γ</span></a> <a id="5c1072b74adc63f2ae867cd1c05916b2" class="idref" href="#5c1072b74adc63f2ae867cd1c05916b2"><span class="id" title="binder">Γ'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#vasses"><span class="id" title="definition">vasses</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#0b505d350bf3c4269fbe0253bf0ba4a2"><span class="id" title="variable">Γ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#5c1072b74adc63f2ae867cd1c05916b2"><span class="id" title="variable">Γ'</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#vasses"><span class="id" title="definition">vasses</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#0b505d350bf3c4269fbe0253bf0ba4a2"><span class="id" title="variable">Γ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#vasses"><span class="id" title="definition">vasses</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#5c1072b74adc63f2ae867cd1c05916b2"><span class="id" title="variable">Γ'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#vasses"><span class="id" title="definition">vasses</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#filter_app"><span class="id" title="lemma">filter_app</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">refold</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <span class="id" title="keyword">context</span>[<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#fold_right"><span class="id" title="definition">fold_right</span></a> <span class="id" title="var">_</span> ?<span class="id" title="var">t</span> ?<span class="id" title="var">Γ</span>] |- <span class="id" title="var">_</span>] ⇒ <span class="id" title="tactic">progress</span> (<span class="id" title="tactic">fold</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#it_mkLambda_or_LetIn"><span class="id" title="definition">it_mkLambda_or_LetIn</span></a> <span class="id" title="var">Γ</span> <span class="id" title="var">t</span>) <span class="id" title="tactic">in</span> × )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" title="keyword">context</span>[<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#fold_right"><span class="id" title="definition">fold_right</span></a> <span class="id" title="var">_</span> ?<span class="id" title="var">t</span> ?<span class="id" title="var">Γ</span>]] ⇒ <span class="id" title="tactic">progress</span> (<span class="id" title="tactic">fold</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#it_mkLambda_or_LetIn"><span class="id" title="definition">it_mkLambda_or_LetIn</span></a> <span class="id" title="var">Γ</span> <span class="id" title="var">t</span>) <span class="id" title="tactic">in</span> × )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <span class="id" title="keyword">context</span>[<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> <span class="id" title="var">_</span> ?<span class="id" title="var">Γ</span>] |- <span class="id" title="var">_</span>] ⇒ <span class="id" title="tactic">progress</span> (<span class="id" title="tactic">fold</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#vasses"><span class="id" title="definition">vasses</span></a> <span class="id" title="var">Γ</span>) <span class="id" title="tactic">in</span> × )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" title="keyword">context</span>[<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> <span class="id" title="var">_</span> ?<span class="id" title="var">Γ</span>]] ⇒ <span class="id" title="tactic">progress</span> (<span class="id" title="tactic">fold</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#vasses"><span class="id" title="definition">vasses</span></a> <span class="id" title="var">Γ</span>) <span class="id" title="tactic">in</span> × )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="decompose_body_masked_spec" class="idref" href="#decompose_body_masked_spec"><span class="id" title="lemma">decompose_body_masked_spec</span></a> <a id="mask:31" class="idref" href="#mask:31"><span class="id" title="binder">mask</span></a> <a id="4956735a27db781e182b9ce86e32db7f" class="idref" href="#4956735a27db781e182b9ce86e32db7f"><span class="id" title="binder">Γ</span></a> <a id="t:33" class="idref" href="#t:33"><span class="id" title="binder">t</span></a> <a id="t':34" class="idref" href="#t':34"><span class="id" title="binder">t'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_dearg_mask"><span class="id" title="definition">valid_dearg_mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:31"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:33"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#4956735a27db781e182b9ce86e32db7f"><span class="id" title="variable">Γ</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t':34"><span class="id" title="variable">t'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#decompose_body_masked"><span class="id" title="definition">decompose_body_masked</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:31"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:33"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#vasses"><span class="id" title="definition">vasses</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#4956735a27db781e182b9ce86e32db7f"><span class="id" title="variable">Γ</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:31"><span class="id" title="variable">mask</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#it_mkLambda_or_LetIn"><span class="id" title="definition">it_mkLambda_or_LetIn</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#4956735a27db781e182b9ce86e32db7f"><span class="id" title="variable">Γ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t':34"><span class="id" title="variable">t'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:33"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">Γ</span> <span class="id" title="var">t'</span> <span class="id" title="var">mask</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="keyword">using</span> <a class="idref" href="MetaCoq.Erasure.EInduction.html#term_forall_list_ind"><span class="id" title="lemma">term_forall_list_ind</span></a>; <span class="id" title="tactic">intros</span> <span class="id" title="var">Γ</span> <span class="id" title="var">t'</span> <span class="id" title="var">mask</span> <span class="id" title="var">valid_mask</span> <span class="id" title="var">eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [<span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span>; [|<span class="id" title="var">easy</span>]; <span class="id" title="tactic">inversion</span> <span class="id" title="var">eq</span>; <span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">b</span> <span class="id" title="var">mask</span>]; <span class="id" title="tactic">inversion</span> <span class="id" title="var">eq</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">eq</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#decompose_body_masked"><span class="id" title="definition">decompose_body_masked</span></a> <span class="id" title="var">mask</span> <span class="id" title="var">t</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">Γ'</span> &amp; <span class="id" title="var">t''</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">decomp_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H0</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span> <span class="id" title="tactic">in</span> <span class="id" title="var">decomp_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">refold</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHt</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="MetaCoq.Utils.MCProd.html#proj2"><span class="id" title="definition">proj2</span></a> <span class="id" title="var">valid_mask</span>) <span class="id" title="var">decomp_eq</span>) <span class="id" title="keyword">as</span> (-&gt; &amp; -&gt;).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#decompose_body_masked"><span class="id" title="definition">decompose_body_masked</span></a> <span class="id" title="var">mask</span> <span class="id" title="var">t2</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">decomp_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span> <span class="id" title="tactic">in</span> <span class="id" title="var">decomp_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHt2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">valid_mask</span> <span class="id" title="var">decomp_eq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">eq</span>; <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="valid_dearg_mask_spec" class="idref" href="#valid_dearg_mask_spec"><span class="id" title="lemma">valid_dearg_mask_spec</span></a> <a id="mask:35" class="idref" href="#mask:35"><span class="id" title="binder">mask</span></a> <a id="t:36" class="idref" href="#t:36"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_dearg_mask"><span class="id" title="definition">valid_dearg_mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:35"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:36"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Utils.MCPrelude.html#cd4bc1b07c8b3bdc9f3bbc7941b56107"><span class="id" title="notation">∑</span></a> <a id="e7472af7950d19b56384d59fb0876e2e" class="idref" href="#e7472af7950d19b56384d59fb0876e2e"><span class="id" title="binder">Γ</span></a> <a id="inner:38" class="idref" href="#inner:38"><span class="id" title="binder">inner</span></a><a class="idref" href="MetaCoq.Utils.MCPrelude.html#cd4bc1b07c8b3bdc9f3bbc7941b56107"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#vasses"><span class="id" title="definition">vasses</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#e7472af7950d19b56384d59fb0876e2e"><span class="id" title="variable">Γ</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:35"><span class="id" title="variable">mask</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#it_mkLambda_or_LetIn"><span class="id" title="definition">it_mkLambda_or_LetIn</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#e7472af7950d19b56384d59fb0876e2e"><span class="id" title="variable">Γ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#inner:38"><span class="id" title="variable">inner</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:36"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">is_valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#decompose_body_masked"><span class="id" title="definition">decompose_body_masked</span></a> <span class="id" title="var">mask</span> <span class="id" title="var">t</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">Γ</span> &amp; <span class="id" title="var">inner</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">decomp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">∃</span> <span class="id" title="var">Γ</span>, <span class="id" title="var">inner</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#decompose_body_masked_spec"><span class="id" title="lemma">decompose_body_masked_spec</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.micromega.Lia.html#"><span class="id" title="module">Lia</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="subst_it_mkLambda_or_LetIn" class="idref" href="#subst_it_mkLambda_or_LetIn"><span class="id" title="lemma">subst_it_mkLambda_or_LetIn</span></a> <a id="t:39" class="idref" href="#t:39"><span class="id" title="binder">t</span></a> <a id="k:40" class="idref" href="#k:40"><span class="id" title="binder">k</span></a> <a id="2a787a075caaaff77edb51afaa922541" class="idref" href="#2a787a075caaaff77edb51afaa922541"><span class="id" title="binder">Γ</span></a> <a id="u:42" class="idref" href="#u:42"><span class="id" title="binder">u</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ECSubst.html#csubst"><span class="id" title="definition">csubst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:39"><span class="id" title="variable">t</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:40"><span class="id" title="variable">k</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#it_mkLambda_or_LetIn"><span class="id" title="definition">it_mkLambda_or_LetIn</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#2a787a075caaaff77edb51afaa922541"><span class="id" title="variable">Γ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#u:42"><span class="id" title="variable">u</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#it_mkLambda_or_LetIn"><span class="id" title="definition">it_mkLambda_or_LetIn</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#subst_context"><span class="id" title="definition">subst_context</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:39"><span class="id" title="variable">t</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:40"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#2a787a075caaaff77edb51afaa922541"><span class="id" title="variable">Γ</span></a>) (<a class="idref" href="MetaCoq.Erasure.ECSubst.html#csubst"><span class="id" title="definition">csubst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:39"><span class="id" title="variable">t</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:40"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#2a787a075caaaff77edb51afaa922541"><span class="id" title="variable">Γ</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#u:42"><span class="id" title="variable">u</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">t</span> <span class="id" title="var">k</span> <span class="id" title="var">u</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Γ</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">cd</span> <span class="id" title="var">Γ</span> <span class="id" title="var">IH</span>]; <span class="id" title="tactic">intros</span> <span class="id" title="var">t</span> <span class="id" title="var">k</span> <span class="id" title="var">u</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">refold</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">cd</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">na</span> [<span class="id" title="var">val</span>|]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">refold</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">f_equal</span>; <span class="id" title="tactic">rewrite</span> ?<span class="id" title="var">IH</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="length_subst_context" class="idref" href="#length_subst_context"><span class="id" title="lemma">length_subst_context</span></a> <a id="t:43" class="idref" href="#t:43"><span class="id" title="binder">t</span></a> <a id="k:44" class="idref" href="#k:44"><span class="id" title="binder">k</span></a> <a id="4ed02e109199bf6a9ed50eae935afb7c" class="idref" href="#4ed02e109199bf6a9ed50eae935afb7c"><span class="id" title="binder">Γ</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#subst_context"><span class="id" title="definition">subst_context</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:43"><span class="id" title="variable">t</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:44"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#4ed02e109199bf6a9ed50eae935afb7c"><span class="id" title="variable">Γ</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#4ed02e109199bf6a9ed50eae935afb7c"><span class="id" title="variable">Γ</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">t</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Γ</span>; [<span class="id" title="var">easy</span>|]; <span class="id" title="tactic">intros</span> <span class="id" title="var">t</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHΓ</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="is_dead_closed" class="idref" href="#is_dead_closed"><span class="id" title="lemma">is_dead_closed</span></a> <a id="k:46" class="idref" href="#k:46"><span class="id" title="binder">k</span></a> <a id="t:47" class="idref" href="#t:47"><span class="id" title="binder">t</span></a> <a id="n:48" class="idref" href="#n:48"><span class="id" title="binder">n</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">closedn</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:46"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:47"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:46"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:48"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:48"><span class="id" title="variable">n</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:47"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">k</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="keyword">using</span> <a class="idref" href="MetaCoq.Erasure.EInduction.html#term_forall_list_ind"><span class="id" title="lemma">term_forall_list_ind</span></a>; <span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">n'</span> <span class="id" title="var">clos</span> <span class="id" title="var">klen</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.eqb_spec"><span class="id" title="lemma">Nat.eqb_spec</span></a> <span class="id" title="var">n</span> <span class="id" title="var">n'</span>); <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">revert</span> <span class="id" title="var">k</span> <span class="id" title="var">n'</span> <span class="id" title="var">clos</span> <span class="id" title="var">klen</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|]; <span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">n'</span> <span class="id" title="var">clos</span> <span class="id" title="var">klen</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">revert</span> <span class="id" title="var">k</span> <span class="id" title="var">n'</span> <span class="id" title="var">clos</span> <span class="id" title="var">klen</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|]; <span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">n'</span> <span class="id" title="var">clos</span> <span class="id" title="var">klen</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHX</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="is_dead_csubst" class="idref" href="#is_dead_csubst"><span class="id" title="lemma">is_dead_csubst</span></a> <a id="k:49" class="idref" href="#k:49"><span class="id" title="binder">k</span></a> <a id="t:50" class="idref" href="#t:50"><span class="id" title="binder">t</span></a> <a id="u:51" class="idref" href="#u:51"><span class="id" title="binder">u</span></a> <a id="k':52" class="idref" href="#k':52"><span class="id" title="binder">k'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:49"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:50"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">closedn</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:49"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#u:51"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:49"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k':52"><span class="id" title="variable">k'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:49"><span class="id" title="variable">k</span></a> (<a class="idref" href="MetaCoq.Erasure.ECSubst.html#csubst"><span class="id" title="definition">csubst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#u:51"><span class="id" title="variable">u</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k':52"><span class="id" title="variable">k'</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:50"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">k</span> <span class="id" title="var">u</span> <span class="id" title="var">k'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="keyword">using</span> <a class="idref" href="MetaCoq.Erasure.EInduction.html#term_forall_list_ind"><span class="id" title="lemma">term_forall_list_ind</span></a>; <span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">u</span> <span class="id" title="var">k'</span> <span class="id" title="var">use_eq</span> <span class="id" title="var">clos</span> <span class="id" title="var">kltn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.compare_spec"><span class="id" title="lemma">Nat.compare_spec</span></a> <span class="id" title="var">k'</span> <span class="id" title="var">n</span>) <span class="id" title="keyword">as</span> [-&gt;| |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_dead_closed"><span class="id" title="lemma">is_dead_closed</span></a> <span class="id" title="keyword">with</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">IHt</span>; [<span class="id" title="var">easy</span>| |<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed_upwards"><span class="id" title="lemma">closed_upwards</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHt2</span>; [<span class="id" title="var">easy</span>| |<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed_upwards"><span class="id" title="lemma">closed_upwards</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHt2</span>; [<span class="id" title="var">easy</span>| |<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed_upwards"><span class="id" title="lemma">closed_upwards</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intuition</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">closedn</span></a> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">l0</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>) <span class="id" title="var">u</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed_upwards"><span class="id" title="lemma">closed_upwards</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">k</span> <span class="id" title="var">k'</span> <span class="id" title="var">kltn</span> <span class="id" title="var">use_eq</span> <span class="id" title="var">clos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|]; <span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">k'</span> <span class="id" title="var">kltn</span> <span class="id" title="var">use_eq</span> <span class="id" title="var">clos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">p</span>; [<span class="id" title="var">easy</span>| |<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed_upwards"><span class="id" title="lemma">closed_upwards</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>; [<span class="id" title="var">easy</span>|<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed_upwards"><span class="id" title="lemma">closed_upwards</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">k</span> <span class="id" title="var">k'</span> <span class="id" title="var">kltn</span> <span class="id" title="var">use_eq</span> <span class="id" title="var">clos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|]; <span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">k'</span> <span class="id" title="var">kltn</span> <span class="id" title="var">use_eq</span> <span class="id" title="var">clos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">p</span>; [<span class="id" title="var">easy</span>| |<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed_upwards"><span class="id" title="lemma">closed_upwards</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>; [<span class="id" title="var">easy</span>|<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed_upwards"><span class="id" title="lemma">closed_upwards</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="valid_dearg_mask_nil" class="idref" href="#valid_dearg_mask_nil"><span class="id" title="lemma">valid_dearg_mask_nil</span></a> <a id="t:53" class="idref" href="#t:53"><span class="id" title="binder">t</span></a> : <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_dearg_mask"><span class="id" title="definition">valid_dearg_mask</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:53"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">t</span>; <span class="id" title="var">easy</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="valid_dearg_mask_csubst" class="idref" href="#valid_dearg_mask_csubst"><span class="id" title="lemma">valid_dearg_mask_csubst</span></a> <a id="mask:54" class="idref" href="#mask:54"><span class="id" title="binder">mask</span></a> <a id="t:55" class="idref" href="#t:55"><span class="id" title="binder">t</span></a> <a id="u:56" class="idref" href="#u:56"><span class="id" title="binder">u</span></a> <a id="k:57" class="idref" href="#k:57"><span class="id" title="binder">k</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_dearg_mask"><span class="id" title="definition">valid_dearg_mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:54"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:55"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">closed</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#u:56"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_dearg_mask"><span class="id" title="definition">valid_dearg_mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:54"><span class="id" title="variable">mask</span></a> (<a class="idref" href="MetaCoq.Erasure.ECSubst.html#csubst"><span class="id" title="definition">csubst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#u:56"><span class="id" title="variable">u</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:57"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:55"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">mask</span> <span class="id" title="var">u</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="keyword">using</span> <a class="idref" href="MetaCoq.Erasure.EInduction.html#term_forall_list_ind"><span class="id" title="lemma">term_forall_list_ind</span></a>; <span class="id" title="tactic">intros</span> <span class="id" title="var">mask</span> <span class="id" title="var">u</span> <span class="id" title="var">k</span> <span class="id" title="var">valid_mask</span> <span class="id" title="var">clos</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_dearg_mask_nil"><span class="id" title="lemma">valid_dearg_mask_nil</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_dead_csubst"><span class="id" title="lemma">is_dead_csubst</span></a> 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHt</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="vasses_subst_context" class="idref" href="#vasses_subst_context"><span class="id" title="lemma">vasses_subst_context</span></a> <a id="t:58" class="idref" href="#t:58"><span class="id" title="binder">t</span></a> <a id="k:59" class="idref" href="#k:59"><span class="id" title="binder">k</span></a> <a id="0fd58672988bb7094daf640098f3cbf6" class="idref" href="#0fd58672988bb7094daf640098f3cbf6"><span class="id" title="binder">Γ</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#vasses"><span class="id" title="definition">vasses</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#subst_context"><span class="id" title="definition">subst_context</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:58"><span class="id" title="variable">t</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:59"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#0fd58672988bb7094daf640098f3cbf6"><span class="id" title="variable">Γ</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#vasses"><span class="id" title="definition">vasses</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#0fd58672988bb7094daf640098f3cbf6"><span class="id" title="variable">Γ</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">t</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Γ</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">cd</span> <span class="id" title="var">Γ</span> <span class="id" title="var">IH</span>]; [<span class="id" title="var">easy</span>|]; <span class="id" title="tactic">intros</span> <span class="id" title="var">t</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EAst.html#map_decl"><span class="id" title="definition">map_decl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">cd</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">decl_body</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="dearg_lambdas_subst" class="idref" href="#dearg_lambdas_subst"><span class="id" title="lemma">dearg_lambdas_subst</span></a> <a id="mask:61" class="idref" href="#mask:61"><span class="id" title="binder">mask</span></a> <a id="s:62" class="idref" href="#s:62"><span class="id" title="binder">s</span></a> <a id="k:63" class="idref" href="#k:63"><span class="id" title="binder">k</span></a> <a id="e5cc42bd50c62952777fbd1ca91d0e54" class="idref" href="#e5cc42bd50c62952777fbd1ca91d0e54"><span class="id" title="binder">Γ</span></a> <a id="inner:65" class="idref" href="#inner:65"><span class="id" title="binder">inner</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#vasses"><span class="id" title="definition">vasses</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#e5cc42bd50c62952777fbd1ca91d0e54"><span class="id" title="variable">Γ</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:61"><span class="id" title="variable">mask</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_lambdas"><span class="id" title="definition">dearg_lambdas</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:61"><span class="id" title="variable">mask</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:62"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:63"><span class="id" title="variable">k</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#it_mkLambda_or_LetIn"><span class="id" title="definition">it_mkLambda_or_LetIn</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#e5cc42bd50c62952777fbd1ca91d0e54"><span class="id" title="variable">Γ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#inner:65"><span class="id" title="variable">inner</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:62"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:63"><span class="id" title="variable">k</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_lambdas"><span class="id" title="definition">dearg_lambdas</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:61"><span class="id" title="variable">mask</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#it_mkLambda_or_LetIn"><span class="id" title="definition">it_mkLambda_or_LetIn</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#e5cc42bd50c62952777fbd1ca91d0e54"><span class="id" title="variable">Γ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#inner:65"><span class="id" title="variable">inner</span></a>)).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">mask</span> <span class="id" title="var">s</span> <span class="id" title="var">k</span> <span class="id" title="var">inner</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Γ</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">cd</span> <span class="id" title="var">Γ</span> <span class="id" title="var">IH</span>]; <span class="id" title="tactic">intros</span> <span class="id" title="var">mask</span> <span class="id" title="var">s</span> <span class="id" title="var">k</span> <span class="id" title="var">inner</span> <span class="id" title="var">len_eq</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_lambdas_nil"><span class="id" title="lemma">dearg_lambdas_nil</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">cd</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">na</span> [<span class="id" title="var">body</span>|]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">refold</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IH</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span> <span class="id" title="keyword">as</span> [|[] <span class="id" title="var">mask</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IH</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst1"><span class="id" title="definition">subst1</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> !<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#distr_subst"><span class="id" title="lemma">distr_subst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IH</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="dearg_single_masked" class="idref" href="#dearg_single_masked"><span class="id" title="lemma">dearg_single_masked</span></a> <a id="mask:66" class="idref" href="#mask:66"><span class="id" title="binder">mask</span></a> <a id="t:67" class="idref" href="#t:67"><span class="id" title="binder">t</span></a> <a id="args:68" class="idref" href="#args:68"><span class="id" title="binder">args</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:66"><span class="id" title="variable">mask</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:68"><span class="id" title="variable">args</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_single"><span class="id" title="definition">dearg_single</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:66"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:67"><span class="id" title="variable">t</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:68"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:67"><span class="id" title="variable">t</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#masked"><span class="id" title="definition">masked</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:66"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:68"><span class="id" title="variable">args</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">le</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">mask</span> <span class="id" title="tactic">in</span> <span class="id" title="var">mask</span>, <span class="id" title="var">t</span>, <span class="id" title="var">args</span>, <span class="id" title="var">le</span> |- ×.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">args</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">args</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">apply</span> <span class="id" title="var">IHmask</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="eval_dearg_lambdas_inv" class="idref" href="#eval_dearg_lambdas_inv"><span class="id" title="lemma">eval_dearg_lambdas_inv</span></a> {<a id="wfl:69" class="idref" href="#wfl:69"><span class="id" title="binder">wfl</span></a> : <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">WcbvFlags</span></a>} <a id="ac713e2c58df9c0a01be9ad130d8ea1a" class="idref" href="#ac713e2c58df9c0a01be9ad130d8ea1a"><span class="id" title="binder">Σ</span></a> <a id="mask:71" class="idref" href="#mask:71"><span class="id" title="binder">mask</span></a> <a id="28ac53edcd2fde0ab8b47fec9231c80a" class="idref" href="#28ac53edcd2fde0ab8b47fec9231c80a"><span class="id" title="binder">Γ</span></a> <a id="inner:73" class="idref" href="#inner:73"><span class="id" title="binder">inner</span></a> <a id="v:74" class="idref" href="#v:74"><span class="id" title="binder">v</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.ClosedAux.html#env_closed"><span class="id" title="definition">env_closed</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ac713e2c58df9c0a01be9ad130d8ea1a"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">closed</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#it_mkLambda_or_LetIn"><span class="id" title="definition">it_mkLambda_or_LetIn</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#28ac53edcd2fde0ab8b47fec9231c80a"><span class="id" title="variable">Γ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#inner:73"><span class="id" title="variable">inner</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:71"><span class="id" title="variable">mask</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#vasses"><span class="id" title="definition">vasses</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#28ac53edcd2fde0ab8b47fec9231c80a"><span class="id" title="variable">Γ</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ac713e2c58df9c0a01be9ad130d8ea1a"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">e</span></a><a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⊢</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_lambdas"><span class="id" title="definition">dearg_lambdas</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:71"><span class="id" title="variable">mask</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#it_mkLambda_or_LetIn"><span class="id" title="definition">it_mkLambda_or_LetIn</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#28ac53edcd2fde0ab8b47fec9231c80a"><span class="id" title="variable">Γ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#inner:73"><span class="id" title="variable">inner</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⇓</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#v:74"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Utils.MCPrelude.html#cd4bc1b07c8b3bdc9f3bbc7941b56107"><span class="id" title="notation">∑</span></a> <a id="tv:75" class="idref" href="#tv:75"><span class="id" title="binder">tv</span></a><a class="idref" href="MetaCoq.Utils.MCPrelude.html#cd4bc1b07c8b3bdc9f3bbc7941b56107"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ac713e2c58df9c0a01be9ad130d8ea1a"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">e</span></a><a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⊢</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#it_mkLambda_or_LetIn"><span class="id" title="definition">it_mkLambda_or_LetIn</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#28ac53edcd2fde0ab8b47fec9231c80a"><span class="id" title="variable">Γ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#inner:73"><span class="id" title="variable">inner</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⇓</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#tv:75"><span class="id" title="variable">tv</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">env_clos</span> <span class="id" title="var">clos</span> <span class="id" title="var">len_eq</span> <span class="id" title="var">ev</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">Γ</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <span class="id" title="keyword">as</span> [|<span class="id" title="var">Γlen</span> <span class="id" title="var">IH</span>] <span class="id" title="var">eqn</span>:<span class="id" title="var">Γlen_eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Γ</span>, <span class="id" title="var">mask</span>, <span class="id" title="var">inner</span>, <span class="id" title="var">v</span>, <span class="id" title="var">clos</span>, <span class="id" title="var">len_eq</span>, <span class="id" title="var">ev</span> |- ×.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">Γ</span>, <span class="id" title="var">mask</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_lambdas_nil"><span class="id" title="lemma">dearg_lambdas_nil</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">Γ</span> <span class="id" title="keyword">as</span> [|[<span class="id" title="var">na</span> [<span class="id" title="var">body</span>|]] <span class="id" title="var">Γ</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">refold</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#eval_tLetIn_inv"><span class="id" title="lemma">eval_tLetIn_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">bodyv</span> &amp; <span class="id" title="var">ev_body</span> &amp; <span class="id" title="var">ev_let</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">closed</span></a> <span class="id" title="var">bodyv</span>) <span class="id" title="tactic">by</span> (<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_closed"><span class="id" title="lemma">eval_closed</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.ECSubst.html#closed_subst"><span class="id" title="lemma">closed_subst</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev_let</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_lambdas_subst"><span class="id" title="lemma">dearg_lambdas_subst</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev_let</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.ECSubst.html#closed_subst"><span class="id" title="lemma">closed_subst</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev_let</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#subst_it_mkLambda_or_LetIn"><span class="id" title="lemma">subst_it_mkLambda_or_LetIn</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev_let</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ev_let</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">tv</span> &amp; <span class="id" title="var">ev_tv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">∃</span> <span class="id" title="var">tv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#subst_it_mkLambda_or_LetIn"><span class="id" title="lemma">subst_it_mkLambda_or_LetIn</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev_tv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#subst_it_mkLambda_or_LetIn"><span class="id" title="lemma">subst_it_mkLambda_or_LetIn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.ECSubst.html#closed_csubst"><span class="id" title="lemma">closed_csubst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#vasses_subst_context"><span class="id" title="lemma">vasses_subst_context</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#length_subst_context"><span class="id" title="lemma">length_subst_context</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span> <span class="id" title="keyword">as</span> [|[] <span class="id" title="var">mask</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_atom"><span class="id" title="constructor">eval_atom</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_atom"><span class="id" title="constructor">eval_atom</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="no_use_subst" class="idref" href="#no_use_subst"><span class="id" title="lemma">no_use_subst</span></a> <a id="k:76" class="idref" href="#k:76"><span class="id" title="binder">k</span></a> <a id="t:77" class="idref" href="#t:77"><span class="id" title="binder">t</span></a> <a id="s:78" class="idref" href="#s:78"><span class="id" title="binder">s</span></a> <a id="s':79" class="idref" href="#s':79"><span class="id" title="binder">s'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:76"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:77"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:78"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:76"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:77"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s':79"><span class="id" title="variable">s'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:76"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:77"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="keyword">using</span> <a class="idref" href="MetaCoq.Erasure.EInduction.html#term_forall_list_ind"><span class="id" title="lemma">term_forall_list_ind</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">no_use</span>; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.leb_spec"><span class="id" title="lemma">Nat.leb_spec</span></a> <span class="id" title="var">k</span> <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> !(<a class="idref" href="MetaCoq.Utils.MCProd.html#proj2"><span class="id" title="definition">proj2</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error_None"><span class="id" title="lemma">nth_error_None</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)) <span class="id" title="tactic">by</span> (<span class="id" title="var">cbn</span>; <span class="id" title="var">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="var">propify</span>;<span class="id" title="tactic">intuition</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">f_equal</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">no_use</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">_</span> &amp; <span class="id" title="var">no_use</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>;<span class="id" title="tactic">inversion</span> <span class="id" title="var">no_use</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">k</span> <span class="id" title="var">no_use</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|]; <span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">no_use</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EAst.html#map_def"><span class="id" title="definition">map_def</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<a class="idref" href="MetaCoq.Utils.MCProd.html#proj1"><span class="id" title="definition">proj1</span></a> <span class="id" title="var">no_use</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">k</span> <span class="id" title="var">no_use</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|]; <span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">no_use</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EAst.html#map_def"><span class="id" title="definition">map_def</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<a class="idref" href="MetaCoq.Utils.MCProd.html#proj1"><span class="id" title="definition">proj1</span></a> <span class="id" title="var">no_use</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="masked_nil" class="idref" href="#masked_nil"><span class="id" title="lemma">masked_nil</span></a> {<a id="X:80" class="idref" href="#X:80"><span class="id" title="binder">X</span></a>} <a id="mask:81" class="idref" href="#mask:81"><span class="id" title="binder">mask</span></a> :<br/>
&nbsp;&nbsp;@<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#masked"><span class="id" title="definition">masked</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#X:80"><span class="id" title="variable">X</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:81"><span class="id" title="variable">mask</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span> <span class="id" title="keyword">as</span> [|[] ?]. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="All2_masked" class="idref" href="#All2_masked"><span class="id" title="lemma">All2_masked</span></a> {<a id="X:82" class="idref" href="#X:82"><span class="id" title="binder">X</span></a> <a id="Y:83" class="idref" href="#Y:83"><span class="id" title="binder">Y</span></a>} {<a id="T:84" class="idref" href="#T:84"><span class="id" title="binder">T</span></a> : <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#X:82"><span class="id" title="variable">X</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#Y:83"><span class="id" title="variable">Y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Type</span>} <a id="xs:85" class="idref" href="#xs:85"><span class="id" title="binder">xs</span></a> <a id="ys:86" class="idref" href="#ys:86"><span class="id" title="binder">ys</span></a> <a id="mask:87" class="idref" href="#mask:87"><span class="id" title="binder">mask</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Utils.All_Forall.html#All2"><span class="id" title="inductive">All2</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#T:84"><span class="id" title="variable">T</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#xs:85"><span class="id" title="variable">xs</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ys:86"><span class="id" title="variable">ys</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Utils.All_Forall.html#All2"><span class="id" title="inductive">All2</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#T:84"><span class="id" title="variable">T</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#masked"><span class="id" title="definition">masked</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:87"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#xs:85"><span class="id" title="variable">xs</span></a>) (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#masked"><span class="id" title="definition">masked</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:87"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ys:86"><span class="id" title="variable">ys</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">all</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">all</span> <span class="id" title="tactic">in</span> <span class="id" title="var">mask</span> |- ×.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> !<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#masked_nil"><span class="id" title="lemma">masked_nil</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span> <span class="id" title="keyword">as</span> [|[] <span class="id" title="var">mask</span>]; [<span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>| |]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="dearg_lambdas_correct" class="idref" href="#dearg_lambdas_correct"><span class="id" title="lemma">dearg_lambdas_correct</span></a> {<a id="wfl:88" class="idref" href="#wfl:88"><span class="id" title="binder">wfl</span></a> : <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">WcbvFlags</span></a>} <a id="c51b7ec861f7c17647e5cb8afff8d01c" class="idref" href="#c51b7ec861f7c17647e5cb8afff8d01c"><span class="id" title="binder">Σ</span></a> <a id="body:90" class="idref" href="#body:90"><span class="id" title="binder">body</span></a> <a id="args:91" class="idref" href="#args:91"><span class="id" title="binder">args</span></a> <a id="mask:92" class="idref" href="#mask:92"><span class="id" title="binder">mask</span></a> <a id="v:93" class="idref" href="#v:93"><span class="id" title="binder">v</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.ClosedAux.html#env_closed"><span class="id" title="definition">env_closed</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c51b7ec861f7c17647e5cb8afff8d01c"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">closed</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#body:90"><span class="id" title="variable">body</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">closedn</span></a> 0) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:91"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_dearg_mask"><span class="id" title="definition">valid_dearg_mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:92"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#body:90"><span class="id" title="variable">body</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:92"><span class="id" title="variable">mask</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:91"><span class="id" title="variable">args</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c51b7ec861f7c17647e5cb8afff8d01c"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">e</span></a><a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⊢</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#body:90"><span class="id" title="variable">body</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:91"><span class="id" title="variable">args</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⇓</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#v:93"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c51b7ec861f7c17647e5cb8afff8d01c"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">e</span></a><a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⊢</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_lambdas"><span class="id" title="definition">dearg_lambdas</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:92"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#body:90"><span class="id" title="variable">body</span></a>) (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#masked"><span class="id" title="definition">masked</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:92"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:91"><span class="id" title="variable">args</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⇓</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#v:93"><span class="id" title="variable">v</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">env_clos</span> <span class="id" title="var">body_clos</span> <span class="id" title="var">args_clos</span> <span class="id" title="var">valid_mask</span> <span class="id" title="var">l</span> <span class="id" title="var">ev</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_dearg_mask_spec"><span class="id" title="lemma">valid_dearg_mask_spec</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">valid_mask</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">Γ</span> &amp; <span class="id" title="var">inner</span> &amp; <span class="id" title="var">vasses_len</span> &amp; &lt;-).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">Γ</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <span class="id" title="keyword">as</span> [|<span class="id" title="var">Γlen</span> <span class="id" title="var">IH</span>] <span class="id" title="var">eqn</span>:<span class="id" title="var">eq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span> <span class="id" title="var">Γ</span>, <span class="id" title="var">mask</span>, <span class="id" title="var">valid_mask</span>, <span class="id" title="var">args</span>, <span class="id" title="var">body_clos</span>, <span class="id" title="var">args_clos</span>, <span class="id" title="var">inner</span>, <span class="id" title="var">ev</span>, <span class="id" title="var">l</span>, <span class="id" title="var">vasses_len</span> |- ×.<br/>
&nbsp;&nbsp;1: { <span class="id" title="tactic">destruct</span> <span class="id" title="var">Γ</span>, <span class="id" title="var">mask</span>, <span class="id" title="var">args</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_lambdas_nil"><span class="id" title="lemma">dearg_lambdas_nil</span></a>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Γ</span> <span class="id" title="keyword">as</span> [|[<span class="id" title="var">na</span> [<span class="id" title="var">body</span>|]] <span class="id" title="var">Γ</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">refold</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#eval_mkApps_head"><span class="id" title="lemma">eval_mkApps_head</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev</span> <span class="id" title="keyword">as</span> <span class="id" title="var">ev_let</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ev_let</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">letv</span> &amp; <span class="id" title="var">ev_let</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#eval_tLetIn_inv"><span class="id" title="lemma">eval_tLetIn_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev_let</span> <span class="id" title="keyword">as</span> <span class="id" title="var">ev_subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ev_subst</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">bodyv</span> &amp; <span class="id" title="var">ev_body</span> &amp; <span class="id" title="var">ev_subst</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">closed</span></a> <span class="id" title="var">bodyv</span>) <span class="id" title="tactic">by</span> (<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_closed"><span class="id" title="lemma">eval_closed</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="var">epose</span> <span class="id" title="var">proof</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">IH</span> <span class="id" title="var">args</span> <span class="id" title="var">mask</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#subst_context"><span class="id" title="definition">subst_context</span></a> <span class="id" title="var">bodyv</span> 0 <span class="id" title="var">Γ</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaCoq.Erasure.ECSubst.html#csubst"><span class="id" title="definition">csubst</span></a> <span class="id" title="var">bodyv</span> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">Γ</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <span class="id" title="var">inner</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#subst_it_mkLambda_or_LetIn"><span class="id" title="lemma">subst_it_mkLambda_or_LetIn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.ECSubst.html#closed_csubst"><span class="id" title="lemma">closed_csubst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#subst_it_mkLambda_or_LetIn"><span class="id" title="lemma">subst_it_mkLambda_or_LetIn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_dearg_mask_csubst"><span class="id" title="lemma">valid_dearg_mask_csubst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#subst_it_mkLambda_or_LetIn"><span class="id" title="lemma">subst_it_mkLambda_or_LetIn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#eval_mkApps_heads"><span class="id" title="lemma">eval_mkApps_heads</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">letv</span>); [<span class="id" title="var">easy</span>|<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#eval_mkApps_heads"><span class="id" title="lemma">eval_mkApps_heads</span></a>; [<span class="id" title="tactic">exact</span> <span class="id" title="var">ev_let</span>| |]; <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#vasses_subst_context"><span class="id" title="lemma">vasses_subst_context</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#length_subst_context"><span class="id" title="lemma">length_subst_context</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#subst_it_mkLambda_or_LetIn"><span class="id" title="lemma">subst_it_mkLambda_or_LetIn</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#eval_mkApps_head"><span class="id" title="lemma">eval_mkApps_head</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> <span class="id" title="var">ev_top</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ev_top</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">topv</span> &amp; <span class="id" title="var">ev_top</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#subst_it_mkLambda_or_LetIn"><span class="id" title="lemma">subst_it_mkLambda_or_LetIn</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev_top</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#eval_dearg_lambdas_inv"><span class="id" title="lemma">eval_dearg_lambdas_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev_top</span> <span class="id" title="keyword">as</span> <span class="id" title="var">ev_sub_top</span>; <span class="id" title="var">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#subst_it_mkLambda_or_LetIn"><span class="id" title="lemma">subst_it_mkLambda_or_LetIn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.ECSubst.html#closed_csubst"><span class="id" title="lemma">closed_csubst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#vasses_subst_context"><span class="id" title="lemma">vasses_subst_context</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">destruct</span> <span class="id" title="var">ev_sub_top</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">sub_top</span> &amp; <span class="id" title="var">ev_sub_top</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#subst_it_mkLambda_or_LetIn"><span class="id" title="lemma">subst_it_mkLambda_or_LetIn</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev_top</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#eval_mkApps_heads"><span class="id" title="lemma">eval_mkApps_heads</span></a>; [| |<span class="id" title="var">now</span> <span class="id" title="tactic">eauto</span>]; [<span class="id" title="var">now</span> <span class="id" title="tactic">eauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">econstructor</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="MetaCoq.Erasure.ECSubst.html#closed_subst"><span class="id" title="lemma">closed_subst</span></a> <span class="id" title="tactic">in</span> × <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_lambdas_subst"><span class="id" title="lemma">dearg_lambdas_subst</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">b</span> <span class="id" title="var">mask</span>]; [<span class="id" title="var">easy</span>|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">refold</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">args</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">args</span>]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#eval_mkApps_head"><span class="id" title="lemma">eval_mkApps_head</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev</span> <span class="id" title="keyword">as</span> <span class="id" title="var">ev_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ev_app</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">appv</span> &amp; <span class="id" title="var">ev_app</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#eval_tApp_tLambda_inv"><span class="id" title="lemma">eval_tApp_tLambda_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev_app</span> <span class="id" title="keyword">as</span> <span class="id" title="var">ev_subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ev_subst</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">av</span> &amp; <span class="id" title="var">ev_a</span> &amp; <span class="id" title="var">ev_subst</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">closed</span></a> <span class="id" title="var">av</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall_inv"><span class="id" title="lemma">Forall_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">args_clos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_closed"><span class="id" title="lemma">eval_closed</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="var">epose</span> <span class="id" title="var">proof</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">IH</span> <span class="id" title="var">args</span> <span class="id" title="var">mask</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#subst_context"><span class="id" title="definition">subst_context</span></a> <span class="id" title="var">av</span> 0 <span class="id" title="var">Γ</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaCoq.Erasure.ECSubst.html#csubst"><span class="id" title="definition">csubst</span></a> <span class="id" title="var">av</span> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">Γ</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <span class="id" title="var">inner</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#subst_it_mkLambda_or_LetIn"><span class="id" title="lemma">subst_it_mkLambda_or_LetIn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.ECSubst.html#closed_csubst"><span class="id" title="lemma">closed_csubst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall_inv_tail"><span class="id" title="lemma">Forall_inv_tail</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">args_clos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#subst_it_mkLambda_or_LetIn"><span class="id" title="lemma">subst_it_mkLambda_or_LetIn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_dearg_mask_csubst"><span class="id" title="lemma">valid_dearg_mask_csubst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#subst_it_mkLambda_or_LetIn"><span class="id" title="lemma">subst_it_mkLambda_or_LetIn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#eval_mkApps_heads"><span class="id" title="lemma">eval_mkApps_heads</span></a>; [<span class="id" title="tactic">exact</span> <span class="id" title="var">ev_app</span>| |]; <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#vasses_subst_context"><span class="id" title="lemma">vasses_subst_context</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#length_subst_context"><span class="id" title="lemma">length_subst_context</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#eval_mkApps_head"><span class="id" title="lemma">eval_mkApps_head</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> <span class="id" title="var">ev_top</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ev_top</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">topv</span> &amp; <span class="id" title="var">ev_top</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#eval_dearg_lambdas_inv"><span class="id" title="lemma">eval_dearg_lambdas_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev_top</span> <span class="id" title="keyword">as</span> <span class="id" title="var">ev_sub_top</span>; <span class="id" title="var">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#subst_it_mkLambda_or_LetIn"><span class="id" title="lemma">subst_it_mkLambda_or_LetIn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.ECSubst.html#closed_csubst"><span class="id" title="lemma">closed_csubst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#vasses_subst_context"><span class="id" title="lemma">vasses_subst_context</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#subst_it_mkLambda_or_LetIn"><span class="id" title="lemma">subst_it_mkLambda_or_LetIn</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ev_sub_top</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">sub_top</span> &amp; <span class="id" title="var">ev_sub_top</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="MetaCoq.Erasure.ECSubst.html#closed_subst"><span class="id" title="lemma">closed_subst</span></a> <span class="id" title="tactic">in</span> × <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#eval_mkApps_heads"><span class="id" title="lemma">eval_mkApps_heads</span></a>; [| |<span class="id" title="var">now</span> <span class="id" title="tactic">eauto</span>]; [<span class="id" title="var">now</span> <span class="id" title="tactic">eauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst1"><span class="id" title="definition">subst1</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_lambdas_subst"><span class="id" title="lemma">dearg_lambdas_subst</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">erewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#no_use_subst"><span class="id" title="lemma">no_use_subst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#eval_mkApps_heads"><span class="id" title="lemma">eval_mkApps_heads</span></a>; [| |<span class="id" title="var">now</span> <span class="id" title="tactic">eauto</span>]; [<span class="id" title="var">now</span> <span class="id" title="tactic">eauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_lambdas_subst"><span class="id" title="lemma">dearg_lambdas_subst</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev_top</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.ECSubst.html#closed_subst"><span class="id" title="lemma">closed_subst</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev_top</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_beta"><span class="id" title="constructor">eval_beta</span></a>; [|<span class="id" title="var">easy</span>|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_atom"><span class="id" title="constructor">eval_atom</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="dearg_correct" class="idref" href="#dearg_correct"><span class="id" title="section">dearg_correct</span></a>.<br/>
<span class="id" title="keyword">Context</span> (<a id="ind_masks:94" class="idref" href="#ind_masks:94"><span class="id" title="binder">ind_masks</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="MetaCoq.Common.Kernames.html#kername"><span class="id" title="definition">kername</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#mib_masks"><span class="id" title="record">mib_masks</span></a>)).<br/>
<span class="id" title="keyword">Context</span> (<a id="const_masks:95" class="idref" href="#const_masks:95"><span class="id" title="binder">const_masks</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="MetaCoq.Common.Kernames.html#kername"><span class="id" title="definition">kername</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#bitmask"><span class="id" title="definition">bitmask</span></a>)).<br/>
<span class="id" title="keyword">Notation</span> <a id="get_ctor_mask" class="idref" href="#get_ctor_mask"><span class="id" title="abbreviation">get_ctor_mask</span></a> := (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#get_ctor_mask"><span class="id" title="definition">get_ctor_mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a id="get_mib_masks" class="idref" href="#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> := (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#get_mib_masks"><span class="id" title="definition">get_mib_masks</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a id="get_const_mask" class="idref" href="#get_const_mask"><span class="id" title="abbreviation">get_const_mask</span></a> := (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#get_const_mask"><span class="id" title="definition">get_const_mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.const_masks"><span class="id" title="variable">const_masks</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a id="dearg" class="idref" href="#dearg"><span class="id" title="abbreviation">dearg</span></a> := (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg"><span class="id" title="definition">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.const_masks"><span class="id" title="variable">const_masks</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a id="dearg_aux" class="idref" href="#dearg_aux"><span class="id" title="abbreviation">dearg_aux</span></a> := (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_aux"><span class="id" title="definition">dearg_aux</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.const_masks"><span class="id" title="variable">const_masks</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a id="dearg_env" class="idref" href="#dearg_env"><span class="id" title="abbreviation">dearg_env</span></a> := (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_env"><span class="id" title="definition">dearg_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.const_masks"><span class="id" title="variable">const_masks</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a id="dearg_decl" class="idref" href="#dearg_decl"><span class="id" title="abbreviation">dearg_decl</span></a> := (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_decl"><span class="id" title="definition">dearg_decl</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.const_masks"><span class="id" title="variable">const_masks</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a id="dearg_cst" class="idref" href="#dearg_cst"><span class="id" title="abbreviation">dearg_cst</span></a> := (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_cst"><span class="id" title="definition">dearg_cst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.const_masks"><span class="id" title="variable">const_masks</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a id="dearg_case" class="idref" href="#dearg_case"><span class="id" title="abbreviation">dearg_case</span></a> := (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_case"><span class="id" title="definition">dearg_case</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a id="dearg_proj" class="idref" href="#dearg_proj"><span class="id" title="abbreviation">dearg_proj</span></a> := (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_proj"><span class="id" title="definition">dearg_proj</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a id="valid_case_masks" class="idref" href="#valid_case_masks"><span class="id" title="abbreviation">valid_case_masks</span></a> := (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_case_masks"><span class="id" title="definition">valid_case_masks</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a id="valid_proj" class="idref" href="#valid_proj"><span class="id" title="abbreviation">valid_proj</span></a> := (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_proj"><span class="id" title="definition">valid_proj</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a id="valid_cases" class="idref" href="#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> := (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_cases"><span class="id" title="definition">valid_cases</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a id="valid_masks_decl" class="idref" href="#valid_masks_decl"><span class="id" title="abbreviation">valid_masks_decl</span></a> := (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_masks_decl"><span class="id" title="definition">valid_masks_decl</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.const_masks"><span class="id" title="variable">const_masks</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a id="valid_masks_env" class="idref" href="#valid_masks_env"><span class="id" title="abbreviation">valid_masks_env</span></a> := (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_masks_env"><span class="id" title="definition">valid_masks_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.const_masks"><span class="id" title="variable">const_masks</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a id="is_expanded_aux" class="idref" href="#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> := (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_expanded_aux"><span class="id" title="definition">is_expanded_aux</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.const_masks"><span class="id" title="variable">const_masks</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a id="is_expanded" class="idref" href="#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> := (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_expanded"><span class="id" title="definition">is_expanded</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.const_masks"><span class="id" title="variable">const_masks</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a id="is_expanded_env" class="idref" href="#is_expanded_env"><span class="id" title="abbreviation">is_expanded_env</span></a> := (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_expanded_env"><span class="id" title="definition">is_expanded_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.const_masks"><span class="id" title="variable">const_masks</span></a>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="dearg_aux_mkApps" class="idref" href="#dearg_aux_mkApps"><span class="id" title="lemma">dearg_aux_mkApps</span></a> <a id="args:96" class="idref" href="#args:96"><span class="id" title="binder">args</span></a> <a id="args':97" class="idref" href="#args':97"><span class="id" title="binder">args'</span></a> <a id="hd:98" class="idref" href="#hd:98"><span class="id" title="binder">hd</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_aux"><span class="id" title="abbreviation">dearg_aux</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:96"><span class="id" title="variable">args</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:98"><span class="id" title="variable">hd</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args':97"><span class="id" title="variable">args'</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_aux"><span class="id" title="abbreviation">dearg_aux</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args':97"><span class="id" title="variable">args'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:96"><span class="id" title="variable">args</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:98"><span class="id" title="variable">hd</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">args</span> <span class="id" title="var">hd</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">args'</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">args'</span> <span class="id" title="var">IH</span>]; <span class="id" title="tactic">intros</span> <span class="id" title="var">args</span> <span class="id" title="var">hd</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IH</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="dearg_mkApps" class="idref" href="#dearg_mkApps"><span class="id" title="lemma">dearg_mkApps</span></a> <a id="hd:99" class="idref" href="#hd:99"><span class="id" title="binder">hd</span></a> <a id="args:100" class="idref" href="#args:100"><span class="id" title="binder">args</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:99"><span class="id" title="variable">hd</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:100"><span class="id" title="variable">args</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_aux"><span class="id" title="abbreviation">dearg_aux</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:100"><span class="id" title="variable">args</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:99"><span class="id" title="variable">hd</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">dearg</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_aux_mkApps"><span class="id" title="lemma">dearg_aux_mkApps</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#app_nil_r"><span class="id" title="lemma">app_nil_r</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">refold'</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">refold</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_aux"><span class="id" title="abbreviation">dearg_aux</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>) <span class="id" title="keyword">with</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="tactic">in</span> ×.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="subst_dearg_single" class="idref" href="#subst_dearg_single"><span class="id" title="lemma">subst_dearg_single</span></a> <a id="s:101" class="idref" href="#s:101"><span class="id" title="binder">s</span></a> <a id="k:102" class="idref" href="#k:102"><span class="id" title="binder">k</span></a> <a id="mask:103" class="idref" href="#mask:103"><span class="id" title="binder">mask</span></a> <a id="t:104" class="idref" href="#t:104"><span class="id" title="binder">t</span></a> <a id="args:105" class="idref" href="#args:105"><span class="id" title="binder">args</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:101"><span class="id" title="variable">s</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:102"><span class="id" title="variable">k</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_single"><span class="id" title="definition">dearg_single</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:103"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:104"><span class="id" title="variable">t</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:105"><span class="id" title="variable">args</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_single"><span class="id" title="definition">dearg_single</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:103"><span class="id" title="variable">mask</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:101"><span class="id" title="variable">s</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:102"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:104"><span class="id" title="variable">t</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:101"><span class="id" title="variable">s</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:102"><span class="id" title="variable">k</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:105"><span class="id" title="variable">args</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">mask</span> <span class="id" title="keyword">as</span> [|[] <span class="id" title="var">mask</span> <span class="id" title="var">IH</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">mask</span>, <span class="id" title="var">args</span>, <span class="id" title="var">k</span>, <span class="id" title="var">t</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst_mkApps"><span class="id" title="lemma">subst_mkApps</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#commut_lift_subst"><span class="id" title="lemma">commut_lift_subst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#commut_lift_subst"><span class="id" title="lemma">commut_lift_subst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="lift_dearg_single" class="idref" href="#lift_dearg_single"><span class="id" title="lemma">lift_dearg_single</span></a> <a id="n:106" class="idref" href="#n:106"><span class="id" title="binder">n</span></a> <a id="k:107" class="idref" href="#k:107"><span class="id" title="binder">k</span></a> <a id="mask:108" class="idref" href="#mask:108"><span class="id" title="binder">mask</span></a> <a id="t:109" class="idref" href="#t:109"><span class="id" title="binder">t</span></a> <a id="args:110" class="idref" href="#args:110"><span class="id" title="binder">args</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#lift"><span class="id" title="definition">lift</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:106"><span class="id" title="variable">n</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:107"><span class="id" title="variable">k</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_single"><span class="id" title="definition">dearg_single</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:108"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:109"><span class="id" title="variable">t</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:110"><span class="id" title="variable">args</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_single"><span class="id" title="definition">dearg_single</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:108"><span class="id" title="variable">mask</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#lift"><span class="id" title="definition">lift</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:106"><span class="id" title="variable">n</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:107"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:109"><span class="id" title="variable">t</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#lift"><span class="id" title="definition">lift</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:106"><span class="id" title="variable">n</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:107"><span class="id" title="variable">k</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:110"><span class="id" title="variable">args</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">mask</span> <span class="id" title="keyword">as</span> [|[] <span class="id" title="var">mask</span> <span class="id" title="var">IH</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">mask</span>, <span class="id" title="var">t</span>, <span class="id" title="var">args</span>, <span class="id" title="var">k</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#lift_mkApps"><span class="id" title="lemma">lift_mkApps</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#permute_lift"><span class="id" title="lemma">permute_lift</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">args</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#permute_lift"><span class="id" title="lemma">permute_lift</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="dearg_lambdas_lift" class="idref" href="#dearg_lambdas_lift"><span class="id" title="lemma">dearg_lambdas_lift</span></a> <a id="mask:111" class="idref" href="#mask:111"><span class="id" title="binder">mask</span></a> <a id="n:112" class="idref" href="#n:112"><span class="id" title="binder">n</span></a> <a id="k:113" class="idref" href="#k:113"><span class="id" title="binder">k</span></a> <a id="t:114" class="idref" href="#t:114"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_lambdas"><span class="id" title="definition">dearg_lambdas</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:111"><span class="id" title="variable">mask</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#lift"><span class="id" title="definition">lift</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:112"><span class="id" title="variable">n</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:113"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:114"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#lift"><span class="id" title="definition">lift</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:112"><span class="id" title="variable">n</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:113"><span class="id" title="variable">k</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_lambdas"><span class="id" title="definition">dearg_lambdas</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:111"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:114"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">mask</span>, <span class="id" title="var">n</span>, <span class="id" title="var">k</span>, <span class="id" title="var">t</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#0f31f5c1c6b6a21a3a187247222bc9e4"><span class="id" title="notation">&lt;=?</span></a> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span> <span class="id" title="keyword">as</span> [|[] <span class="id" title="var">mask</span>]; [<span class="id" title="var">easy</span>| |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> <a class="idref" href="MetaCoq.Erasure.EAst.html#tBox"><span class="id" title="constructor">tBox</span></a> <span class="id" title="keyword">with</span> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#lift"><span class="id" title="definition">lift</span></a> <span class="id" title="var">n</span> <span class="id" title="var">k</span> <a class="idref" href="MetaCoq.Erasure.EAst.html#tBox"><span class="id" title="constructor">tBox</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#distr_lift_subst10"><span class="id" title="lemma">distr_lift_subst10</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="masked_count_zeros" class="idref" href="#masked_count_zeros"><span class="id" title="lemma">masked_count_zeros</span></a> {<a id="A:115" class="idref" href="#A:115"><span class="id" title="binder">A</span></a>} (<a id="l:116" class="idref" href="#l:116"><span class="id" title="binder">l</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#A:115"><span class="id" title="variable">A</span></a>) <a id="mask:117" class="idref" href="#mask:117"><span class="id" title="binder">mask</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:117"><span class="id" title="variable">mask</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#l:116"><span class="id" title="variable">l</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#masked"><span class="id" title="definition">masked</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:117"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#l:116"><span class="id" title="variable">l</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:117"><span class="id" title="variable">mask</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#l:116"><span class="id" title="variable">l</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:117"><span class="id" title="variable">mask</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">mask</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">l</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">l</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHmask</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHmask</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a>. <span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="dearg_branch_body_rec_lift" class="idref" href="#dearg_branch_body_rec_lift"><span class="id" title="lemma">dearg_branch_body_rec_lift</span></a> <a id="i:118" class="idref" href="#i:118"><span class="id" title="binder">i</span></a> <a id="mask:119" class="idref" href="#mask:119"><span class="id" title="binder">mask</span></a> <a id="n:120" class="idref" href="#n:120"><span class="id" title="binder">n</span></a> <a id="k:121" class="idref" href="#k:121"><span class="id" title="binder">k</span></a> <a id="t:122" class="idref" href="#t:122"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_branch_body_rec"><span class="id" title="definition">dearg_branch_body_rec</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:118"><span class="id" title="variable">i</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:119"><span class="id" title="variable">mask</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#lift"><span class="id" title="definition">lift</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:120"><span class="id" title="variable">n</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:118"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:119"><span class="id" title="variable">mask</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:121"><span class="id" title="variable">k</span></a> ) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:122"><span class="id" title="variable">t</span></a>) <a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">).2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#lift"><span class="id" title="definition">lift</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:120"><span class="id" title="variable">n</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:118"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:119"><span class="id" title="variable">mask</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:121"><span class="id" title="variable">k</span></a>) <a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_branch_body_rec"><span class="id" title="definition">dearg_branch_body_rec</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:118"><span class="id" title="variable">i</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:119"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:122"><span class="id" title="variable">t</span></a><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">).2</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">mask</span> <span class="id" title="tactic">in</span> <span class="id" title="var">i</span>, <span class="id" title="var">n</span>, <span class="id" title="var">k</span>, <span class="id" title="var">t</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_branch_body_rec"><span class="id" title="definition">dearg_branch_body_rec</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst1"><span class="id" title="definition">subst1</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>) <span class="id" title="keyword">with</span> (<span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> 1 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">)</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#distr_lift_subst_rec"><span class="id" title="lemma">distr_lift_subst_rec</span></a> <span class="id" title="var">t</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="MetaCoq.Erasure.EAst.html#tBox"><span class="id" title="constructor">tBox</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <span class="id" title="var">n</span> <span class="id" title="var">i</span> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">IHmask</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">replace</span> (<span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#negb"><span class="id" title="definition">negb</span></a> <span class="id" title="var">mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#negb"><span class="id" title="definition">negb</span></a> <span class="id" title="var">mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="lift_dearg_aux" class="idref" href="#lift_dearg_aux"><span class="id" title="lemma">lift_dearg_aux</span></a> <a id="n:123" class="idref" href="#n:123"><span class="id" title="binder">n</span></a> <a id="k:124" class="idref" href="#k:124"><span class="id" title="binder">k</span></a> <a id="args:125" class="idref" href="#args:125"><span class="id" title="binder">args</span></a> <a id="t:126" class="idref" href="#t:126"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#lift"><span class="id" title="definition">lift</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:123"><span class="id" title="variable">n</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:124"><span class="id" title="variable">k</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_aux"><span class="id" title="abbreviation">dearg_aux</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:125"><span class="id" title="variable">args</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:126"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_aux"><span class="id" title="abbreviation">dearg_aux</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#lift"><span class="id" title="definition">lift</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:123"><span class="id" title="variable">n</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:124"><span class="id" title="variable">k</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:125"><span class="id" title="variable">args</span></a>) (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#lift"><span class="id" title="definition">lift</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:123"><span class="id" title="variable">n</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:124"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:126"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k</span>, <span class="id" title="var">args</span>, <span class="id" title="var">t</span> |- × <span class="id" title="keyword">using</span> <a class="idref" href="MetaCoq.Erasure.EInduction.html#term_forall_list_ind"><span class="id" title="lemma">term_forall_list_ind</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#lift_mkApps"><span class="id" title="lemma">lift_mkApps</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#lift_mkApps"><span class="id" title="lemma">lift_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#0f31f5c1c6b6a21a3a187247222bc9e4"><span class="id" title="notation">&lt;=?</span></a> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#lift_mkApps"><span class="id" title="lemma">lift_mkApps</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#lift_mkApps"><span class="id" title="lemma">lift_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>, <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#lift_mkApps"><span class="id" title="lemma">lift_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#lift_mkApps"><span class="id" title="lemma">lift_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>, <span class="id" title="var">IHt2</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt2</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lift_dearg_single"><span class="id" title="lemma">lift_dearg_single</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lift_dearg_single"><span class="id" title="lemma">lift_dearg_single</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#lift_mkApps"><span class="id" title="lemma">lift_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">dearg_case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> <span class="id" title="var">_</span>); <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>, <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Utils.MCList.html#mapi"><span class="id" title="definition">mapi</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> 0.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|]; <span class="id" title="tactic">intros</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_case_branch"><span class="id" title="definition">dearg_case_branch</span></a>,<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_branch_body"><span class="id" title="definition">dearg_branch_body</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#complete_ctx_mask"><span class="id" title="definition">complete_ctx_mask</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ctx_mask</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#0f31f5c1c6b6a21a3a187247222bc9e4"><span class="id" title="notation">&lt;=?</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">Hmask</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">p</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">ctx_mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">x</span><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>) <span class="id" title="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#complete_ctx_mask_length"><span class="id" title="lemma">complete_ctx_mask_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#masked_count_zeros"><span class="id" title="lemma">masked_count_zeros</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_assoc"><span class="id" title="lemma">Nat.add_assoc</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_branch_body_rec_lift"><span class="id" title="lemma">dearg_branch_body_rec_lift</span></a> 0 <span class="id" title="var">ctx_mask</span> <span class="id" title="var">n</span> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">x</span><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">ctx_mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">replace</span> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">ctx_mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">x</span><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">ctx_mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">with</span> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">x</span><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">cbn</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Utils.MCProd.html#on_snd"><span class="id" title="definition">on_snd</span></a>. <span class="id" title="var">cbn</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">s</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">ind</span> <span class="id" title="var">c</span> <span class="id" title="var">npars</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#lift_mkApps"><span class="id" title="lemma">lift_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">dearg_proj</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> <span class="id" title="var">_</span>); <span class="id" title="var">cbn</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#lift_mkApps"><span class="id" title="lemma">lift_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EAst.html#map_def"><span class="id" title="definition">map_def</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#lift_mkApps"><span class="id" title="lemma">lift_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EAst.html#map_def"><span class="id" title="definition">map_def</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#lift_mkApps"><span class="id" title="lemma">lift_mkApps</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="lift_dearg" class="idref" href="#lift_dearg"><span class="id" title="lemma">lift_dearg</span></a> <a id="n:127" class="idref" href="#n:127"><span class="id" title="binder">n</span></a> <a id="k:128" class="idref" href="#k:128"><span class="id" title="binder">k</span></a> <a id="t:129" class="idref" href="#t:129"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#lift"><span class="id" title="definition">lift</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:127"><span class="id" title="variable">n</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:128"><span class="id" title="variable">k</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:129"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#lift"><span class="id" title="definition">lift</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:127"><span class="id" title="variable">n</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:128"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:129"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lift_dearg_aux"><span class="id" title="lemma">lift_dearg_aux</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="is_dead_lift_other" class="idref" href="#is_dead_lift_other"><span class="id" title="lemma">is_dead_lift_other</span></a> <a id="k:130" class="idref" href="#k:130"><span class="id" title="binder">k</span></a> <a id="k':131" class="idref" href="#k':131"><span class="id" title="binder">k'</span></a> <a id="n:132" class="idref" href="#n:132"><span class="id" title="binder">n</span></a> <a id="t:133" class="idref" href="#t:133"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:130"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k':131"><span class="id" title="variable">k'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:130"><span class="id" title="variable">k</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#lift"><span class="id" title="definition">lift</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:132"><span class="id" title="variable">n</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k':131"><span class="id" title="variable">k'</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:133"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:130"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:133"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">lt</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="keyword">using</span> <a class="idref" href="MetaCoq.Erasure.EInduction.html#term_forall_list_ind"><span class="id" title="lemma">term_forall_list_ind</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">t</span>, <span class="id" title="var">k</span>, <span class="id" title="var">k'</span>, <span class="id" title="var">lt</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#0f31f5c1c6b6a21a3a187247222bc9e4"><span class="id" title="notation">&lt;=?</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:?; <span class="id" title="var">propify</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#ad2ec4e405f68c46c0a176e3e94ae2e3"><span class="id" title="notation">=?</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:?; <span class="id" title="var">propify</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>, <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>, <span class="id" title="var">IHt2</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>, <span class="id" title="var">IHt2</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p0</span>, <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>, <span class="id" title="var">m</span>, <span class="id" title="var">k</span>, <span class="id" title="var">k'</span>, <span class="id" title="var">lt</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>, <span class="id" title="var">m</span>, <span class="id" title="var">k</span>, <span class="id" title="var">k'</span>, <span class="id" title="var">lt</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="is_dead_lift_all" class="idref" href="#is_dead_lift_all"><span class="id" title="lemma">is_dead_lift_all</span></a> <a id="k:134" class="idref" href="#k:134"><span class="id" title="binder">k</span></a> <a id="k':135" class="idref" href="#k':135"><span class="id" title="binder">k'</span></a> <a id="n:136" class="idref" href="#n:136"><span class="id" title="binder">n</span></a> <a id="t:137" class="idref" href="#t:137"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:134"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k':135"><span class="id" title="variable">k'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k':135"><span class="id" title="variable">k'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:136"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:134"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k':135"><span class="id" title="variable">k'</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#lift"><span class="id" title="definition">lift</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:136"><span class="id" title="variable">n</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:134"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:137"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="keyword">using</span> <a class="idref" href="MetaCoq.Erasure.EInduction.html#term_forall_list_ind"><span class="id" title="lemma">term_forall_list_ind</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">t</span>, <span class="id" title="var">n</span>, <span class="id" title="var">k</span>, <span class="id" title="var">k'</span>, <span class="id" title="var">l1</span>, <span class="id" title="var">l2</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#0f31f5c1c6b6a21a3a187247222bc9e4"><span class="id" title="notation">&lt;=?</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:?; <span class="id" title="var">cbn</span>; <span class="id" title="var">propify</span>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>, <span class="id" title="var">IHt2</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>, <span class="id" title="var">IHt2</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p0</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>, <span class="id" title="var">m</span>, <span class="id" title="var">k</span>, <span class="id" title="var">k'</span>, <span class="id" title="var">n</span>, <span class="id" title="var">l1</span>, <span class="id" title="var">l2</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>, <span class="id" title="var">m</span>, <span class="id" title="var">k</span>, <span class="id" title="var">k'</span>, <span class="id" title="var">n</span>, <span class="id" title="var">l1</span>, <span class="id" title="var">l2</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="is_dead_subst_other" class="idref" href="#is_dead_subst_other"><span class="id" title="lemma">is_dead_subst_other</span></a> <a id="k:138" class="idref" href="#k:138"><span class="id" title="binder">k</span></a> <a id="k':139" class="idref" href="#k':139"><span class="id" title="binder">k'</span></a> <a id="s:140" class="idref" href="#s:140"><span class="id" title="binder">s</span></a> <a id="t:141" class="idref" href="#t:141"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:138"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k':139"><span class="id" title="variable">k'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:138"><span class="id" title="variable">k</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:140"><span class="id" title="variable">s</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k':139"><span class="id" title="variable">k'</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:141"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:138"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:141"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">lt</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">t</span>, <span class="id" title="var">k</span>, <span class="id" title="var">k'</span>, <span class="id" title="var">lt</span> |- × <span class="id" title="keyword">using</span> <a class="idref" href="MetaCoq.Erasure.EInduction.html#term_forall_list_ind"><span class="id" title="lemma">term_forall_list_ind</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#0f31f5c1c6b6a21a3a187247222bc9e4"><span class="id" title="notation">&lt;=?</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:?, (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#ad2ec4e405f68c46c0a176e3e94ae2e3"><span class="id" title="notation">=?</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:?; <span class="id" title="var">propify</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">nth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_dead_lift_all"><span class="id" title="lemma">is_dead_lift_all</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#ad2ec4e405f68c46c0a176e3e94ae2e3"><span class="id" title="notation">=?</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:?; <span class="id" title="var">propify</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error_None"><span class="id" title="lemma">nth_error_None</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">nth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.eqb_refl"><span class="id" title="lemma">Nat.eqb_refl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>, <span class="id" title="var">IHt2</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>, <span class="id" title="var">IHt2</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p0</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>, <span class="id" title="var">m</span>, <span class="id" title="var">k</span>, <span class="id" title="var">k'</span>, <span class="id" title="var">lt</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>, <span class="id" title="var">m</span>, <span class="id" title="var">k</span>, <span class="id" title="var">k'</span>, <span class="id" title="var">lt</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="valid_dearg_mask_lift" class="idref" href="#valid_dearg_mask_lift"><span class="id" title="lemma">valid_dearg_mask_lift</span></a> <a id="mask:142" class="idref" href="#mask:142"><span class="id" title="binder">mask</span></a> <a id="n:143" class="idref" href="#n:143"><span class="id" title="binder">n</span></a> <a id="k:144" class="idref" href="#k:144"><span class="id" title="binder">k</span></a> <a id="t:145" class="idref" href="#t:145"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_dearg_mask"><span class="id" title="definition">valid_dearg_mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:142"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:145"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_dearg_mask"><span class="id" title="definition">valid_dearg_mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:142"><span class="id" title="variable">mask</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#lift"><span class="id" title="definition">lift</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:143"><span class="id" title="variable">n</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:144"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:145"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">mask</span>, <span class="id" title="var">n</span>, <span class="id" title="var">k</span>, <span class="id" title="var">t</span>, <span class="id" title="var">valid</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_dearg_mask_nil"><span class="id" title="lemma">valid_dearg_mask_nil</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>; [|<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHt</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_dead_lift_other"><span class="id" title="lemma">is_dead_lift_other</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="valid_dearg_mask_branch_lift" class="idref" href="#valid_dearg_mask_branch_lift"><span class="id" title="lemma">valid_dearg_mask_branch_lift</span></a> <a id="i:146" class="idref" href="#i:146"><span class="id" title="binder">i</span></a> <a id="mask:147" class="idref" href="#mask:147"><span class="id" title="binder">mask</span></a> <a id="t:148" class="idref" href="#t:148"><span class="id" title="binder">t</span></a> <a id="n:149" class="idref" href="#n:149"><span class="id" title="binder">n</span></a> <a id="k:150" class="idref" href="#k:150"><span class="id" title="binder">k</span></a> <a id="k':151" class="idref" href="#k':151"><span class="id" title="binder">k'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:146"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:147"><span class="id" title="variable">mask</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k':151"><span class="id" title="variable">k'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_dearg_mask_branch"><span class="id" title="definition">valid_dearg_mask_branch</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:146"><span class="id" title="variable">i</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:147"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:148"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_dearg_mask_branch"><span class="id" title="definition">valid_dearg_mask_branch</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:146"><span class="id" title="variable">i</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:147"><span class="id" title="variable">mask</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#lift"><span class="id" title="definition">lift</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:149"><span class="id" title="variable">n</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k':151"><span class="id" title="variable">k'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:150"><span class="id" title="variable">k</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:148"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">mask</span> <span class="id" title="tactic">in</span> <span class="id" title="var">mask</span>, <span class="id" title="var">i</span>, <span class="id" title="var">n</span>, <span class="id" title="var">k</span>, <span class="id" title="var">k'</span>, <span class="id" title="var">t</span>, <span class="id" title="var">valid</span> |- *;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_dead_lift_other"><span class="id" title="lemma">is_dead_lift_other</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">replace</span> (<span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHmask</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHmask</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="valid_dearg_mask_subst" class="idref" href="#valid_dearg_mask_subst"><span class="id" title="lemma">valid_dearg_mask_subst</span></a> <a id="mask:152" class="idref" href="#mask:152"><span class="id" title="binder">mask</span></a> <a id="s:153" class="idref" href="#s:153"><span class="id" title="binder">s</span></a> <a id="k:154" class="idref" href="#k:154"><span class="id" title="binder">k</span></a> <a id="t:155" class="idref" href="#t:155"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_dearg_mask"><span class="id" title="definition">valid_dearg_mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:152"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:155"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_dearg_mask"><span class="id" title="definition">valid_dearg_mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:152"><span class="id" title="variable">mask</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:153"><span class="id" title="variable">s</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:154"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:155"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">mask</span>, <span class="id" title="var">k</span>, <span class="id" title="var">t</span>, <span class="id" title="var">valid</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_dearg_mask_nil"><span class="id" title="lemma">valid_dearg_mask_nil</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>; [|<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHt</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_dead_subst_other"><span class="id" title="lemma">is_dead_subst_other</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="subst_dearg_lambdas" class="idref" href="#subst_dearg_lambdas"><span class="id" title="lemma">subst_dearg_lambdas</span></a> <a id="s:156" class="idref" href="#s:156"><span class="id" title="binder">s</span></a> <a id="k:157" class="idref" href="#k:157"><span class="id" title="binder">k</span></a> <a id="mask:158" class="idref" href="#mask:158"><span class="id" title="binder">mask</span></a> <a id="t:159" class="idref" href="#t:159"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_dearg_mask"><span class="id" title="definition">valid_dearg_mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:158"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:159"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:156"><span class="id" title="variable">s</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:157"><span class="id" title="variable">k</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_lambdas"><span class="id" title="definition">dearg_lambdas</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:158"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:159"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_lambdas"><span class="id" title="definition">dearg_lambdas</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:158"><span class="id" title="variable">mask</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:156"><span class="id" title="variable">s</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:157"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:159"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k</span>, <span class="id" title="var">mask</span>, <span class="id" title="var">t</span>, <span class="id" title="var">valid</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_lambdas_nil"><span class="id" title="lemma">dearg_lambdas_nil</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span> <span class="id" title="keyword">as</span> [|[] <span class="id" title="var">mask</span>]; [<span class="id" title="var">easy</span>| |]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst1"><span class="id" title="definition">subst1</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#distr_subst"><span class="id" title="lemma">distr_subst</span></a>, <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt2</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="dearg_branch_body_rec_subst" class="idref" href="#dearg_branch_body_rec_subst"><span class="id" title="lemma">dearg_branch_body_rec_subst</span></a> <a id="i:160" class="idref" href="#i:160"><span class="id" title="binder">i</span></a> <a id="mask:161" class="idref" href="#mask:161"><span class="id" title="binder">mask</span></a> <a id="s:162" class="idref" href="#s:162"><span class="id" title="binder">s</span></a> <a id="k:163" class="idref" href="#k:163"><span class="id" title="binder">k</span></a> <a id="t:164" class="idref" href="#t:164"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_branch_body_rec"><span class="id" title="definition">dearg_branch_body_rec</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:160"><span class="id" title="variable">i</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:161"><span class="id" title="variable">mask</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:162"><span class="id" title="variable">s</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:160"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:161"><span class="id" title="variable">mask</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:163"><span class="id" title="variable">k</span></a> ) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:164"><span class="id" title="variable">t</span></a>)<a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">).2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:162"><span class="id" title="variable">s</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:160"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:161"><span class="id" title="variable">mask</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:163"><span class="id" title="variable">k</span></a>) <a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_branch_body_rec"><span class="id" title="definition">dearg_branch_body_rec</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:160"><span class="id" title="variable">i</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:161"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:164"><span class="id" title="variable">t</span></a><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">).2</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">mask</span> <span class="id" title="tactic">in</span> <span class="id" title="var">i</span>, <span class="id" title="var">s</span>, <span class="id" title="var">k</span>, <span class="id" title="var">t</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_branch_body_rec"><span class="id" title="definition">dearg_branch_body_rec</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst1"><span class="id" title="definition">subst1</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>) <span class="id" title="keyword">with</span> (<span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> 1 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">)</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#distr_subst_rec"><span class="id" title="lemma">distr_subst_rec</span></a> <span class="id" title="var">t</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="MetaCoq.Erasure.EAst.html#tBox"><span class="id" title="constructor">tBox</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <span class="id" title="var">s</span> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>) <span class="id" title="var">i</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">IHmask</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">replace</span> (<span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#negb"><span class="id" title="definition">negb</span></a> <span class="id" title="var">mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#negb"><span class="id" title="definition">negb</span></a> <span class="id" title="var">mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="subst_dearg_case" class="idref" href="#subst_dearg_case"><span class="id" title="lemma">subst_dearg_case</span></a> <a id="s:165" class="idref" href="#s:165"><span class="id" title="binder">s</span></a> <a id="k:166" class="idref" href="#k:166"><span class="id" title="binder">k</span></a> <a id="ind:167" class="idref" href="#ind:167"><span class="id" title="binder">ind</span></a> <a id="c:168" class="idref" href="#c:168"><span class="id" title="binder">c</span></a> <a id="discr:169" class="idref" href="#discr:169"><span class="id" title="binder">discr</span></a> <a id="brs:170" class="idref" href="#brs:170"><span class="id" title="binder">brs</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_case_masks"><span class="id" title="abbreviation">valid_case_masks</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:167"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c:168"><span class="id" title="variable">c</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#brs:170"><span class="id" title="variable">brs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:165"><span class="id" title="variable">s</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:166"><span class="id" title="variable">k</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_case"><span class="id" title="abbreviation">dearg_case</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:167"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c:168"><span class="id" title="variable">c</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#discr:169"><span class="id" title="variable">discr</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#brs:170"><span class="id" title="variable">brs</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_case"><span class="id" title="abbreviation">dearg_case</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:167"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c:168"><span class="id" title="variable">c</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:165"><span class="id" title="variable">s</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:166"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#discr:169"><span class="id" title="variable">discr</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<span class="id" title="keyword">fun</span> <a id="br:171" class="idref" href="#br:171"><span class="id" title="binder">br</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="MetaCoq.Common.BasicAst.html#name"><span class="id" title="inductive">BasicAst.name</span></a> <a class="idref" href="MetaCoq.Utils.MCProd.html#52eddd74560fa276f934634af83eeaf4"><span class="id" title="notation">×</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#term"><span class="id" title="inductive">term</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#br:171"><span class="id" title="variable">br</span></a><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:165"><span class="id" title="variable">s</span></a> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#br:171"><span class="id" title="variable">br</span></a><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:166"><span class="id" title="variable">k</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#br:171"><span class="id" title="variable">br</span></a><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#brs:170"><span class="id" title="variable">brs</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">dearg_case</span>, <span class="id" title="var">valid_case_masks</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">masks</span>|];<span class="id" title="var">cbn</span>;[|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#map_mapi"><span class="id" title="lemma">map_mapi</span></a>, <a class="idref" href="MetaCoq.Utils.MCList.html#mapi_map"><span class="id" title="lemma">mapi_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">valid</span> <span class="id" title="keyword">as</span> (? &amp; <span class="id" title="var">valid</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#Alli_mapi_spec"><span class="id" title="lemma">Alli_mapi_spec</span></a>; [<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#alli_Alli"><span class="id" title="lemma">alli_Alli</span></a>; <span class="id" title="var">eassumption</span>|]. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? [<span class="id" title="var">bctx</span> <span class="id" title="var">t</span>] <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_case_branch"><span class="id" title="definition">dearg_case_branch</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Bool.Bool.html#andb_true_iff"><span class="id" title="lemma">andb_true_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hmasks</span> ?].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hmasks</span>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_branch_body"><span class="id" title="definition">dearg_branch_body</span></a>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#complete_ctx_mask"><span class="id" title="definition">complete_ctx_mask</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ctx_mask</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">ctx_mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">bctx</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>;<span class="id" title="var">propify</span>;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#complete_ctx_mask_length"><span class="id" title="lemma">complete_ctx_mask_length</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#masked_count_zeros"><span class="id" title="lemma">masked_count_zeros</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>. <span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_assoc"><span class="id" title="lemma">Nat.add_assoc</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_branch_body_rec_subst"><span class="id" title="lemma">dearg_branch_body_rec_subst</span></a> 0 <span class="id" title="var">ctx_mask</span> <span class="id" title="var">s</span> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">bctx</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">ctx_mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>) <span class="id" title="var">t</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hb</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hb</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">replace</span> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">ctx_mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">bctx</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">ctx_mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">with</span> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">bctx</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hb</span> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="dearg_single_enough_args" class="idref" href="#dearg_single_enough_args"><span class="id" title="lemma">dearg_single_enough_args</span></a> <a id="mask:172" class="idref" href="#mask:172"><span class="id" title="binder">mask</span></a> <a id="t:173" class="idref" href="#t:173"><span class="id" title="binder">t</span></a> <a id="args:174" class="idref" href="#args:174"><span class="id" title="binder">args</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_single"><span class="id" title="definition">dearg_single</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:172"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:173"><span class="id" title="variable">t</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:174"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_single"><span class="id" title="definition">dearg_single</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:172"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:173"><span class="id" title="variable">t</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#firstn"><span class="id" title="definition">firstn</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:172"><span class="id" title="variable">mask</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:174"><span class="id" title="variable">args</span></a>)) (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#skipn"><span class="id" title="definition">skipn</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:172"><span class="id" title="variable">mask</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:174"><span class="id" title="variable">args</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">mask</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">b</span> <span class="id" title="var">mask</span> <span class="id" title="var">IH</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">mask</span>, <span class="id" title="var">t</span>, <span class="id" title="var">args</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#skipn_0"><span class="id" title="lemma">skipn_0</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">args</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">args</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#skipn_nil"><span class="id" title="lemma">skipn_nil</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#skipn_cons"><span class="id" title="lemma">skipn_cons</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="dearg_expanded_aux" class="idref" href="#dearg_expanded_aux"><span class="id" title="lemma">dearg_expanded_aux</span></a> <a id="k:175" class="idref" href="#k:175"><span class="id" title="binder">k</span></a> <a id="t:176" class="idref" href="#t:176"><span class="id" title="binder">t</span></a> <a id="args:177" class="idref" href="#args:177"><span class="id" title="binder">args</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:175"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:176"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_aux"><span class="id" title="abbreviation">dearg_aux</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:177"><span class="id" title="variable">args</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:176"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_aux"><span class="id" title="abbreviation">dearg_aux</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#firstn"><span class="id" title="definition">firstn</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:175"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:177"><span class="id" title="variable">args</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:176"><span class="id" title="variable">t</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#skipn"><span class="id" title="definition">skipn</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:175"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:177"><span class="id" title="variable">args</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">expanded</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k</span>, <span class="id" title="var">t</span>, <span class="id" title="var">args</span>, <span class="id" title="var">expanded</span> |- × <span class="id" title="keyword">using</span> <a class="idref" href="MetaCoq.Erasure.EInduction.html#term_forall_list_ind"><span class="id" title="lemma">term_forall_list_ind</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">refold'</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.EAstUtils.html#mkApps_app"><span class="id" title="lemma">mkApps_app</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#firstn_skipn"><span class="id" title="lemma">firstn_skipn</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">propify</span>; <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">erewrite</span> <span class="id" title="var">IHt1</span> <span class="id" title="tactic">by</span> <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_single_enough_args"><span class="id" title="lemma">dearg_single_enough_args</span></a>; <span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.EAstUtils.html#mkApps_app"><span class="id" title="lemma">mkApps_app</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#firstn_firstn"><span class="id" title="lemma">firstn_firstn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Nat.html#min"><span class="id" title="definition">Init.Nat.min</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#get_const_mask"><span class="id" title="abbreviation">get_const_mask</span></a> <span class="id" title="var">s</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_single_enough_args"><span class="id" title="lemma">dearg_single_enough_args</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.Utils.html#skipn_firstn_slice"><span class="id" title="lemma">skipn_firstn_slice</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_single_enough_args"><span class="id" title="lemma">dearg_single_enough_args</span></a>; <span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.EAstUtils.html#mkApps_app"><span class="id" title="lemma">mkApps_app</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#firstn_firstn"><span class="id" title="lemma">firstn_firstn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Nat.html#min"><span class="id" title="definition">Init.Nat.min</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#get_ctor_mask"><span class="id" title="abbreviation">get_ctor_mask</span></a> <span class="id" title="var">i</span> <span class="id" title="var">n</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_single_enough_args"><span class="id" title="lemma">dearg_single_enough_args</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.Utils.html#skipn_firstn_slice"><span class="id" title="lemma">skipn_firstn_slice</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.EAstUtils.html#mkApps_app"><span class="id" title="lemma">mkApps_app</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#firstn_skipn"><span class="id" title="lemma">firstn_skipn</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.EAstUtils.html#mkApps_app"><span class="id" title="lemma">mkApps_app</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#firstn_skipn"><span class="id" title="lemma">firstn_skipn</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="dearg_expanded" class="idref" href="#dearg_expanded"><span class="id" title="lemma">dearg_expanded</span></a> <a id="t:178" class="idref" href="#t:178"><span class="id" title="binder">t</span></a> <a id="args:179" class="idref" href="#args:179"><span class="id" title="binder">args</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:178"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_aux"><span class="id" title="abbreviation">dearg_aux</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:179"><span class="id" title="variable">args</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:178"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:178"><span class="id" title="variable">t</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:179"><span class="id" title="variable">args</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_expanded_aux"><span class="id" title="lemma">dearg_expanded_aux</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="is_expanded_aux_lift" class="idref" href="#is_expanded_aux_lift"><span class="id" title="lemma">is_expanded_aux_lift</span></a> <a id="k:180" class="idref" href="#k:180"><span class="id" title="binder">k</span></a> <a id="n:181" class="idref" href="#n:181"><span class="id" title="binder">n</span></a> <a id="k':182" class="idref" href="#k':182"><span class="id" title="binder">k'</span></a> <a id="t:183" class="idref" href="#t:183"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:180"><span class="id" title="variable">k</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#lift"><span class="id" title="definition">lift</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:181"><span class="id" title="variable">n</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k':182"><span class="id" title="variable">k'</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:183"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:180"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:183"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">n</span>, <span class="id" title="var">k</span>, <span class="id" title="var">k'</span>, <span class="id" title="var">t</span> |- × <span class="id" title="keyword">using</span> <a class="idref" href="MetaCoq.Erasure.EInduction.html#term_forall_list_ind"><span class="id" title="lemma">term_forall_list_ind</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#0f31f5c1c6b6a21a3a187247222bc9e4"><span class="id" title="notation">&lt;=?</span></a> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>, <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>, <span class="id" title="var">IHt2</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>, <span class="id" title="var">IHt2</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k'</span> |- *; [<span class="id" title="var">now</span> <span class="id" title="tactic">f_equal</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> <span class="id" title="var">_</span> <span class="id" title="var">x</span><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a>);<span class="id" title="var">cbn</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">btauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k'</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>, <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k'</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>, <span class="id" title="var">IHX</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="is_expanded_lift" class="idref" href="#is_expanded_lift"><span class="id" title="lemma">is_expanded_lift</span></a> <a id="n:184" class="idref" href="#n:184"><span class="id" title="binder">n</span></a> <a id="k:185" class="idref" href="#k:185"><span class="id" title="binder">k</span></a> <a id="t:186" class="idref" href="#t:186"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#lift"><span class="id" title="definition">lift</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:184"><span class="id" title="variable">n</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:185"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:186"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:186"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_lift"><span class="id" title="lemma">is_expanded_aux_lift</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="is_dead_mkApps" class="idref" href="#is_dead_mkApps"><span class="id" title="lemma">is_dead_mkApps</span></a> <a id="k:187" class="idref" href="#k:187"><span class="id" title="binder">k</span></a> <a id="t:188" class="idref" href="#t:188"><span class="id" title="binder">t</span></a> <a id="args:189" class="idref" href="#args:189"><span class="id" title="binder">args</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:187"><span class="id" title="variable">k</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:188"><span class="id" title="variable">t</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:189"><span class="id" title="variable">args</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:187"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:188"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#forallb"><span class="id" title="definition">forallb</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:187"><span class="id" title="variable">k</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:189"><span class="id" title="variable">args</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">args</span> <span class="id" title="keyword">using</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#rev_ind"><span class="id" title="lemma">List.rev_ind</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">btauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.EAstUtils.html#mkApps_app"><span class="id" title="lemma">mkApps_app</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#forallb_app"><span class="id" title="lemma">forallb_app</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHargs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">btauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="is_dead_lift" class="idref" href="#is_dead_lift"><span class="id" title="lemma">is_dead_lift</span></a> <a id="k:190" class="idref" href="#k:190"><span class="id" title="binder">k</span></a> <a id="k':191" class="idref" href="#k':191"><span class="id" title="binder">k'</span></a> <a id="n:192" class="idref" href="#n:192"><span class="id" title="binder">n</span></a> <a id="t:193" class="idref" href="#t:193"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k':191"><span class="id" title="variable">k'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:190"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:192"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k':191"><span class="id" title="variable">k'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:190"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:190"><span class="id" title="variable">k</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#lift"><span class="id" title="definition">lift</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:192"><span class="id" title="variable">n</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k':191"><span class="id" title="variable">k'</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:193"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:190"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:192"><span class="id" title="variable">n</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:193"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k</span>, <span class="id" title="var">k'</span>, <span class="id" title="var">n</span>, <span class="id" title="var">t</span>, <span class="id" title="var">l1</span>, <span class="id" title="var">l2</span> |- × <span class="id" title="keyword">using</span> <a class="idref" href="MetaCoq.Erasure.EInduction.html#term_forall_list_ind"><span class="id" title="lemma">term_forall_list_ind</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#0f31f5c1c6b6a21a3a187247222bc9e4"><span class="id" title="notation">&lt;=?</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:?; <span class="id" title="var">propify</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#ad2ec4e405f68c46c0a176e3e94ae2e3"><span class="id" title="notation">=?</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:?; <span class="id" title="var">propify</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>, <span class="id" title="var">IHt2</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>, <span class="id" title="var">IHt2</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p0</span>;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>, <span class="id" title="var">m</span>, <span class="id" title="var">k</span>, <span class="id" title="var">k'</span>, <span class="id" title="var">n</span>, <span class="id" title="var">l1</span>, <span class="id" title="var">l2</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHX</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">replace</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<span class="id" title="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <span class="id" title="var">n</span>)) <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <span class="id" title="var">n</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>, <span class="id" title="var">m</span>, <span class="id" title="var">k</span>, <span class="id" title="var">k'</span>, <span class="id" title="var">n</span>, <span class="id" title="var">l1</span>, <span class="id" title="var">l2</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHX</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">replace</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<span class="id" title="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <span class="id" title="var">n</span>)) <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <span class="id" title="var">n</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="is_dead_dearg_single" class="idref" href="#is_dead_dearg_single"><span class="id" title="lemma">is_dead_dearg_single</span></a> <a id="k:194" class="idref" href="#k:194"><span class="id" title="binder">k</span></a> <a id="mask:195" class="idref" href="#mask:195"><span class="id" title="binder">mask</span></a> <a id="t:196" class="idref" href="#t:196"><span class="id" title="binder">t</span></a> <a id="args:197" class="idref" href="#args:197"><span class="id" title="binder">args</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:194"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:196"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:194"><span class="id" title="variable">k</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:197"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:194"><span class="id" title="variable">k</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_single"><span class="id" title="definition">dearg_single</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:195"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:196"><span class="id" title="variable">t</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:197"><span class="id" title="variable">args</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">no_use</span> <span class="id" title="var">args_no_use</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">mask</span> <span class="id" title="keyword">as</span> [|[] <span class="id" title="var">mask</span> <span class="id" title="var">IH</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">k</span>, <span class="id" title="var">mask</span>, <span class="id" title="var">t</span>, <span class="id" title="var">args</span>, <span class="id" title="var">no_use</span>, <span class="id" title="var">args_no_use</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_dead_mkApps"><span class="id" title="lemma">is_dead_mkApps</span></a>, <span class="id" title="var">no_use</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">args</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_dead_lift"><span class="id" title="lemma">is_dead_lift</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.sub_0_r"><span class="id" title="lemma">Nat.sub_0_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">args_no_use</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">args</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Bool.Bool.html#andb_true_r"><span class="id" title="lemma">Bool.andb_true_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_dead_lift"><span class="id" title="lemma">is_dead_lift</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.sub_0_r"><span class="id" title="lemma">Nat.sub_0_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">inversion</span> <span class="id" title="var">args_no_use</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">bia</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>); <span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ?<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Bool.Bool.html#orb_true_r"><span class="id" title="lemma">Bool.orb_true_r</span></a>, ?<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Bool.Bool.html#orb_false_r"><span class="id" title="lemma">Bool.orb_false_r</span></a>, ?<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Bool.Bool.html#andb_false_r"><span class="id" title="lemma">Bool.andb_false_r</span></a>; <span class="id" title="tactic">auto</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="is_dead_subst" class="idref" href="#is_dead_subst"><span class="id" title="lemma">is_dead_subst</span></a> <a id="s:198" class="idref" href="#s:198"><span class="id" title="binder">s</span></a> <a id="k:199" class="idref" href="#k:199"><span class="id" title="binder">k</span></a> <a id="k':200" class="idref" href="#k':200"><span class="id" title="binder">k'</span></a> <a id="t:201" class="idref" href="#t:201"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k':200"><span class="id" title="variable">k'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:199"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:199"><span class="id" title="variable">k</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:198"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k':200"><span class="id" title="variable">k'</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:201"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:199"><span class="id" title="variable">k</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:201"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k':200"><span class="id" title="variable">k'</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:201"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">||</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:199"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k':200"><span class="id" title="variable">k'</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:198"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">le</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">t</span>, <span class="id" title="var">k</span>, <span class="id" title="var">k'</span>, <span class="id" title="var">le</span> |- × <span class="id" title="keyword">using</span> <a class="idref" href="MetaCoq.Erasure.EInduction.html#term_forall_list_ind"><span class="id" title="lemma">term_forall_list_ind</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#0f31f5c1c6b6a21a3a187247222bc9e4"><span class="id" title="notation">&lt;=?</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:?; <span class="id" title="var">propify</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">nth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">replace</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span> <span class="id" title="var">k'</span> <span class="id" title="tactic">in</span> × <span class="id" title="tactic">by</span> (<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.MCList.html#nth_error_Some_length"><span class="id" title="lemma">nth_error_Some_length</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">nth</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> × ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.sub_diag"><span class="id" title="lemma">Nat.sub_diag</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">nth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">noconf</span> <span class="id" title="var">nth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.eqb_refl"><span class="id" title="lemma">Nat.eqb_refl</span></a>, (<a class="idref" href="MetaCoq.Utils.MCProd.html#proj2"><span class="id" title="definition">proj2</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.eqb_neq"><span class="id" title="lemma">Nat.eqb_neq</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)) <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_dead_lift"><span class="id" title="lemma">is_dead_lift</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error_None"><span class="id" title="lemma">nth_error_None</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">nth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#ad2ec4e405f68c46c0a176e3e94ae2e3"><span class="id" title="notation">=?</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:?; <span class="id" title="var">propify</span>); <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> (<span class="id" title="var">n</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#ad2ec4e405f68c46c0a176e3e94ae2e3"><span class="id" title="notation">=?</span></a> <span class="id" title="var">k</span>) <span class="id" title="var">eqn</span>:?, (<span class="id" title="var">n</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#ad2ec4e405f68c46c0a176e3e94ae2e3"><span class="id" title="notation">=?</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k</span>) <span class="id" title="var">eqn</span>:?, (<span class="id" title="var">n</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#ad2ec4e405f68c46c0a176e3e94ae2e3"><span class="id" title="notation">=?</span></a> <span class="id" title="var">k'</span>) <span class="id" title="var">eqn</span>:?; <span class="id" title="var">propify</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">auto</span>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">p</span>, !<span class="id" title="var">IHX</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bia</span>.<br/>
&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>, <span class="id" title="var">IHt2</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k'</span>) <span class="id" title="keyword">with</span> (<span class="id" title="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <span class="id" title="var">k'</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bia</span>.<br/>
&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>, <span class="id" title="var">IHt2</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bia</span>.<br/>
&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bia</span>.<br/>
&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [<span class="id" title="var">bia</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">bctx</span> <span class="id" title="var">br</span>];<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p0</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">bctx</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">bctx</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>)) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">bctx</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">bctx</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">with</span> (<span class="id" title="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <span class="id" title="var">k'</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bia</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Bool.Bool.html#orb_true_r"><span class="id" title="lemma">Bool.orb_true_r</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Bool.Bool.html#orb_false_r"><span class="id" title="lemma">Bool.orb_false_r</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>, <span class="id" title="var">m</span>, <span class="id" title="var">k</span>, <span class="id" title="var">k'</span>, <span class="id" title="var">le</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHX</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k</span>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k'</span>) <span class="id" title="keyword">ltac</span>:(<span class="id" title="var">lia</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.sub_succ"><span class="id" title="lemma">Nat.sub_succ</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">l</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">l</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">with</span> (<span class="id" title="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <span class="id" title="var">k'</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bia</span>.<br/>
&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>, <span class="id" title="var">m</span>, <span class="id" title="var">k</span>, <span class="id" title="var">k'</span>, <span class="id" title="var">le</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHX</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k</span>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k'</span>) <span class="id" title="keyword">ltac</span>:(<span class="id" title="var">lia</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.sub_succ"><span class="id" title="lemma">Nat.sub_succ</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">l</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">l</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">with</span> (<span class="id" title="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <span class="id" title="var">k'</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="is_dead_dearg_lambdas" class="idref" href="#is_dead_dearg_lambdas"><span class="id" title="lemma">is_dead_dearg_lambdas</span></a> <a id="k:202" class="idref" href="#k:202"><span class="id" title="binder">k</span></a> <a id="mask:203" class="idref" href="#mask:203"><span class="id" title="binder">mask</span></a> <a id="t:204" class="idref" href="#t:204"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:202"><span class="id" title="variable">k</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_lambdas"><span class="id" title="definition">dearg_lambdas</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:203"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:204"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:202"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:204"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k</span>, <span class="id" title="var">mask</span>, <span class="id" title="var">t</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span> <span class="id" title="keyword">as</span> [|[] <span class="id" title="var">mask</span>]; [<span class="id" title="var">easy</span>| |]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst1"><span class="id" title="definition">subst1</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_dead_subst"><span class="id" title="lemma">is_dead_subst</span></a>, <span class="id" title="var">IHt</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.sub_0_r"><span class="id" title="lemma">Nat.sub_0_r</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">btauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="is_dead_dearg_branch_body" class="idref" href="#is_dead_dearg_branch_body"><span class="id" title="lemma">is_dead_dearg_branch_body</span></a> <a id="i:205" class="idref" href="#i:205"><span class="id" title="binder">i</span></a> <a id="k:206" class="idref" href="#k:206"><span class="id" title="binder">k</span></a> <a id="mask:207" class="idref" href="#mask:207"><span class="id" title="binder">mask</span></a> <a id="t:208" class="idref" href="#t:208"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:205"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:207"><span class="id" title="variable">mask</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:206"><span class="id" title="variable">k</span></a>) <a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">((</span></a><a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_branch_body_rec"><span class="id" title="definition">dearg_branch_body_rec</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:205"><span class="id" title="variable">i</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:207"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:208"><span class="id" title="variable">t</span></a><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">)).2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:205"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:207"><span class="id" title="variable">mask</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:206"><span class="id" title="variable">k</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:208"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">mask</span> <span class="id" title="tactic">in</span> <span class="id" title="var">t</span>, <span class="id" title="var">i</span>, <span class="id" title="var">k</span>, <span class="id" title="var">mask</span>, <span class="id" title="var">t</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst1"><span class="id" title="definition">subst1</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_branch_body_rec"><span class="id" title="definition">dearg_branch_body_rec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IHmask</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHmask</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_dead_subst"><span class="id" title="lemma">is_dead_subst</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <span class="id" title="var">i</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">btauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">replace</span> (<span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#negb"><span class="id" title="definition">negb</span></a> <span class="id" title="var">mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#negb"><span class="id" title="definition">negb</span></a> <span class="id" title="var">mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHmask</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="is_dead_dearg_case" class="idref" href="#is_dead_dearg_case"><span class="id" title="lemma">is_dead_dearg_case</span></a> <a id="k:209" class="idref" href="#k:209"><span class="id" title="binder">k</span></a> <a id="ind:210" class="idref" href="#ind:210"><span class="id" title="binder">ind</span></a> <a id="npars:211" class="idref" href="#npars:211"><span class="id" title="binder">npars</span></a> <a id="discr:212" class="idref" href="#discr:212"><span class="id" title="binder">discr</span></a> <a id="brs:213" class="idref" href="#brs:213"><span class="id" title="binder">brs</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:209"><span class="id" title="variable">k</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_case"><span class="id" title="abbreviation">dearg_case</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:210"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#npars:211"><span class="id" title="variable">npars</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#discr:212"><span class="id" title="variable">discr</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#brs:213"><span class="id" title="variable">brs</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:209"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#discr:212"><span class="id" title="variable">discr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#forallb"><span class="id" title="definition">forallb</span></a> (<span class="id" title="keyword">fun</span> '<a id="pat:216" class="idref" href="#pat:216"><span class="id" title="binder">(</span></a><a id="pat:216" class="idref" href="#pat:216"><span class="id" title="binder">ctx</span></a><a id="pat:216" class="idref" href="#pat:216"><span class="id" title="binder">,</span></a> <a id="pat:216" class="idref" href="#pat:216"><span class="id" title="binder">t</span></a><a id="pat:216" class="idref" href="#pat:216"><span class="id" title="binder">)</span></a> ⇒ <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ctx:215"><span class="id" title="variable">ctx</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:209"><span class="id" title="variable">k</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:214"><span class="id" title="variable">t</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#brs:213"><span class="id" title="variable">brs</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">dearg_case</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> <span class="id" title="var">_</span>); <span class="id" title="var">cbn</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Utils.MCList.html#mapi"><span class="id" title="definition">mapi</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> 0.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">brs</span>; <span class="id" title="tactic">intros</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHbrs</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_case_branch"><span class="id" title="definition">dearg_case_branch</span></a>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#0f31f5c1c6b6a21a3a187247222bc9e4"><span class="id" title="notation">&lt;=?</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">Hmask</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#complete_ctx_mask"><span class="id" title="definition">complete_ctx_mask</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">mm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mm</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">l</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>;<span class="id" title="var">propify</span>;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#complete_ctx_mask_length"><span class="id" title="lemma">complete_ctx_mask_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#masked_count_zeros"><span class="id" title="lemma">masked_count_zeros</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_dead_dearg_branch_body"><span class="id" title="lemma">is_dead_dearg_branch_body</span></a> 0 (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">l</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mm</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>) <span class="id" title="var">mm</span> <span class="id" title="var">t</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mm</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">l</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mm</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">with</span> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">l</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">b</span> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_assoc"><span class="id" title="lemma">Nat.add_assoc</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="is_dead_dearg_aux" class="idref" href="#is_dead_dearg_aux"><span class="id" title="lemma">is_dead_dearg_aux</span></a> <a id="k:217" class="idref" href="#k:217"><span class="id" title="binder">k</span></a> <a id="t:218" class="idref" href="#t:218"><span class="id" title="binder">t</span></a> <a id="args:219" class="idref" href="#args:219"><span class="id" title="binder">args</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:217"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:218"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:217"><span class="id" title="variable">k</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:219"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:217"><span class="id" title="variable">k</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_aux"><span class="id" title="abbreviation">dearg_aux</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:219"><span class="id" title="variable">args</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:218"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">no_use</span> <span class="id" title="var">args_no_use</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="keyword">using</span> <a class="idref" href="MetaCoq.Erasure.EInduction.html#term_forall_list_ind"><span class="id" title="lemma">term_forall_list_ind</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">k</span>, <span class="id" title="var">t</span>, <span class="id" title="var">args</span>, <span class="id" title="var">no_use</span>, <span class="id" title="var">args_no_use</span> |- *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">rewrite</span> ?<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_dead_mkApps"><span class="id" title="lemma">is_dead_mkApps</span></a>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">no_use</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">propify</span>; <span class="id" title="tactic">split</span>; [|<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>, <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>, <span class="id" title="var">IHt2</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>].<br/>
&nbsp;&nbsp;- <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_dead_dearg_single"><span class="id" title="lemma">is_dead_dearg_single</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_dead_dearg_single"><span class="id" title="lemma">is_dead_dearg_single</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_dead_mkApps"><span class="id" title="lemma">is_dead_mkApps</span></a>, <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_dead_dearg_case"><span class="id" title="lemma">is_dead_dearg_case</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [|<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHt</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_dead_mkApps"><span class="id" title="lemma">is_dead_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>; <span class="id" title="tactic">split</span>; [|<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">dearg_proj</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> <span class="id" title="var">_</span>); <span class="id" title="tactic">apply</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>; <span class="id" title="tactic">split</span>; [|<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k</span>, <span class="id" title="var">m</span>, <span class="id" title="var">X</span>, <span class="id" title="var">no_use</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>; <span class="id" title="tactic">split</span>; [|<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k</span>, <span class="id" title="var">m</span>, <span class="id" title="var">X</span>, <span class="id" title="var">no_use</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="valid_dearg_mask_dearg" class="idref" href="#valid_dearg_mask_dearg"><span class="id" title="lemma">valid_dearg_mask_dearg</span></a> <a id="mask:220" class="idref" href="#mask:220"><span class="id" title="binder">mask</span></a> <a id="t:221" class="idref" href="#t:221"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_dearg_mask"><span class="id" title="definition">valid_dearg_mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:220"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:221"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_dearg_mask"><span class="id" title="definition">valid_dearg_mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:220"><span class="id" title="variable">mask</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:221"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">mask</span>, <span class="id" title="var">t</span>, <span class="id" title="var">valid</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [<span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span>; [|<span class="id" title="var">easy</span>]; <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_dearg_mask_nil"><span class="id" title="lemma">valid_dearg_mask_nil</span></a>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span> <span class="id" title="keyword">as</span> [|[] <span class="id" title="var">mask</span>]; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_dead_dearg_aux"><span class="id" title="lemma">is_dead_dearg_aux</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="valid_dearg_mask_branch_dearg" class="idref" href="#valid_dearg_mask_branch_dearg"><span class="id" title="lemma">valid_dearg_mask_branch_dearg</span></a> <a id="mask:222" class="idref" href="#mask:222"><span class="id" title="binder">mask</span></a> <a id="t:223" class="idref" href="#t:223"><span class="id" title="binder">t</span></a> <a id="i:224" class="idref" href="#i:224"><span class="id" title="binder">i</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_dearg_mask_branch"><span class="id" title="definition">valid_dearg_mask_branch</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:224"><span class="id" title="variable">i</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:222"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:223"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_dearg_mask_branch"><span class="id" title="definition">valid_dearg_mask_branch</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:224"><span class="id" title="variable">i</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:222"><span class="id" title="variable">mask</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:223"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">mask</span> <span class="id" title="tactic">in</span> <span class="id" title="var">i</span>, <span class="id" title="var">H</span> |- *;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">propify</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHmask</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">dearg</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_dead_dearg_aux"><span class="id" title="lemma">is_dead_dearg_aux</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="valid_case_masks_dearg_branches" class="idref" href="#valid_case_masks_dearg_branches"><span class="id" title="lemma">valid_case_masks_dearg_branches</span></a> <a id="ind:225" class="idref" href="#ind:225"><span class="id" title="binder">ind</span></a> <a id="npars:226" class="idref" href="#npars:226"><span class="id" title="binder">npars</span></a> <a id="brs:227" class="idref" href="#brs:227"><span class="id" title="binder">brs</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_case_masks"><span class="id" title="abbreviation">valid_case_masks</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:225"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#npars:226"><span class="id" title="variable">npars</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#brs:227"><span class="id" title="variable">brs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_case_masks"><span class="id" title="abbreviation">valid_case_masks</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:225"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#npars:226"><span class="id" title="variable">npars</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="MetaCoq.Utils.MCProd.html#on_snd"><span class="id" title="definition">on_snd</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#brs:227"><span class="id" title="variable">brs</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">valid_case_masks</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> <span class="id" title="var">_</span>); [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#alli_Alli"><span class="id" title="lemma">alli_Alli</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#alli_Alli"><span class="id" title="lemma">alli_Alli</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Utils.MCList.html#mapi_cst_map"><span class="id" title="lemma">mapi_cst_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Utils.MCList.html#mapi"><span class="id" title="definition">mapi</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#Alli_mapi"><span class="id" title="lemma">Alli_mapi</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">f</span> := (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> ⇒ <a class="idref" href="MetaCoq.Utils.MCProd.html#on_snd"><span class="id" title="definition">on_snd</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#Alli_impl"><span class="id" title="lemma">Alli_impl</span></a>; [<span class="id" title="var">eassumption</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> [] <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_dearg_mask_branch_dearg"><span class="id" title="lemma">valid_dearg_mask_branch_dearg</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="dearg_aux_subst" class="idref" href="#dearg_aux_subst"><span class="id" title="lemma">dearg_aux_subst</span></a> <a id="s:228" class="idref" href="#s:228"><span class="id" title="binder">s</span></a> <a id="k:229" class="idref" href="#k:229"><span class="id" title="binder">k</span></a> <a id="t:230" class="idref" href="#t:230"><span class="id" title="binder">t</span></a> <a id="args:231" class="idref" href="#args:231"><span class="id" title="binder">args</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:230"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <a id="s:232" class="idref" href="#s:232"><span class="id" title="binder">s</span></a> ⇒ <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:232"><span class="id" title="variable">s</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:228"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_aux"><span class="id" title="abbreviation">dearg_aux</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst"><span class="id" title="definition">subst</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:228"><span class="id" title="variable">s</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:229"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Utils.MCPrelude.html#c90061783c20674b3a3a6b46d343da03"><span class="id" title="notation">∘</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:231"><span class="id" title="variable">args</span></a>) (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:228"><span class="id" title="variable">s</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:229"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:230"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst"><span class="id" title="definition">subst</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:228"><span class="id" title="variable">s</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:229"><span class="id" title="variable">k</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_aux"><span class="id" title="abbreviation">dearg_aux</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:231"><span class="id" title="variable">args</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:230"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">vcases</span> <span class="id" title="var">es</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="keyword">using</span> <a class="idref" href="MetaCoq.Erasure.EInduction.html#term_forall_list_ind"><span class="id" title="lemma">term_forall_list_ind</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">s</span>, <span class="id" title="var">k</span>, <span class="id" title="var">t</span>, <span class="id" title="var">args</span>, <span class="id" title="var">vcases</span>, <span class="id" title="var">es</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">refold'</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst_mkApps"><span class="id" title="lemma">subst_mkApps</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_map"><span class="id" title="lemma">map_map</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst_mkApps"><span class="id" title="lemma">subst_mkApps</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_map"><span class="id" title="lemma">map_map</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#0f31f5c1c6b6a21a3a187247222bc9e4"><span class="id" title="notation">&lt;=?</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:?; <span class="id" title="var">propify</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#nth_error_map"><span class="id" title="lemma">nth_error_map</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">nth</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_expanded"><span class="id" title="lemma">dearg_expanded</span></a>, <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lift_dearg"><span class="id" title="lemma">lift_dearg</span></a>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_lift"><span class="id" title="lemma">is_expanded_lift</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#nth_error_forall"><span class="id" title="lemma">nth_error_forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">nth</span>; [|<span class="id" title="var">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst_mkApps"><span class="id" title="lemma">subst_mkApps</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_map"><span class="id" title="lemma">map_map</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst_mkApps"><span class="id" title="lemma">subst_mkApps</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_map"><span class="id" title="lemma">map_map</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_map"><span class="id" title="lemma">map_map</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (<span class="id" title="var">p</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst_mkApps"><span class="id" title="lemma">subst_mkApps</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_map"><span class="id" title="lemma">map_map</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (<span class="id" title="var">IHt</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst_mkApps"><span class="id" title="lemma">subst_mkApps</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_map"><span class="id" title="lemma">map_map</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (<span class="id" title="var">IHt1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (<span class="id" title="var">IHt2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>).<br/>
&nbsp;&nbsp;- <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHt1</span> <span class="id" title="var">s</span> <span class="id" title="var">k</span> (<span class="id" title="var">t2</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">args</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">IHt1</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (<span class="id" title="var">IHt2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>).<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#subst_dearg_single"><span class="id" title="lemma">subst_dearg_single</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_map"><span class="id" title="lemma">map_map</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">args0</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#subst_dearg_single"><span class="id" title="lemma">subst_dearg_single</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_map"><span class="id" title="lemma">map_map</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst_mkApps"><span class="id" title="lemma">subst_mkApps</span></a>, !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_map"><span class="id" title="lemma">map_map</span></a>, <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#subst_dearg_case"><span class="id" title="lemma">subst_dearg_case</span></a> <span class="id" title="tactic">by</span> (<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_case_masks_dearg_branches"><span class="id" title="lemma">valid_case_masks_dearg_branches</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>; [<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (<span class="id" title="var">IHt</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>)|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">vcases</span> <span class="id" title="keyword">as</span> ((<span class="id" title="var">_</span> &amp; <span class="id" title="var">vcases</span>) &amp; <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> -<span class="id" title="var">X</span> <span class="id" title="var">vcases</span> <span class="id" title="var">es</span> <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>; [<span class="id" title="tactic">f_equal</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">specialize</span> (<span class="id" title="var">p</span> <span class="id" title="var">s</span> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">x</span><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>). <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">dearg</span> <span class="id" title="tactic">in</span> *;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">s0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst_mkApps"><span class="id" title="lemma">subst_mkApps</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_map"><span class="id" title="lemma">map_map</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">dearg_proj</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (<span class="id" title="var">IHt</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst_mkApps"><span class="id" title="lemma">subst_mkApps</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_map"><span class="id" title="lemma">map_map</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_map"><span class="id" title="lemma">map_map</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">k</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">k</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>; [|<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EAst.html#map_def"><span class="id" title="definition">map_def</span></a>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (<span class="id" title="var">p</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst_mkApps"><span class="id" title="lemma">subst_mkApps</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_map"><span class="id" title="lemma">map_map</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_map"><span class="id" title="lemma">map_map</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">k</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">k</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>; [|<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EAst.html#map_def"><span class="id" title="definition">map_def</span></a>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (<span class="id" title="var">p</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>).<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst_mkApps"><span class="id" title="lemma">subst_mkApps</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_map"><span class="id" title="lemma">map_map</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="dearg_subst" class="idref" href="#dearg_subst"><span class="id" title="lemma">dearg_subst</span></a> <a id="s:233" class="idref" href="#s:233"><span class="id" title="binder">s</span></a> <a id="k:234" class="idref" href="#k:234"><span class="id" title="binder">k</span></a> <a id="t:235" class="idref" href="#t:235"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:235"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <a id="s:236" class="idref" href="#s:236"><span class="id" title="binder">s</span></a> ⇒ <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:236"><span class="id" title="variable">s</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:233"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:233"><span class="id" title="variable">s</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:234"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:235"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst"><span class="id" title="definition">subst</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:233"><span class="id" title="variable">s</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:234"><span class="id" title="variable">k</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:235"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">apply</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_aux_subst"><span class="id" title="lemma">dearg_aux_subst</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>). <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="valid_cases_mkApps_inv" class="idref" href="#valid_cases_mkApps_inv"><span class="id" title="lemma">valid_cases_mkApps_inv</span></a> <a id="hd:237" class="idref" href="#hd:237"><span class="id" title="binder">hd</span></a> <a id="args:238" class="idref" href="#args:238"><span class="id" title="binder">args</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:237"><span class="id" title="variable">hd</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:238"><span class="id" title="variable">args</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:237"><span class="id" title="variable">hd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:238"><span class="id" title="variable">args</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">args</span> <span class="id" title="keyword">using</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#rev_ind"><span class="id" title="lemma">List.rev_ind</span></a>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.EAstUtils.html#mkApps_app"><span class="id" title="lemma">mkApps_app</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#app_Forall"><span class="id" title="lemma">app_Forall</span></a>; <span class="id" title="tactic">intuition</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="is_expanded_aux_mkApps_eq" class="idref" href="#is_expanded_aux_mkApps_eq"><span class="id" title="lemma">is_expanded_aux_mkApps_eq</span></a> <a id="n:239" class="idref" href="#n:239"><span class="id" title="binder">n</span></a> <a id="hd:240" class="idref" href="#hd:240"><span class="id" title="binder">hd</span></a> <a id="args:241" class="idref" href="#args:241"><span class="id" title="binder">args</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:239"><span class="id" title="variable">n</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:240"><span class="id" title="variable">hd</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:241"><span class="id" title="variable">args</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:239"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:241"><span class="id" title="variable">args</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:240"><span class="id" title="variable">hd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#forallb"><span class="id" title="definition">forallb</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:241"><span class="id" title="variable">args</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">args</span> <span class="id" title="tactic">in</span> <span class="id" title="var">args</span>, <span class="id" title="var">n</span> |- × <span class="id" title="keyword">using</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#rev_ind"><span class="id" title="lemma">List.rev_ind</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Bool.Bool.html#andb_true_r"><span class="id" title="lemma">Bool.andb_true_r</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.EAstUtils.html#mkApps_app"><span class="id" title="lemma">mkApps_app</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#forallb_app"><span class="id" title="lemma">forallb_app</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHargs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Bool.Bool.html#andb_true_r"><span class="id" title="lemma">Bool.andb_true_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Bool.Bool.html#andb_assoc"><span class="id" title="lemma">Bool.andb_assoc</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Bool.Bool.html#andb_comm"><span class="id" title="lemma">Bool.andb_comm</span></a>; <span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Bool.Bool.html#andb_assoc"><span class="id" title="lemma">Bool.andb_assoc</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="is_expanded_mkApps_eq" class="idref" href="#is_expanded_mkApps_eq"><span class="id" title="lemma">is_expanded_mkApps_eq</span></a> <a id="hd:242" class="idref" href="#hd:242"><span class="id" title="binder">hd</span></a> <a id="args:243" class="idref" href="#args:243"><span class="id" title="binder">args</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:242"><span class="id" title="variable">hd</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:243"><span class="id" title="variable">args</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:243"><span class="id" title="variable">args</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:242"><span class="id" title="variable">hd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#forallb"><span class="id" title="definition">forallb</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:243"><span class="id" title="variable">args</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_mkApps_eq"><span class="id" title="lemma">is_expanded_aux_mkApps_eq</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="is_expanded_aux_mkApps_inv" class="idref" href="#is_expanded_aux_mkApps_inv"><span class="id" title="lemma">is_expanded_aux_mkApps_inv</span></a> <a id="n:244" class="idref" href="#n:244"><span class="id" title="binder">n</span></a> <a id="hd:245" class="idref" href="#hd:245"><span class="id" title="binder">hd</span></a> <a id="args:246" class="idref" href="#args:246"><span class="id" title="binder">args</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:244"><span class="id" title="variable">n</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:245"><span class="id" title="variable">hd</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:246"><span class="id" title="variable">args</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:244"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:246"><span class="id" title="variable">args</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:245"><span class="id" title="variable">hd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:246"><span class="id" title="variable">args</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">exp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_mkApps_eq"><span class="id" title="lemma">is_expanded_aux_mkApps_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">exp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="is_expanded_aux_mkApps" class="idref" href="#is_expanded_aux_mkApps"><span class="id" title="lemma">is_expanded_aux_mkApps</span></a> <a id="n:247" class="idref" href="#n:247"><span class="id" title="binder">n</span></a> <a id="hd:248" class="idref" href="#hd:248"><span class="id" title="binder">hd</span></a> <a id="args:249" class="idref" href="#args:249"><span class="id" title="binder">args</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:247"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:249"><span class="id" title="variable">args</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:248"><span class="id" title="variable">hd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <a id="a:250" class="idref" href="#a:250"><span class="id" title="binder">a</span></a> ⇒ <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#a:250"><span class="id" title="variable">a</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:249"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:247"><span class="id" title="variable">n</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:248"><span class="id" title="variable">hd</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:249"><span class="id" title="variable">args</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">exp_hd</span> <span class="id" title="var">exp_args</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_mkApps_eq"><span class="id" title="lemma">is_expanded_aux_mkApps_eq</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">exp_hd</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="is_expanded_aux_upwards" class="idref" href="#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a> <a id="n:251" class="idref" href="#n:251"><span class="id" title="binder">n</span></a> <a id="t:252" class="idref" href="#t:252"><span class="id" title="binder">t</span></a> <a id="n':253" class="idref" href="#n':253"><span class="id" title="binder">n'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:251"><span class="id" title="variable">n</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:252"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:251"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n':253"><span class="id" title="variable">n'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n':253"><span class="id" title="variable">n'</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:252"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">exp</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">n</span>, <span class="id" title="var">t</span>, <span class="id" title="var">n'</span>, <span class="id" title="var">l</span>, <span class="id" title="var">exp</span> |- × <span class="id" title="keyword">using</span> <a class="idref" href="MetaCoq.Erasure.EInduction.html#term_forall_list_ind"><span class="id" title="lemma">term_forall_list_ind</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>; <span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="is_expanded_csubst" class="idref" href="#is_expanded_csubst"><span class="id" title="lemma">is_expanded_csubst</span></a> <a id="s:254" class="idref" href="#s:254"><span class="id" title="binder">s</span></a> <a id="n:255" class="idref" href="#n:255"><span class="id" title="binder">n</span></a> <a id="t:256" class="idref" href="#t:256"><span class="id" title="binder">t</span></a> <a id="k:257" class="idref" href="#k:257"><span class="id" title="binder">k</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> 0 <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:254"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:255"><span class="id" title="variable">n</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:256"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:255"><span class="id" title="variable">n</span></a> (<a class="idref" href="MetaCoq.Erasure.ECSubst.html#csubst"><span class="id" title="definition">csubst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:254"><span class="id" title="variable">s</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:257"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:256"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">exps</span> <span class="id" title="var">expt</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">s</span>, <span class="id" title="var">n</span>, <span class="id" title="var">t</span>, <span class="id" title="var">k</span>, <span class="id" title="var">exps</span>, <span class="id" title="var">expt</span> |- × <span class="id" title="keyword">using</span> <a class="idref" href="MetaCoq.Erasure.EInduction.html#term_forall_list_ind"><span class="id" title="lemma">term_forall_list_ind</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.compare_spec"><span class="id" title="lemma">Nat.compare_spec</span></a> <span class="id" title="var">k</span> <span class="id" title="var">n0</span>) <span class="id" title="keyword">as</span> [&lt;-| |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>, <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_map"><span class="id" title="lemma">forallb_map</span></a>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>, <span class="id" title="var">k</span>, <span class="id" title="var">expt</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×. <span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">m</span>, <span class="id" title="var">X</span>, <span class="id" title="var">k</span>, <span class="id" title="var">expt</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>, <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">m</span>, <span class="id" title="var">X</span>, <span class="id" title="var">k</span>, <span class="id" title="var">expt</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>, <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="is_expanded_aux_subst" class="idref" href="#is_expanded_aux_subst"><span class="id" title="lemma">is_expanded_aux_subst</span></a> <a id="s:258" class="idref" href="#s:258"><span class="id" title="binder">s</span></a> <a id="n:259" class="idref" href="#n:259"><span class="id" title="binder">n</span></a> <a id="t:260" class="idref" href="#t:260"><span class="id" title="binder">t</span></a> <a id="k:261" class="idref" href="#k:261"><span class="id" title="binder">k</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> 0 <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:258"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:259"><span class="id" title="variable">n</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:260"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:259"><span class="id" title="variable">n</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:258"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:261"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:260"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">exps</span> <span class="id" title="var">expt</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">s</span>, <span class="id" title="var">n</span>, <span class="id" title="var">t</span>, <span class="id" title="var">k</span>, <span class="id" title="var">exps</span>, <span class="id" title="var">expt</span> |- × <span class="id" title="keyword">using</span> <a class="idref" href="MetaCoq.Erasure.EInduction.html#term_forall_list_ind"><span class="id" title="lemma">term_forall_list_ind</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#0f31f5c1c6b6a21a3a187247222bc9e4"><span class="id" title="notation">&lt;=?</span></a> <span class="id" title="var">_</span>); [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">nth</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <span class="id" title="var">_</span>); <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">noconf</span> <span class="id" title="var">nth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_lift"><span class="id" title="lemma">is_expanded_aux_lift</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#nth_error_nil"><span class="id" title="lemma">nth_error_nil</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">nth</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>, <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_map"><span class="id" title="lemma">forallb_map</span></a>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>, <span class="id" title="var">k</span>, <span class="id" title="var">expt</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×. <span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">m</span>, <span class="id" title="var">X</span>, <span class="id" title="var">k</span>, <span class="id" title="var">expt</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>, <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">m</span>, <span class="id" title="var">X</span>, <span class="id" title="var">k</span>, <span class="id" title="var">expt</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>, <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="is_expanded_substl" class="idref" href="#is_expanded_substl"><span class="id" title="lemma">is_expanded_substl</span></a> <a id="s:262" class="idref" href="#s:262"><span class="id" title="binder">s</span></a> <a id="n:263" class="idref" href="#n:263"><span class="id" title="binder">n</span></a> <a id="t:264" class="idref" href="#t:264"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <a id="s:265" class="idref" href="#s:265"><span class="id" title="binder">s</span></a> ⇒ <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:265"><span class="id" title="variable">s</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:262"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:263"><span class="id" title="variable">n</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:264"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:263"><span class="id" title="variable">n</span></a> (<a class="idref" href="MetaCoq.Erasure.ECSubst.html#substl"><span class="id" title="definition">substl</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:262"><span class="id" title="variable">s</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:264"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">all</span> <span class="id" title="var">exp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.ECSubst.html#substl"><span class="id" title="definition">substl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">s</span> <span class="id" title="keyword">using</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#rev_ind"><span class="id" title="lemma">List.rev_ind</span></a>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#fold_left_app"><span class="id" title="lemma">fold_left_app</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">all</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_csubst"><span class="id" title="lemma">is_expanded_csubst</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="Forall_is_expanded_fix_subst" class="idref" href="#Forall_is_expanded_fix_subst"><span class="id" title="lemma">Forall_is_expanded_fix_subst</span></a> <a id="defs:266" class="idref" href="#defs:266"><span class="id" title="binder">defs</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="MetaCoq.Utils.MCPrelude.html#c90061783c20674b3a3a6b46d343da03"><span class="id" title="notation">∘</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#dbody"><span class="id" title="projection">dbody</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:266"><span class="id" title="variable">defs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> (<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#fix_subst"><span class="id" title="definition">fix_subst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:266"><span class="id" title="variable">defs</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">all</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#fix_subst"><span class="id" title="definition">fix_subst</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">defs</span> <span class="id" title="tactic">at</span> 2; <span class="id" title="tactic">constructor</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="Forall_is_expanded_cofix_subst" class="idref" href="#Forall_is_expanded_cofix_subst"><span class="id" title="lemma">Forall_is_expanded_cofix_subst</span></a> <a id="defs:267" class="idref" href="#defs:267"><span class="id" title="binder">defs</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="MetaCoq.Utils.MCPrelude.html#c90061783c20674b3a3a6b46d343da03"><span class="id" title="notation">∘</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#dbody"><span class="id" title="projection">dbody</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:267"><span class="id" title="variable">defs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> (<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#cofix_subst"><span class="id" title="definition">cofix_subst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:267"><span class="id" title="variable">defs</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">all</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#cofix_subst"><span class="id" title="definition">cofix_subst</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">defs</span> <span class="id" title="tactic">at</span> 2; <span class="id" title="tactic">constructor</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="is_expanded_cunfold_fix" class="idref" href="#is_expanded_cunfold_fix"><span class="id" title="lemma">is_expanded_cunfold_fix</span></a> <a id="defs:268" class="idref" href="#defs:268"><span class="id" title="binder">defs</span></a> <a id="i:269" class="idref" href="#i:269"><span class="id" title="binder">i</span></a> <a id="narg:270" class="idref" href="#narg:270"><span class="id" title="binder">narg</span></a> <a id="f:271" class="idref" href="#f:271"><span class="id" title="binder">f</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#cunfold_fix"><span class="id" title="definition">cunfold_fix</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:268"><span class="id" title="variable">defs</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:269"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#narg:270"><span class="id" title="variable">narg</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#f:271"><span class="id" title="variable">f</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <a id="d:272" class="idref" href="#d:272"><span class="id" title="binder">d</span></a> ⇒ <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#dbody"><span class="id" title="projection">dbody</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#d:272"><span class="id" title="variable">d</span></a>)) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:268"><span class="id" title="variable">defs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#f:271"><span class="id" title="variable">f</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">cuf</span> <span class="id" title="var">all</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#cunfold_fix"><span class="id" title="definition">cunfold_fix</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">nth</span>; [|<span class="id" title="tactic">congruence</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#nth_error_forall"><span class="id" title="lemma">nth_error_forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">nth</span>; [|<span class="id" title="var">eassumption</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">noconf</span> <span class="id" title="var">cuf</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_substl"><span class="id" title="lemma">is_expanded_substl</span></a>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#Forall_is_expanded_fix_subst"><span class="id" title="lemma">Forall_is_expanded_fix_subst</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="is_expanded_cunfold_cofix" class="idref" href="#is_expanded_cunfold_cofix"><span class="id" title="lemma">is_expanded_cunfold_cofix</span></a> <a id="defs:273" class="idref" href="#defs:273"><span class="id" title="binder">defs</span></a> <a id="i:274" class="idref" href="#i:274"><span class="id" title="binder">i</span></a> <a id="narg:275" class="idref" href="#narg:275"><span class="id" title="binder">narg</span></a> <a id="f:276" class="idref" href="#f:276"><span class="id" title="binder">f</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#cunfold_cofix"><span class="id" title="definition">cunfold_cofix</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:273"><span class="id" title="variable">defs</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:274"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#narg:275"><span class="id" title="variable">narg</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#f:276"><span class="id" title="variable">f</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <a id="d:277" class="idref" href="#d:277"><span class="id" title="binder">d</span></a> ⇒ <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#dbody"><span class="id" title="projection">dbody</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#d:277"><span class="id" title="variable">d</span></a>)) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:273"><span class="id" title="variable">defs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#f:276"><span class="id" title="variable">f</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">cuf</span> <span class="id" title="var">all</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#cunfold_cofix"><span class="id" title="definition">cunfold_cofix</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">nth</span>; [|<span class="id" title="tactic">congruence</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#nth_error_forall"><span class="id" title="lemma">nth_error_forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">nth</span>; [|<span class="id" title="var">eassumption</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">noconf</span> <span class="id" title="var">cuf</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_substl"><span class="id" title="lemma">is_expanded_substl</span></a>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#Forall_is_expanded_cofix_subst"><span class="id" title="lemma">Forall_is_expanded_cofix_subst</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="eq_kername_eq" class="idref" href="#eq_kername_eq"><span class="id" title="lemma">eq_kername_eq</span></a> (<a id="kn0:278" class="idref" href="#kn0:278"><span class="id" title="binder">kn0</span></a> <a id="kn1:279" class="idref" href="#kn1:279"><span class="id" title="binder">kn1</span></a> : <a class="idref" href="MetaCoq.Common.Kernames.html#kername"><span class="id" title="definition">kername</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#kn0:278"><span class="id" title="variable">kn0</span></a> <a class="idref" href="MetaCoq.Utils.ReflectEq.html#12489c9c79e91749bd1f337dd0c899e9"><span class="id" title="notation">==</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#kn1:279"><span class="id" title="variable">kn1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#kn0:278"><span class="id" title="variable">kn0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#kn1:279"><span class="id" title="variable">kn1</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">kn_eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">eq_kername</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaCoq.Common.Kernames.html#Kername.reflect_kername"><span class="id" title="instance">Kername.reflect_kername</span></a> <span class="id" title="keyword">as</span> [<span class="id" title="var">eq</span> <span class="id" title="var">Heq</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="var">Heq</span> <span class="id" title="var">kn0</span> <span class="id" title="var">kn1</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="lookup_env_Forall" class="idref" href="#lookup_env_Forall"><span class="id" title="lemma">lookup_env_Forall</span></a> {<a id="P:280" class="idref" href="#P:280"><span class="id" title="binder">P</span></a>} <a id="814c8bffd75ac79057558b0ba1e67cc7" class="idref" href="#814c8bffd75ac79057558b0ba1e67cc7"><span class="id" title="binder">Σ</span></a> <a id="kn:282" class="idref" href="#kn:282"><span class="id" title="binder">kn</span></a> <a id="decl:283" class="idref" href="#decl:283"><span class="id" title="binder">decl</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#814c8bffd75ac79057558b0ba1e67cc7"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#kn:282"><span class="id" title="variable">kn</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#decl:283"><span class="id" title="variable">decl</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#P:280"><span class="id" title="variable">P</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#814c8bffd75ac79057558b0ba1e67cc7"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Utils.MCPrelude.html#cd4bc1b07c8b3bdc9f3bbc7941b56107"><span class="id" title="notation">∑</span></a> <a id="b:284" class="idref" href="#b:284"><span class="id" title="binder">b</span></a><a class="idref" href="MetaCoq.Utils.MCPrelude.html#cd4bc1b07c8b3bdc9f3bbc7941b56107"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#P:280"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#kn:282"><span class="id" title="variable">kn</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#b:284"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#decl:283"><span class="id" title="variable">decl</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">look</span> <span class="id" title="var">all</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#find"><span class="id" title="definition">find</span></a> <span class="id" title="keyword">as</span> [((<span class="id" title="var">kn'</span> &amp; <span class="id" title="var">b</span>) &amp; <span class="id" title="var">decl'</span>)|] <span class="id" title="var">eqn</span>:<span class="id" title="var">find</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [|<span class="id" title="tactic">congruence</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">noconf</span> <span class="id" title="var">look</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#find_some"><span class="id" title="lemma">find_some</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">find</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">isin</span> &amp; <span class="id" title="var">name_eq</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#eq_kername_eq"><span class="id" title="lemma">eq_kername_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">name_eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall_forall"><span class="id" title="lemma">Forall_forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">all</span>;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">all</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="is_expanded_constant" class="idref" href="#is_expanded_constant"><span class="id" title="lemma">is_expanded_constant</span></a> <a id="ecfbdabaddf4e5284d914e21ad7ca23c" class="idref" href="#ecfbdabaddf4e5284d914e21ad7ca23c"><span class="id" title="binder">Σ</span></a> <a id="kn:286" class="idref" href="#kn:286"><span class="id" title="binder">kn</span></a> <a id="cst:287" class="idref" href="#cst:287"><span class="id" title="binder">cst</span></a> <a id="body:288" class="idref" href="#body:288"><span class="id" title="binder">body</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_env"><span class="id" title="abbreviation">is_expanded_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ecfbdabaddf4e5284d914e21ad7ca23c"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#declared_constant"><span class="id" title="definition">EGlobalEnv.declared_constant</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ecfbdabaddf4e5284d914e21ad7ca23c"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#kn:286"><span class="id" title="variable">kn</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#cst:287"><span class="id" title="variable">cst</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EAst.html#cst_body"><span class="id" title="projection">EAst.cst_body</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#cst:287"><span class="id" title="variable">cst</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#body:288"><span class="id" title="variable">body</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#body:288"><span class="id" title="variable">body</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">exp_env</span> <span class="id" title="var">decl</span> <span class="id" title="var">body_eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">is_expanded_env</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">exp_env</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#declared_constant_trans_env"><span class="id" title="lemma">declared_constant_trans_env</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">decl</span> <span class="id" title="keyword">as</span> [(? &amp; → &amp; <span class="id" title="var">look</span>)|(? &amp; → &amp; <span class="id" title="var">look</span>)]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_env_Forall"><span class="id" title="lemma">lookup_env_Forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">look</span> <span class="id" title="keyword">as</span> (? &amp; <span class="id" title="var">P</span>); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">body_eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">P</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [|<span class="id" title="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">replace</span> <span class="id" title="var">body</span> <span class="id" title="keyword">with</span> <a class="idref" href="MetaCoq.Erasure.EAst.html#tBox"><span class="id" title="constructor">tBox</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="eval_is_expanded_aux" class="idref" href="#eval_is_expanded_aux"><span class="id" title="lemma">eval_is_expanded_aux</span></a> {<a id="wfl:289" class="idref" href="#wfl:289"><span class="id" title="binder">wfl</span></a> : <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">WcbvFlags</span></a>} <a id="bbd035773a529b63dc6323e3d43b3600" class="idref" href="#bbd035773a529b63dc6323e3d43b3600"><span class="id" title="binder">Σ</span></a> <a id="t:291" class="idref" href="#t:291"><span class="id" title="binder">t</span></a> <a id="v:292" class="idref" href="#v:292"><span class="id" title="binder">v</span></a> <a id="k:293" class="idref" href="#k:293"><span class="id" title="binder">k</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#with_constructor_as_block"><span class="id" title="method">with_constructor_as_block</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#bbd035773a529b63dc6323e3d43b3600"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">e</span></a><a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⊢</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:291"><span class="id" title="variable">t</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⇓</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#v:292"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_env"><span class="id" title="abbreviation">is_expanded_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#bbd035773a529b63dc6323e3d43b3600"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:293"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:291"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:293"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#v:292"><span class="id" title="variable">v</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? <span class="id" title="var">ev</span> <span class="id" title="var">exp_env</span> <span class="id" title="var">exp_t</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">ev</span> <span class="id" title="tactic">in</span> <span class="id" title="var">t</span>, <span class="id" title="var">v</span>, <span class="id" title="var">k</span>, <span class="id" title="var">ev</span>, <span class="id" title="var">exp_t</span> |- *; <span class="id" title="tactic">auto</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">IHev3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_csubst"><span class="id" title="lemma">is_expanded_csubst</span></a>; <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">IHev2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_csubst"><span class="id" title="lemma">is_expanded_csubst</span></a>; <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">IHev2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#iota_red"><span class="id" title="definition">EGlobalEnv.iota_red</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHev1</span> 0 <span class="id" title="keyword">ltac</span>:(<span class="id" title="var">easy</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_mkApps_inv"><span class="id" title="lemma">is_expanded_aux_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IHev1</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">exp_hd</span> &amp; <span class="id" title="var">exp_args</span>); <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_substl"><span class="id" title="lemma">is_expanded_substl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall_rev"><span class="id" title="lemma">Forall_rev</span></a>. <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#Forall_skipn"><span class="id" title="lemma">Forall_skipn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">br</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">bctx</span> <span class="id" title="var">br</span>];<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">exp_t</span> <span class="id" title="keyword">as</span> [? <span class="id" title="var">exp_brs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_nth_error"><span class="id" title="lemma">forallb_nth_error</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">exp_brs</span>;<span class="id" title="tactic">eauto</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">exp_brs</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">IHev2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_substl"><span class="id" title="lemma">is_expanded_substl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="tactic">in</span> <span class="id" title="var">n</span> |- *;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">subst</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×. <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">IHev3</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">IHev3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHev1</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHev2</span> 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>; <span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_mkApps_inv"><span class="id" title="lemma">is_expanded_aux_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span> <span class="id" title="keyword">as</span> (? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_mkApps"><span class="id" title="lemma">is_expanded_aux_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a> 0); [|<span class="id" title="var">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_cunfold_fix"><span class="id" title="lemma">is_expanded_cunfold_fix</span></a>; [<span class="id" title="var">eassumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">IHev3</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">IHev3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHev1</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHev2</span> 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>; <span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a> 0); [|<span class="id" title="var">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_cunfold_fix"><span class="id" title="lemma">is_expanded_cunfold_fix</span></a>; [<span class="id" title="var">eassumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">IHev2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">exp_t</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">H1</span> <span class="id" title="var">H2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHev1</span> 0 <span class="id" title="var">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_mkApps_inv"><span class="id" title="lemma">is_expanded_aux_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IHev1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>;<span class="id" title="tactic">split</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_mkApps"><span class="id" title="lemma">is_expanded_aux_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a> 0); [|<span class="id" title="var">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_cunfold_cofix"><span class="id" title="lemma">is_expanded_cunfold_cofix</span></a>; [<span class="id" title="var">eassumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">IHev2</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">IHev2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHev1</span> <span class="id" title="var">_</span> <span class="id" title="var">exp_t</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_mkApps_inv"><span class="id" title="lemma">is_expanded_aux_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IHev1</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">exp_hd</span> &amp; <span class="id" title="var">exp_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_mkApps"><span class="id" title="lemma">is_expanded_aux_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a> 0); [|<span class="id" title="var">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_cunfold_cofix"><span class="id" title="lemma">is_expanded_cunfold_cofix</span></a>; [<span class="id" title="var">eassumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">IHev</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a> 0); [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_constant"><span class="id" title="lemma">is_expanded_constant</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">IHev2</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">IHev2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHev1</span> <span class="id" title="var">_</span> <span class="id" title="var">exp_t</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_mkApps_inv"><span class="id" title="lemma">is_expanded_aux_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IHev1</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">exp_hd</span> &amp; <span class="id" title="var">exp_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">nth</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">e3</span>;<span class="id" title="tactic">subst</span>;<span class="id" title="tactic">clear</span> <span class="id" title="var">e3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#nth_error_forall"><span class="id" title="lemma">nth_error_forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">nth</span>; [|<span class="id" title="var">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a> 0).<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="valid_case_masks_lift" class="idref" href="#valid_case_masks_lift"><span class="id" title="lemma">valid_case_masks_lift</span></a> <a id="ind:294" class="idref" href="#ind:294"><span class="id" title="binder">ind</span></a> <a id="c:295" class="idref" href="#c:295"><span class="id" title="binder">c</span></a> <a id="brs:296" class="idref" href="#brs:296"><span class="id" title="binder">brs</span></a> <a id="n:297" class="idref" href="#n:297"><span class="id" title="binder">n</span></a> <a id="k:298" class="idref" href="#k:298"><span class="id" title="binder">k</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_case_masks"><span class="id" title="abbreviation">valid_case_masks</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:294"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c:295"><span class="id" title="variable">c</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#brs:296"><span class="id" title="variable">brs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_case_masks"><span class="id" title="abbreviation">valid_case_masks</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:294"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c:295"><span class="id" title="variable">c</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<span class="id" title="keyword">fun</span> <a id="br:299" class="idref" href="#br:299"><span class="id" title="binder">br</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#br:299"><span class="id" title="variable">br</span></a><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#lift"><span class="id" title="definition">lift</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:297"><span class="id" title="variable">n</span></a> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#br:299"><span class="id" title="variable">br</span></a><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:298"><span class="id" title="variable">k</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#br:299"><span class="id" title="variable">br</span></a><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#brs:296"><span class="id" title="variable">brs</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">valid_case_masks</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> <span class="id" title="var">_</span>); [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">valid</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">_</span> &amp; <span class="id" title="var">valid</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#alli_Alli"><span class="id" title="lemma">alli_Alli</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#alli_Alli"><span class="id" title="lemma">alli_Alli</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Utils.MCList.html#mapi_cst_map"><span class="id" title="lemma">mapi_cst_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#Alli_mapi"><span class="id" title="lemma">Alli_mapi</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">f</span> := (<span class="id" title="keyword">fun</span> (<span class="id" title="var">_</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) <span class="id" title="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#Alli_impl"><span class="id" title="lemma">Alli_impl</span></a>; [<span class="id" title="var">eassumption</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? [] <span class="id" title="var">val_branch</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_dearg_mask_branch_lift"><span class="id" title="lemma">valid_dearg_mask_branch_lift</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a>,<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#repeat_length"><span class="id" title="lemma">repeat_length</span></a>,<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#rev_length"><span class="id" title="lemma">List.rev_length</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="valid_dearg_branch_subst" class="idref" href="#valid_dearg_branch_subst"><span class="id" title="lemma">valid_dearg_branch_subst</span></a> <a id="i:300" class="idref" href="#i:300"><span class="id" title="binder">i</span></a> <a id="mask:301" class="idref" href="#mask:301"><span class="id" title="binder">mask</span></a> <a id="s:302" class="idref" href="#s:302"><span class="id" title="binder">s</span></a> <a id="k:303" class="idref" href="#k:303"><span class="id" title="binder">k</span></a> <a id="k':304" class="idref" href="#k':304"><span class="id" title="binder">k'</span></a> <a id="t:305" class="idref" href="#t:305"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:300"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:301"><span class="id" title="variable">mask</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k':304"><span class="id" title="variable">k'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_dearg_mask_branch"><span class="id" title="definition">valid_dearg_mask_branch</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:300"><span class="id" title="variable">i</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:301"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:305"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_dearg_mask_branch"><span class="id" title="definition">valid_dearg_mask_branch</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:300"><span class="id" title="variable">i</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:301"><span class="id" title="variable">mask</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:302"><span class="id" title="variable">s</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k':304"><span class="id" title="variable">k'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:303"><span class="id" title="variable">k</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:305"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hik</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">mask</span> <span class="id" title="tactic">in</span> <span class="id" title="var">mask</span>, <span class="id" title="var">i</span>, <span class="id" title="var">k</span>, <span class="id" title="var">k'</span>, <span class="id" title="var">Hik</span>, <span class="id" title="var">valid</span> |- *;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;- <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_dead_subst_other"><span class="id" title="lemma">is_dead_subst_other</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="valid_case_masks_subst" class="idref" href="#valid_case_masks_subst"><span class="id" title="lemma">valid_case_masks_subst</span></a> <a id="ind:306" class="idref" href="#ind:306"><span class="id" title="binder">ind</span></a> <a id="c:307" class="idref" href="#c:307"><span class="id" title="binder">c</span></a> <a id="brs:308" class="idref" href="#brs:308"><span class="id" title="binder">brs</span></a> <a id="s:309" class="idref" href="#s:309"><span class="id" title="binder">s</span></a> <a id="k:310" class="idref" href="#k:310"><span class="id" title="binder">k</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_case_masks"><span class="id" title="abbreviation">valid_case_masks</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:306"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c:307"><span class="id" title="variable">c</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#brs:308"><span class="id" title="variable">brs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_case_masks"><span class="id" title="abbreviation">valid_case_masks</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:306"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c:307"><span class="id" title="variable">c</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<span class="id" title="keyword">fun</span> <a id="br:311" class="idref" href="#br:311"><span class="id" title="binder">br</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#br:311"><span class="id" title="variable">br</span></a><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:309"><span class="id" title="variable">s</span></a> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#br:311"><span class="id" title="variable">br</span></a><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:310"><span class="id" title="variable">k</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#br:311"><span class="id" title="variable">br</span></a><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#brs:308"><span class="id" title="variable">brs</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">valid_case_masks</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> <span class="id" title="var">_</span>); [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">valid</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">_</span> &amp; <span class="id" title="var">valid</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#alli_Alli"><span class="id" title="lemma">alli_Alli</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#alli_Alli"><span class="id" title="lemma">alli_Alli</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Utils.MCList.html#mapi_cst_map"><span class="id" title="lemma">mapi_cst_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#Alli_mapi"><span class="id" title="lemma">Alli_mapi</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">f</span> := (<span class="id" title="keyword">fun</span> (<span class="id" title="var">_</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) <span class="id" title="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#Alli_impl"><span class="id" title="lemma">Alli_impl</span></a>; [<span class="id" title="var">eassumption</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? [] <span class="id" title="var">val_branch</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_dearg_branch_subst"><span class="id" title="lemma">valid_dearg_branch_subst</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a>,<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#repeat_length"><span class="id" title="lemma">repeat_length</span></a>,<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#rev_length"><span class="id" title="lemma">List.rev_length</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="valid_cases_lift" class="idref" href="#valid_cases_lift"><span class="id" title="lemma">valid_cases_lift</span></a> <a id="t:312" class="idref" href="#t:312"><span class="id" title="binder">t</span></a> <a id="n:313" class="idref" href="#n:313"><span class="id" title="binder">n</span></a> <a id="k:314" class="idref" href="#k:314"><span class="id" title="binder">k</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:312"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#lift"><span class="id" title="definition">lift</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:313"><span class="id" title="variable">n</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:314"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:312"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid_t</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">t</span>, <span class="id" title="var">k</span>, <span class="id" title="var">valid_t</span> |- × <span class="id" title="keyword">using</span> <a class="idref" href="MetaCoq.Erasure.EInduction.html#term_forall_list_ind"><span class="id" title="lemma">term_forall_list_ind</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#0f31f5c1c6b6a21a3a187247222bc9e4"><span class="id" title="notation">&lt;=?</span></a> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">args</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">valid_t</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">valid</span> <span class="id" title="var">valid_all</span>]<span class="id" title="var">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>, <span class="id" title="var">k</span>, <span class="id" title="var">l</span>, <span class="id" title="var">valid</span>, <span class="id" title="var">valid_all</span> |- *;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_case_masks_lift"><span class="id" title="lemma">valid_case_masks_lift</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>, <span class="id" title="var">k</span>, <span class="id" title="var">valid_t</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>, <span class="id" title="var">k</span>, <span class="id" title="var">valid_t</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="valid_cases_subst" class="idref" href="#valid_cases_subst"><span class="id" title="lemma">valid_cases_subst</span></a> <a id="s:315" class="idref" href="#s:315"><span class="id" title="binder">s</span></a> <a id="k:316" class="idref" href="#k:316"><span class="id" title="binder">k</span></a> <a id="t:317" class="idref" href="#t:317"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:315"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:317"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:315"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:316"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:317"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid_s</span> <span class="id" title="var">valid_t</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k</span>, <span class="id" title="var">t</span>, <span class="id" title="var">valid_t</span> |- × <span class="id" title="keyword">using</span> <a class="idref" href="MetaCoq.Erasure.EInduction.html#term_forall_list_ind"><span class="id" title="lemma">term_forall_list_ind</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#0f31f5c1c6b6a21a3a187247222bc9e4"><span class="id" title="notation">&lt;=?</span></a> <span class="id" title="var">_</span>); [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">nth</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <span class="id" title="var">_</span>); <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">noconf</span> <span class="id" title="var">nth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_lift"><span class="id" title="lemma">valid_cases_lift</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#nth_error_nil"><span class="id" title="lemma">nth_error_nil</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">nth</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">args</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">valid_t</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">valid</span> <span class="id" title="var">valid_all</span>]<span class="id" title="var">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>, <span class="id" title="var">k</span>, <span class="id" title="var">l</span>, <span class="id" title="var">valid</span>, <span class="id" title="var">valid_all</span> |- *;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_case_masks_subst"><span class="id" title="lemma">valid_case_masks_subst</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">s0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>, <span class="id" title="var">k</span>, <span class="id" title="var">valid_t</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>, <span class="id" title="var">k</span>, <span class="id" title="var">valid_t</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="closedn_dearg_single" class="idref" href="#closedn_dearg_single"><span class="id" title="lemma">closedn_dearg_single</span></a> <a id="k:318" class="idref" href="#k:318"><span class="id" title="binder">k</span></a> <a id="t:319" class="idref" href="#t:319"><span class="id" title="binder">t</span></a> <a id="args:320" class="idref" href="#args:320"><span class="id" title="binder">args</span></a> <a id="mask:321" class="idref" href="#mask:321"><span class="id" title="binder">mask</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">closedn</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:318"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:319"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">closedn</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:318"><span class="id" title="variable">k</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:320"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">closedn</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:318"><span class="id" title="variable">k</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_single"><span class="id" title="definition">dearg_single</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:321"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:319"><span class="id" title="variable">t</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:320"><span class="id" title="variable">args</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">clos_t</span> <span class="id" title="var">clos_args</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">mask</span> <span class="id" title="keyword">as</span> [|[] <span class="id" title="var">mask</span> <span class="id" title="var">IH</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">k</span>, <span class="id" title="var">t</span>, <span class="id" title="var">args</span>, <span class="id" title="var">mask</span>, <span class="id" title="var">clos_t</span>, <span class="id" title="var">clos_args</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#closedn_mkApps"><span class="id" title="lemma">closedn_mkApps</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">depelim</span> <span class="id" title="var">clos_args</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closedn_lift"><span class="id" title="lemma">closedn_lift</span></a> 1 <span class="id" title="var">k</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_1_r"><span class="id" title="lemma">Nat.add_1_r</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">depelim</span> <span class="id" title="var">clos_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Bool.Bool.html#andb_true_r"><span class="id" title="lemma">Bool.andb_true_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closedn_lift"><span class="id" title="lemma">closedn_lift</span></a> 1 <span class="id" title="var">k</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_1_r"><span class="id" title="lemma">Nat.add_1_r</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="closedn_dearg_lambdas" class="idref" href="#closedn_dearg_lambdas"><span class="id" title="lemma">closedn_dearg_lambdas</span></a> <a id="k:322" class="idref" href="#k:322"><span class="id" title="binder">k</span></a> <a id="mask:323" class="idref" href="#mask:323"><span class="id" title="binder">mask</span></a> <a id="t:324" class="idref" href="#t:324"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">closedn</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:322"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:324"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">closedn</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:322"><span class="id" title="variable">k</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_lambdas"><span class="id" title="definition">dearg_lambdas</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:323"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:324"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">clos</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k</span>, <span class="id" title="var">mask</span>, <span class="id" title="var">t</span>, <span class="id" title="var">clos</span> |- *; <span class="id" title="tactic">auto</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.ClosedAux.html#closedn_subst0"><span class="id" title="lemma">closedn_subst0</span></a>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">cbn</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_1_r"><span class="id" title="lemma">Nat.add_1_r</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;NOTE:&nbsp;borrowed&nbsp;from&nbsp;MetaCoq&nbsp;(where&nbsp;it's&nbsp;commented&nbsp;out)&nbsp;and&nbsp;fixed&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <a id="closedn_subst" class="idref" href="#closedn_subst"><span class="id" title="lemma">closedn_subst</span></a> <a id="s:325" class="idref" href="#s:325"><span class="id" title="binder">s</span></a> <a id="k:326" class="idref" href="#k:326"><span class="id" title="binder">k</span></a> <a id="k':327" class="idref" href="#k':327"><span class="id" title="binder">k'</span></a> <a id="t:328" class="idref" href="#t:328"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#forallb"><span class="id" title="definition">forallb</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">closedn</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:326"><span class="id" title="variable">k</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:325"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">closedn</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:326"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k':327"><span class="id" title="variable">k'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:325"><span class="id" title="variable">s</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:328"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">closedn</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:326"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k':327"><span class="id" title="variable">k'</span></a>) (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:325"><span class="id" title="variable">s</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k':327"><span class="id" title="variable">k'</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:328"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hs</span>. <span class="id" title="var">solve_all</span>. <span class="id" title="var">revert</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k'</span> |- × <span class="id" title="keyword">using</span> <a class="idref" href="MetaCoq.Erasure.EInduction.html#term_forall_list_ind"><span class="id" title="lemma">term_forall_list_ind</span></a>; <span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> → ?<a class="idref" href="MetaCoq.Utils.MCList.html#map_map_compose"><span class="id" title="lemma">map_map_compose</span></a>, ?<a class="idref" href="MetaCoq.Utils.MCProd.html#compose_on_snd"><span class="id" title="lemma">compose_on_snd</span></a>, ?<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#compose_map_def"><span class="id" title="lemma">compose_map_def</span></a>, ?<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="var">closed</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="var">change_Sk</span>; <span class="id" title="tactic">repeat</span> (<span class="id" title="var">rtoProp</span>; <span class="id" title="var">solve_all</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Program.Basics.html#compose"><span class="id" title="definition">Basics.compose</span></a>, <a class="idref" href="MetaCoq.Erasure.EAst.html#test_def"><span class="id" title="definition">test_def</span></a>, <a class="idref" href="MetaCoq.Utils.MCProd.html#on_snd"><span class="id" title="definition">on_snd</span></a>, <a class="idref" href="MetaCoq.Utils.MCProd.html#test_snd"><span class="id" title="definition">test_snd</span></a> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">all</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">elim</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.leb_spec"><span class="id" title="lemma">Nat.leb_spec</span></a> <span class="id" title="var">k'</span> <span class="id" title="var">n</span>); <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.ltb_lt"><span class="id" title="lemma">Nat.ltb_lt</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closedn_lift"><span class="id" title="lemma">closedn_lift</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#nth_error_all"><span class="id" title="lemma">nth_error_all</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">eauto</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">elim</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.ltb_spec"><span class="id" title="lemma">Nat.ltb_spec</span></a>); <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error_None"><span class="id" title="lemma">nth_error_None</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.ltb_lt"><span class="id" title="lemma">Nat.ltb_lt</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.ltb_lt"><span class="id" title="lemma">Nat.ltb_lt</span></a>. <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.ltb_lt"><span class="id" title="lemma">Nat.ltb_lt</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">rtoProp</span>; <span class="id" title="var">solve_all</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHt</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k'</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_comm"><span class="id" title="lemma">Nat.add_succ_comm</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IHt</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHt2</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k'</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_comm"><span class="id" title="lemma">Nat.add_succ_comm</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IHt2</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">rtoProp</span>; <span class="id" title="var">solve_all</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHt</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k'</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">a0</span> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">x</span><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k'</span>)). <span class="id" title="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#is_true"><span class="id" title="definition">is_true</span></a>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">a0</span>. <span class="id" title="tactic">f_equal</span>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">replace</span> (<span class="id" title="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">x</span><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">s</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>) <span class="id" title="keyword">with</span> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">x</span><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">(</span></a><span class="id" title="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">s</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">)</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">rtoProp</span>; <span class="id" title="var">solve_all</span>. <span class="id" title="tactic">rewrite</span> → !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_assoc"><span class="id" title="lemma">Nat.add_assoc</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">a</span> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">m</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k'</span>)). <span class="id" title="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#is_true"><span class="id" title="definition">is_true</span></a>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">a</span>. <span class="id" title="tactic">f_equal</span>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#is_true"><span class="id" title="definition">is_true</span></a>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">b</span>. <span class="id" title="tactic">f_equal</span>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">rtoProp</span>; <span class="id" title="var">solve_all</span>. <span class="id" title="tactic">rewrite</span> → !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_assoc"><span class="id" title="lemma">Nat.add_assoc</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">a</span> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">m</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k'</span>)). <span class="id" title="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#is_true"><span class="id" title="definition">is_true</span></a>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">a</span>. <span class="id" title="tactic">f_equal</span>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#is_true"><span class="id" title="definition">is_true</span></a>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">b</span>. <span class="id" title="tactic">f_equal</span>. <span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="closedn_dearg_case_branch_body_rec" class="idref" href="#closedn_dearg_case_branch_body_rec"><span class="id" title="lemma">closedn_dearg_case_branch_body_rec</span></a> <a id="i:329" class="idref" href="#i:329"><span class="id" title="binder">i</span></a> <a id="k:330" class="idref" href="#k:330"><span class="id" title="binder">k</span></a> <a id="mask:331" class="idref" href="#mask:331"><span class="id" title="binder">mask</span></a> <a id="t:332" class="idref" href="#t:332"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">closedn</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:329"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:331"><span class="id" title="variable">mask</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:330"><span class="id" title="variable">k</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:332"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">closedn</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:329"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:331"><span class="id" title="variable">mask</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:330"><span class="id" title="variable">k</span></a>) <a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_branch_body_rec"><span class="id" title="definition">dearg_branch_body_rec</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:329"><span class="id" title="variable">i</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:331"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:332"><span class="id" title="variable">t</span></a><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">).2</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">clos</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">mask</span> <span class="id" title="tactic">in</span> <span class="id" title="var">mask</span>, <span class="id" title="var">i</span>, <span class="id" title="var">k</span>, <span class="id" title="var">t</span>, <span class="id" title="var">clos</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed_upwards"><span class="id" title="lemma">closed_upwards</span></a>;<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">IHmask</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst1"><span class="id" title="definition">subst1</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>) <span class="id" title="keyword">with</span> (<span class="id" title="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">i</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#closedn_subst"><span class="id" title="lemma">closedn_subst</span></a>;<span class="id" title="tactic">auto</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">replace</span> (<span class="id" title="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> 1) <span class="id" title="keyword">with</span> (<span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#negb"><span class="id" title="definition">negb</span></a> <span class="id" title="var">mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#negb"><span class="id" title="definition">negb</span></a> <span class="id" title="var">mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>) <span class="id" title="tactic">in</span> × <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="closedn_dearg_aux" class="idref" href="#closedn_dearg_aux"><span class="id" title="lemma">closedn_dearg_aux</span></a> <a id="k:333" class="idref" href="#k:333"><span class="id" title="binder">k</span></a> <a id="args:334" class="idref" href="#args:334"><span class="id" title="binder">args</span></a> <a id="t:335" class="idref" href="#t:335"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">closedn</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:333"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:335"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">closedn</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:333"><span class="id" title="variable">k</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:334"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">closedn</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:333"><span class="id" title="variable">k</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_aux"><span class="id" title="abbreviation">dearg_aux</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:334"><span class="id" title="variable">args</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:335"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">clos_t</span> <span class="id" title="var">clos_args</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k</span>, <span class="id" title="var">args</span>, <span class="id" title="var">clos_t</span>, <span class="id" title="var">clos_args</span> |- × <span class="id" title="keyword">using</span> <a class="idref" href="MetaCoq.Erasure.EInduction.html#term_forall_list_ind"><span class="id" title="lemma">term_forall_list_ind</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_args</span>;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#closedn_mkApps"><span class="id" title="lemma">closedn_mkApps</span></a>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_args</span>;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#closedn_mkApps"><span class="id" title="lemma">closedn_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>. <span class="id" title="tactic">split</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#closedn_mkApps"><span class="id" title="lemma">closedn_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>. <span class="id" title="tactic">split</span>;[|<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_args</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#closedn_mkApps"><span class="id" title="lemma">closedn_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>. <span class="id" title="tactic">split</span>;[|<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_args</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">propify</span>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHt1</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#closedn_dearg_single"><span class="id" title="lemma">closedn_dearg_single</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#closedn_dearg_single"><span class="id" title="lemma">closedn_dearg_single</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_args</span>;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#closedn_mkApps"><span class="id" title="lemma">closedn_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">dearg_case</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> <span class="id" title="var">_</span>); <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>; <span class="id" title="var">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">split</span>;[|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHt</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_map"><span class="id" title="lemma">forallb_map</span></a>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">clos_t</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">_</span> &amp; <span class="id" title="var">clos_brs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>;[|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHt</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">clos_t</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">_</span> &amp; <span class="id" title="var">clos_brs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Utils.MCList.html#mapi"><span class="id" title="definition">mapi</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> 0.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|]; <span class="id" title="tactic">intros</span> <span class="id" title="var">n'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_case_branch"><span class="id" title="definition">dearg_case_branch</span></a>,<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_branch_body"><span class="id" title="definition">dearg_branch_body</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#0f31f5c1c6b6a21a3a187247222bc9e4"><span class="id" title="notation">&lt;=?</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">Hmask</span>;[|<span class="id" title="var">cbn</span>;<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#complete_ctx_mask"><span class="id" title="definition">complete_ctx_mask</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">mm</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mm</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">x</span><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>;<span class="id" title="var">propify</span>;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#complete_ctx_mask_length"><span class="id" title="lemma">complete_ctx_mask_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#masked_count_zeros"><span class="id" title="lemma">masked_count_zeros</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#closedn_dearg_case_branch_body_rec"><span class="id" title="lemma">closedn_dearg_case_branch_body_rec</span></a> 0 (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">x</span><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mm</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>) <span class="id" title="var">mm</span> ((<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_aux"><span class="id" title="abbreviation">dearg_aux</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <span class="id" title="var">x</span><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a>))) <span class="id" title="keyword">as</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mm</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">x</span><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mm</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">with</span> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">x</span><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span>) <span class="id" title="tactic">in</span> × <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_assoc"><span class="id" title="lemma">Nat.add_assoc</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_args</span>;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#closedn_mkApps"><span class="id" title="lemma">closedn_mkApps</span></a>; <span class="id" title="var">propify</span>;<span class="id" title="tactic">split</span>;[|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">dearg_proj</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> <span class="id" title="var">_</span>); <span class="id" title="tactic">apply</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_args</span>;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#closedn_mkApps"><span class="id" title="lemma">closedn_mkApps</span></a>; <span class="id" title="var">propify</span>;<span class="id" title="tactic">split</span>;[|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k</span>, <span class="id" title="var">args</span>, <span class="id" title="var">X</span>, <span class="id" title="var">clos_t</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_args</span>;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#closedn_mkApps"><span class="id" title="lemma">closedn_mkApps</span></a>; <span class="id" title="var">propify</span>;<span class="id" title="tactic">split</span>;[|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k</span>, <span class="id" title="var">args</span>, <span class="id" title="var">X</span>, <span class="id" title="var">clos_t</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">closedn_subst0</span> <span class="id" title="var">closed_mkApps</span> <span class="id" title="var">closedn_dearg_aux</span> <span class="id" title="var">closed_iota_red</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">is_expanded_aux_subst</span> <span class="id" title="var">is_expanded_aux_mkApps</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">valid_cases_subst</span> : <span class="id" title="var">dearg</span>.<br/>
<span class="id" title="keyword">Hint Constructors</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#Forall"><span class="id" title="inductive">Forall</span></a> : <span class="id" title="var">dearg</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="valid_cases_mkApps" class="idref" href="#valid_cases_mkApps"><span class="id" title="lemma">valid_cases_mkApps</span></a> <a id="hd:336" class="idref" href="#hd:336"><span class="id" title="binder">hd</span></a> <a id="args:337" class="idref" href="#args:337"><span class="id" title="binder">args</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:336"><span class="id" title="variable">hd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:337"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:336"><span class="id" title="variable">hd</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:337"><span class="id" title="variable">args</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid_hd</span> <span class="id" title="var">valid_args</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">args</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">args</span> <span class="id" title="var">IH</span>] <span class="id" title="keyword">using</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#rev_ind"><span class="id" title="lemma">List.rev_ind</span></a>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.EAstUtils.html#mkApps_app"><span class="id" title="lemma">mkApps_app</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_args</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="valid_cases_substl" class="idref" href="#valid_cases_substl"><span class="id" title="lemma">valid_cases_substl</span></a> <a id="s:338" class="idref" href="#s:338"><span class="id" title="binder">s</span></a> <a id="t:339" class="idref" href="#t:339"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <a id="s:340" class="idref" href="#s:340"><span class="id" title="binder">s</span></a> ⇒ <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">closed</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:340"><span class="id" title="variable">s</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:338"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:338"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:339"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> (<a class="idref" href="MetaCoq.Erasure.ECSubst.html#substl"><span class="id" title="definition">substl</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:338"><span class="id" title="variable">s</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:339"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">clos_s</span> <span class="id" title="var">valid_s</span> <span class="id" title="var">valid_t</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.ECSubst.html#substl"><span class="id" title="definition">substl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">s</span> <span class="id" title="keyword">using</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#rev_ind"><span class="id" title="lemma">List.rev_ind</span></a>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#fold_left_app"><span class="id" title="lemma">fold_left_app</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_s</span> <span class="id" title="keyword">as</span> (? &amp; ?).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_s</span> <span class="id" title="keyword">as</span> (? &amp; ?).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.ECSubst.html#closed_subst"><span class="id" title="lemma">closed_subst</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_subst"><span class="id" title="lemma">valid_cases_subst</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="valid_cases_iota_red" class="idref" href="#valid_cases_iota_red"><span class="id" title="lemma">valid_cases_iota_red</span></a> <a id="pars:341" class="idref" href="#pars:341"><span class="id" title="binder">pars</span></a> <a id="args:342" class="idref" href="#args:342"><span class="id" title="binder">args</span></a> (<a id="br:343" class="idref" href="#br:343"><span class="id" title="binder">br</span></a> : <a class="idref" href="MetaCoq.Utils.MCProd.html#52eddd74560fa276f934634af83eeaf4"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="MetaCoq.Common.BasicAst.html#name"><span class="id" title="inductive">BasicAst.name</span></a><a class="idref" href="MetaCoq.Utils.MCProd.html#52eddd74560fa276f934634af83eeaf4"><span class="id" title="notation">)</span></a> <a class="idref" href="MetaCoq.Utils.MCProd.html#52eddd74560fa276f934634af83eeaf4"><span class="id" title="notation">×</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#term"><span class="id" title="inductive">term</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:342"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">closedn</span></a> 0) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:342"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#br:343"><span class="id" title="variable">br</span></a><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> (<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#iota_red"><span class="id" title="definition">iota_red</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#pars:341"><span class="id" title="variable">pars</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:342"><span class="id" title="variable">args</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#br:343"><span class="id" title="variable">br</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid_args</span> <span class="id" title="var">valid_brs</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#iota_red"><span class="id" title="definition">iota_red</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_substl"><span class="id" title="lemma">valid_cases_substl</span></a>;<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall_rev"><span class="id" title="lemma">Forall_rev</span></a>, <a class="idref" href="MetaCoq.Utils.All_Forall.html#Forall_skipn"><span class="id" title="lemma">Forall_skipn</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall_rev"><span class="id" title="lemma">Forall_rev</span></a>, <a class="idref" href="MetaCoq.Utils.All_Forall.html#Forall_skipn"><span class="id" title="lemma">Forall_skipn</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="Forall_closed_fix_subst" class="idref" href="#Forall_closed_fix_subst"><span class="id" title="lemma">Forall_closed_fix_subst</span></a> <a id="defs:344" class="idref" href="#defs:344"><span class="id" title="binder">defs</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">closedn</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:344"><span class="id" title="variable">defs</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="MetaCoq.Utils.MCPrelude.html#c90061783c20674b3a3a6b46d343da03"><span class="id" title="notation">∘</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#dbody"><span class="id" title="projection">dbody</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:344"><span class="id" title="variable">defs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">closedn</span></a> 0) (<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#fix_subst"><span class="id" title="definition">fix_subst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:344"><span class="id" title="variable">defs</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">all</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#fix_subst"><span class="id" title="definition">fix_subst</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">defs</span> <span class="id" title="tactic">at</span> 2; <span class="id" title="tactic">constructor</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#Forall_impl"><span class="id" title="lemma">Forall_impl</span></a>; [<span class="id" title="var">eassumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_0_r"><span class="id" title="lemma">Nat.add_0_r</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="Forall_closed_cofix_subst" class="idref" href="#Forall_closed_cofix_subst"><span class="id" title="lemma">Forall_closed_cofix_subst</span></a> <a id="defs:345" class="idref" href="#defs:345"><span class="id" title="binder">defs</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">closedn</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:345"><span class="id" title="variable">defs</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="MetaCoq.Utils.MCPrelude.html#c90061783c20674b3a3a6b46d343da03"><span class="id" title="notation">∘</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#dbody"><span class="id" title="projection">dbody</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:345"><span class="id" title="variable">defs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">closedn</span></a> 0) (<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#cofix_subst"><span class="id" title="definition">cofix_subst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:345"><span class="id" title="variable">defs</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">all</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#cofix_subst"><span class="id" title="definition">cofix_subst</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">defs</span> <span class="id" title="tactic">at</span> 2; <span class="id" title="tactic">constructor</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#Forall_impl"><span class="id" title="lemma">Forall_impl</span></a>; [<span class="id" title="var">eassumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_0_r"><span class="id" title="lemma">Nat.add_0_r</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="Forall_valid_cases_fix_subst" class="idref" href="#Forall_valid_cases_fix_subst"><span class="id" title="lemma">Forall_valid_cases_fix_subst</span></a> <a id="defs:346" class="idref" href="#defs:346"><span class="id" title="binder">defs</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="MetaCoq.Utils.MCPrelude.html#c90061783c20674b3a3a6b46d343da03"><span class="id" title="notation">∘</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#dbody"><span class="id" title="projection">dbody</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:346"><span class="id" title="variable">defs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> (<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#fix_subst"><span class="id" title="definition">fix_subst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:346"><span class="id" title="variable">defs</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">all</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#fix_subst"><span class="id" title="definition">fix_subst</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">defs</span> <span class="id" title="tactic">at</span> 2; <span class="id" title="tactic">constructor</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="Forall_valid_cases_cofix_subst" class="idref" href="#Forall_valid_cases_cofix_subst"><span class="id" title="lemma">Forall_valid_cases_cofix_subst</span></a> <a id="defs:347" class="idref" href="#defs:347"><span class="id" title="binder">defs</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="MetaCoq.Utils.MCPrelude.html#c90061783c20674b3a3a6b46d343da03"><span class="id" title="notation">∘</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#dbody"><span class="id" title="projection">dbody</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:347"><span class="id" title="variable">defs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> (<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#cofix_subst"><span class="id" title="definition">cofix_subst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:347"><span class="id" title="variable">defs</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">all</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#cofix_subst"><span class="id" title="definition">cofix_subst</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">defs</span> <span class="id" title="tactic">at</span> 2; <span class="id" title="tactic">constructor</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="valid_cases_cunfold_fix" class="idref" href="#valid_cases_cunfold_fix"><span class="id" title="lemma">valid_cases_cunfold_fix</span></a> <a id="defs:348" class="idref" href="#defs:348"><span class="id" title="binder">defs</span></a> <a id="i:349" class="idref" href="#i:349"><span class="id" title="binder">i</span></a> <a id="narg:350" class="idref" href="#narg:350"><span class="id" title="binder">narg</span></a> <a id="f:351" class="idref" href="#f:351"><span class="id" title="binder">f</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#cunfold_fix"><span class="id" title="definition">cunfold_fix</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:348"><span class="id" title="variable">defs</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:349"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#narg:350"><span class="id" title="variable">narg</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#f:351"><span class="id" title="variable">f</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">closed</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tFix"><span class="id" title="constructor">tFix</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:348"><span class="id" title="variable">defs</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:349"><span class="id" title="variable">i</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tFix"><span class="id" title="constructor">tFix</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:348"><span class="id" title="variable">defs</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:349"><span class="id" title="variable">i</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#f:351"><span class="id" title="variable">f</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">cuf</span> <span class="id" title="var">clos_defs</span> <span class="id" title="var">valid_defs</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#cunfold_fix"><span class="id" title="definition">cunfold_fix</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">nth</span>; [|<span class="id" title="tactic">congruence</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaCoq.Utils.All_Forall.html#nth_error_forallb"><span class="id" title="lemma">nth_error_forallb</span></a> <span class="id" title="var">nth</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">clos_defs</span> <span class="id" title="keyword">as</span> ?.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaCoq.Utils.All_Forall.html#nth_error_forallb"><span class="id" title="lemma">nth_error_forallb</span></a> <span class="id" title="var">nth</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">valid_defs</span> <span class="id" title="keyword">as</span> ?.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="var">noconf</span> <span class="id" title="var">cuf</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_substl"><span class="id" title="lemma">valid_cases_substl</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#Forall_closed_fix_subst"><span class="id" title="lemma">Forall_closed_fix_subst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_impl"><span class="id" title="lemma">forallb_impl</span></a>; [|<span class="id" title="tactic">exact</span> <span class="id" title="var">clos_defs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_0_r"><span class="id" title="lemma">Nat.add_0_r</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#Forall_valid_cases_fix_subst"><span class="id" title="lemma">Forall_valid_cases_fix_subst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="valid_cases_cunfold_cofix" class="idref" href="#valid_cases_cunfold_cofix"><span class="id" title="lemma">valid_cases_cunfold_cofix</span></a> <a id="defs:352" class="idref" href="#defs:352"><span class="id" title="binder">defs</span></a> <a id="i:353" class="idref" href="#i:353"><span class="id" title="binder">i</span></a> <a id="narg:354" class="idref" href="#narg:354"><span class="id" title="binder">narg</span></a> <a id="f:355" class="idref" href="#f:355"><span class="id" title="binder">f</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#cunfold_cofix"><span class="id" title="definition">cunfold_cofix</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:352"><span class="id" title="variable">defs</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:353"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#narg:354"><span class="id" title="variable">narg</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#f:355"><span class="id" title="variable">f</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">closed</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tCoFix"><span class="id" title="constructor">tCoFix</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:352"><span class="id" title="variable">defs</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:353"><span class="id" title="variable">i</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tCoFix"><span class="id" title="constructor">tCoFix</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:352"><span class="id" title="variable">defs</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:353"><span class="id" title="variable">i</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#f:355"><span class="id" title="variable">f</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">cuf</span> <span class="id" title="var">clos_defs</span> <span class="id" title="var">valid_defs</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#cunfold_cofix"><span class="id" title="definition">cunfold_cofix</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×. <span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">nth</span>; [|<span class="id" title="tactic">congruence</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaCoq.Utils.All_Forall.html#nth_error_forallb"><span class="id" title="lemma">nth_error_forallb</span></a> <span class="id" title="var">nth</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">clos_defs</span> <span class="id" title="keyword">as</span> ?.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaCoq.Utils.All_Forall.html#nth_error_forallb"><span class="id" title="lemma">nth_error_forallb</span></a> <span class="id" title="var">nth</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">valid_defs</span> <span class="id" title="keyword">as</span> ?.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="var">noconf</span> <span class="id" title="var">cuf</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_substl"><span class="id" title="lemma">valid_cases_substl</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#Forall_closed_cofix_subst"><span class="id" title="lemma">Forall_closed_cofix_subst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_impl"><span class="id" title="lemma">forallb_impl</span></a>; [|<span class="id" title="tactic">exact</span> <span class="id" title="var">clos_defs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_0_r"><span class="id" title="lemma">Nat.add_0_r</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#Forall_valid_cases_cofix_subst"><span class="id" title="lemma">Forall_valid_cases_cofix_subst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="valid_cases_constant" class="idref" href="#valid_cases_constant"><span class="id" title="lemma">valid_cases_constant</span></a> <a id="4496fc8e601d7db2b49cf2817d159d3d" class="idref" href="#4496fc8e601d7db2b49cf2817d159d3d"><span class="id" title="binder">Σ</span></a> <a id="kn:357" class="idref" href="#kn:357"><span class="id" title="binder">kn</span></a> <a id="cst:358" class="idref" href="#cst:358"><span class="id" title="binder">cst</span></a> <a id="body:359" class="idref" href="#body:359"><span class="id" title="binder">body</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_masks_env"><span class="id" title="abbreviation">valid_masks_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#4496fc8e601d7db2b49cf2817d159d3d"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#declared_constant"><span class="id" title="definition">EGlobalEnv.declared_constant</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#4496fc8e601d7db2b49cf2817d159d3d"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#kn:357"><span class="id" title="variable">kn</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#cst:358"><span class="id" title="variable">cst</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EAst.html#cst_body"><span class="id" title="projection">EAst.cst_body</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#cst:358"><span class="id" title="variable">cst</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#body:359"><span class="id" title="variable">body</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#body:359"><span class="id" title="variable">body</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid_env</span> <span class="id" title="var">decl_const</span> <span class="id" title="var">body_eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#declared_constant_trans_env"><span class="id" title="lemma">declared_constant_trans_env</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">decl_const</span> <span class="id" title="keyword">as</span> [(? &amp; → &amp; <span class="id" title="var">look</span>)|(? &amp; → &amp; <span class="id" title="var">look</span>)].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_env</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_env_Forall"><span class="id" title="lemma">lookup_env_Forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_env</span> <span class="id" title="keyword">as</span> (? &amp; <span class="id" title="var">valid</span>); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">body_eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">valid</span>; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [|<span class="id" title="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">replace</span> <span class="id" title="var">body</span> <span class="id" title="keyword">with</span> <a class="idref" href="MetaCoq.Erasure.EAst.html#tBox"><span class="id" title="constructor">tBox</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="valid_dearg_mask_constant" class="idref" href="#valid_dearg_mask_constant"><span class="id" title="lemma">valid_dearg_mask_constant</span></a> <a id="44a723c791207cec8715d4fda9dd76ba" class="idref" href="#44a723c791207cec8715d4fda9dd76ba"><span class="id" title="binder">Σ</span></a> <a id="kn:361" class="idref" href="#kn:361"><span class="id" title="binder">kn</span></a> <a id="cst:362" class="idref" href="#cst:362"><span class="id" title="binder">cst</span></a> <a id="body:363" class="idref" href="#body:363"><span class="id" title="binder">body</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_masks_env"><span class="id" title="abbreviation">valid_masks_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#44a723c791207cec8715d4fda9dd76ba"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#declared_constant"><span class="id" title="definition">EGlobalEnv.declared_constant</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#44a723c791207cec8715d4fda9dd76ba"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#kn:361"><span class="id" title="variable">kn</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#cst:362"><span class="id" title="variable">cst</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EAst.html#cst_body"><span class="id" title="projection">EAst.cst_body</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#cst:362"><span class="id" title="variable">cst</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#body:363"><span class="id" title="variable">body</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_dearg_mask"><span class="id" title="definition">valid_dearg_mask</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#get_const_mask"><span class="id" title="abbreviation">get_const_mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#kn:361"><span class="id" title="variable">kn</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#body:363"><span class="id" title="variable">body</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid_env</span> <span class="id" title="var">decl_const</span> <span class="id" title="var">body_eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_env</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#declared_constant_trans_env"><span class="id" title="lemma">declared_constant_trans_env</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">decl_const</span> <span class="id" title="keyword">as</span> [(? &amp; → &amp; <span class="id" title="var">look</span>)|(? &amp; → &amp; <span class="id" title="var">look</span>)].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_env_Forall"><span class="id" title="lemma">lookup_env_Forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_env</span> <span class="id" title="keyword">as</span> (? &amp; <span class="id" title="var">valid</span>); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">body_eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">valid</span>; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_env_Forall"><span class="id" title="lemma">lookup_env_Forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_env</span> <span class="id" title="keyword">as</span> (? &amp; <span class="id" title="var">valid</span>); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [|<span class="id" title="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <span class="id" title="var">body</span> <span class="id" title="keyword">with</span> <a class="idref" href="MetaCoq.Erasure.EAst.html#tBox"><span class="id" title="constructor">tBox</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#get_const_mask"><span class="id" title="abbreviation">get_const_mask</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="valid_ind_mask_inductive" class="idref" href="#valid_ind_mask_inductive"><span class="id" title="lemma">valid_ind_mask_inductive</span></a> <a id="eb8a915fce147d88e533ebba557c06c4" class="idref" href="#eb8a915fce147d88e533ebba557c06c4"><span class="id" title="binder">Σ</span></a> <a id="ind:365" class="idref" href="#ind:365"><span class="id" title="binder">ind</span></a> <a id="mib:366" class="idref" href="#mib:366"><span class="id" title="binder">mib</span></a> <a id="oib:367" class="idref" href="#oib:367"><span class="id" title="binder">oib</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_masks_env"><span class="id" title="abbreviation">valid_masks_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#eb8a915fce147d88e533ebba557c06c4"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#declared_inductive"><span class="id" title="definition">EGlobalEnv.declared_inductive</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#eb8a915fce147d88e533ebba557c06c4"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:365"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mib:366"><span class="id" title="variable">mib</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#oib:367"><span class="id" title="variable">oib</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Utils.MCPrelude.html#cd4bc1b07c8b3bdc9f3bbc7941b56107"><span class="id" title="notation">∑</span></a> <a id="mask:368" class="idref" href="#mask:368"><span class="id" title="binder">mask</span></a><a class="idref" href="MetaCoq.Utils.MCPrelude.html#cd4bc1b07c8b3bdc9f3bbc7941b56107"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> (<a class="idref" href="MetaCoq.Common.Kernames.html#inductive_mind"><span class="id" title="projection">inductive_mind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:365"><span class="id" title="variable">ind</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:368"><span class="id" title="variable">mask</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:368"><span class="id" title="variable">mask</span></a>.(<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#param_mask"><span class="id" title="projection">param_mask</span></a>)<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#ad2ec4e405f68c46c0a176e3e94ae2e3"><span class="id" title="notation">=?</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mib:366"><span class="id" title="variable">mib</span></a>.(<a class="idref" href="MetaCoq.Erasure.EAst.html#ind_npars"><span class="id" title="projection">EAst.ind_npars</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid_env</span> <span class="id" title="var">decl_ind</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_env</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#declared_inductive"><span class="id" title="definition">declared_inductive</span></a>,<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#declared_minductive"><span class="id" title="definition">declared_minductive</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_env_trans_env"><span class="id" title="lemma">lookup_env_trans_env</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">decl_ind</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">decl_ind</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">decl_mind</span> <span class="id" title="var">nth</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> <span class="id" title="var">Σ</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">cst</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">Hm</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">decl_mind</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">H0</span>];<span class="id" title="tactic">subst</span>;<span class="id" title="tactic">clear</span> <span class="id" title="var">decl_mind</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_env_Forall"><span class="id" title="lemma">lookup_env_Forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_env</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">b</span> <span class="id" title="var">Hb</span>];<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">cst</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H0</span>;<span class="id" title="tactic">subst</span>;<span class="id" title="tactic">clear</span> <span class="id" title="var">H0</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>;<span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">invert_facts</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#is_true"><span class="id" title="definition">is_true</span></a> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">closed</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> |- <span class="id" title="var">_</span>] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.ClosedAux.html#closed_mkApps_inv"><span class="id" title="lemma">closed_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> (? &amp; ?)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> |- <span class="id" title="var">_</span>] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_mkApps_inv"><span class="id" title="lemma">valid_cases_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> (? &amp; ?)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> |- <span class="id" title="var">_</span>] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_mkApps_inv"><span class="id" title="lemma">is_expanded_aux_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> (? &amp; ?)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="eval_valid_cases" class="idref" href="#eval_valid_cases"><span class="id" title="lemma">eval_valid_cases</span></a> {<a id="wfl:369" class="idref" href="#wfl:369"><span class="id" title="binder">wfl</span></a> : <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">WcbvFlags</span></a>} <a id="b0c6942726dadbc891e624a18dd6d042" class="idref" href="#b0c6942726dadbc891e624a18dd6d042"><span class="id" title="binder">Σ</span></a> <a id="t:371" class="idref" href="#t:371"><span class="id" title="binder">t</span></a> <a id="v:372" class="idref" href="#v:372"><span class="id" title="binder">v</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#with_constructor_as_block"><span class="id" title="method">with_constructor_as_block</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#b0c6942726dadbc891e624a18dd6d042"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">e</span></a><a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⊢</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:371"><span class="id" title="variable">t</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⇓</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#v:372"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.ClosedAux.html#env_closed"><span class="id" title="definition">env_closed</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#b0c6942726dadbc891e624a18dd6d042"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">closed</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:371"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_masks_env"><span class="id" title="abbreviation">valid_masks_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#b0c6942726dadbc891e624a18dd6d042"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:371"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#v:372"><span class="id" title="variable">v</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">with</span> <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">dearg</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? <span class="id" title="var">ev</span> <span class="id" title="var">clos_env</span> <span class="id" title="var">clos_t</span> <span class="id" title="var">valid_env</span> <span class="id" title="var">valid_t</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">ev</span> <span class="id" title="tactic">in</span> <span class="id" title="var">t</span>, <span class="id" title="var">v</span>, <span class="id" title="var">ev</span>, <span class="id" title="var">clos_t</span>, <span class="id" title="var">valid_t</span> |- *; <span class="id" title="tactic">auto</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_closed"><span class="id" title="lemma">eval_closed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev1</span> <span class="id" title="keyword">as</span> ?...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_closed"><span class="id" title="lemma">eval_closed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev2</span> <span class="id" title="keyword">as</span> ?...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.ECSubst.html#closed_subst"><span class="id" title="lemma">closed_subst</span></a> <span class="id" title="tactic">in</span> × <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHev3</span>; [<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.ClosedAux.html#closedn_subst0"><span class="id" title="lemma">closedn_subst0</span></a>|<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_subst"><span class="id" title="lemma">valid_cases_subst</span></a>]...<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_closed"><span class="id" title="lemma">eval_closed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev1</span> <span class="id" title="keyword">as</span> ?...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.ECSubst.html#closed_subst"><span class="id" title="lemma">closed_subst</span></a> <span class="id" title="tactic">in</span> × <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHev2</span>; [<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.ClosedAux.html#closedn_subst0"><span class="id" title="lemma">closedn_subst0</span></a>|<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_subst"><span class="id" title="lemma">valid_cases_subst</span></a>]...<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">clos_t</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">clos_discr</span> <span class="id" title="var">clos_brs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">valid_t</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">val_discr</span> <span class="id" title="var">val_brs</span>] <span class="id" title="var">val_masks</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHev1</span> <span class="id" title="var">clos_discr</span> <span class="id" title="var">val_discr</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">val_cases</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_closed"><span class="id" title="lemma">eval_closed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev1</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Happs</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.ClosedAux.html#closed_mkApps_inv"><span class="id" title="lemma">closed_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Happs</span> <span class="id" title="keyword">as</span> (? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">closed</span></a> (<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#iota_red"><span class="id" title="definition">iota_red</span></a> <span class="id" title="var">pars</span> <span class="id" title="var">args</span> <span class="id" title="var">br</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#closed_iota_red"><span class="id" title="lemma">closed_iota_red</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaCoq.Utils.All_Forall.html#nth_error_forallb"><span class="id" title="lemma">nth_error_forallb</span></a> <span class="id" title="var">e2</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">clos_brs</span> <span class="id" title="keyword">as</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">br</span><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> 0) <span class="id" title="keyword">with</span> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">br</span><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <span class="id" title="tactic">in</span> × <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e4</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_closed"><span class="id" title="lemma">eval_closed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev2</span> <span class="id" title="keyword">as</span> ?...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_mkApps_inv"><span class="id" title="lemma">valid_cases_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">val_cases</span> <span class="id" title="keyword">as</span> (? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHev2</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_iota_red"><span class="id" title="lemma">valid_cases_iota_red</span></a>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaCoq.Utils.All_Forall.html#nth_error_forallb"><span class="id" title="lemma">nth_error_forallb</span></a> <span class="id" title="var">e2</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">val_brs</span> <span class="id" title="keyword">as</span> ?...<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">subst</span> <span class="id" title="var">brs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHev2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.ECSubst.html#closed_substl"><span class="id" title="lemma">closed_substl</span></a>. <span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="tactic">in</span> <span class="id" title="var">n</span> |- × ; <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#repeat_length"><span class="id" title="lemma">repeat_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_substl"><span class="id" title="lemma">valid_cases_substl</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Utils.html#Forall_repeat"><span class="id" title="lemma">Forall_repeat</span></a>;<span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_closed"><span class="id" title="lemma">eval_closed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev1</span> <span class="id" title="keyword">as</span> ?...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_closed"><span class="id" title="lemma">eval_closed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev2</span> <span class="id" title="keyword">as</span> ?...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.ClosedAux.html#closed_mkApps_inv"><span class="id" title="lemma">closed_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H7</span> <span class="id" title="keyword">as</span> (? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_mkApps_inv"><span class="id" title="lemma">valid_cases_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H6</span> <span class="id" title="keyword">as</span> (? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H5</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.ClosedAux.html#closed_mkApps"><span class="id" title="lemma">closed_mkApps</span></a>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#closed_cunfold_fix"><span class="id" title="lemma">closed_cunfold_fix</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">split</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_mkApps"><span class="id" title="lemma">valid_cases_mkApps</span></a>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_cunfold_fix"><span class="id" title="lemma">valid_cases_cunfold_fix</span></a>; [<span class="id" title="var">eassumption</span>| |]...<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_closed"><span class="id" title="lemma">eval_closed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev1</span> <span class="id" title="keyword">as</span> ?...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_closed"><span class="id" title="lemma">eval_closed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev2</span> <span class="id" title="keyword">as</span> ?...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H5</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#closed_cunfold_fix"><span class="id" title="lemma">closed_cunfold_fix</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">split</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_cunfold_fix"><span class="id" title="lemma">valid_cases_cunfold_fix</span></a>;<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">ip</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hcofix</span> : <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">closed</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tCoFix"><span class="id" title="constructor">tCoFix</span></a> <span class="id" title="var">mfix</span> <span class="id" title="var">idx</span>) <span class="id" title="var">args</span>)) <span class="id" title="tactic">by</span> <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_closed"><span class="id" title="lemma">eval_closed</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.ClosedAux.html#closed_mkApps_inv"><span class="id" title="lemma">closed_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcofix</span> <span class="id" title="keyword">as</span> (? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">closed</span></a> <span class="id" title="var">fn</span>) <span class="id" title="tactic">by</span> (<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#closed_cunfold_cofix"><span class="id" title="lemma">closed_cunfold_cofix</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">closed</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <span class="id" title="var">fn</span> <span class="id" title="var">args</span>)) <span class="id" title="tactic">by</span> (<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.ClosedAux.html#closed_mkApps"><span class="id" title="lemma">closed_mkApps</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">invert_facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <span class="id" title="var">fn</span> <span class="id" title="var">args</span>)) <span class="id" title="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_mkApps"><span class="id" title="lemma">valid_cases_mkApps</span></a>;<span class="id" title="tactic">auto</span>; <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_cunfold_cofix"><span class="id" title="lemma">valid_cases_cunfold_cofix</span></a>;<span class="id" title="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hcofix</span> : <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">closed</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tCoFix"><span class="id" title="constructor">tCoFix</span></a> <span class="id" title="var">mfix</span> <span class="id" title="var">idx</span>) <span class="id" title="var">args</span>)) <span class="id" title="tactic">by</span> <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_closed"><span class="id" title="lemma">eval_closed</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.ClosedAux.html#closed_mkApps_inv"><span class="id" title="lemma">closed_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcofix</span> <span class="id" title="keyword">as</span> (? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">closed</span></a> <span class="id" title="var">fn</span>) <span class="id" title="tactic">by</span> (<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#closed_cunfold_cofix"><span class="id" title="lemma">closed_cunfold_cofix</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">closed</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <span class="id" title="var">fn</span> <span class="id" title="var">args</span>)) <span class="id" title="tactic">by</span> (<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.ClosedAux.html#closed_mkApps"><span class="id" title="lemma">closed_mkApps</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">invert_facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <span class="id" title="var">fn</span> <span class="id" title="var">args</span>)) <span class="id" title="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_mkApps"><span class="id" title="lemma">valid_cases_mkApps</span></a>;<span class="id" title="tactic">auto</span>; <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_cunfold_cofix"><span class="id" title="lemma">valid_cases_cunfold_cofix</span></a>;<span class="id" title="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">IHev</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#closed_constant"><span class="id" title="lemma">closed_constant</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_constant"><span class="id" title="lemma">valid_cases_constant</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_closed"><span class="id" title="lemma">eval_closed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev1</span> <span class="id" title="keyword">as</span> ?...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">invert_facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">closed</span></a> <span class="id" title="var">a</span>) <span class="id" title="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">eapply</span> @<a class="idref" href="MetaCoq.Utils.All_Forall.html#nth_error_forall"><span class="id" title="lemma">nth_error_forall</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">x</span> := <span class="id" title="var">a</span>);<span class="id" title="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <span class="id" title="var">a</span>) <span class="id" title="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">eapply</span> @<a class="idref" href="MetaCoq.Utils.All_Forall.html#nth_error_forall"><span class="id" title="lemma">nth_error_forall</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">x</span> := <span class="id" title="var">a</span>);<span class="id" title="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="lookup_env_dearg_env" class="idref" href="#lookup_env_dearg_env"><span class="id" title="lemma">lookup_env_dearg_env</span></a> <a id="8ee2840a2eecf3b3bbbc3b69fb771fd5" class="idref" href="#8ee2840a2eecf3b3bbbc3b69fb771fd5"><span class="id" title="binder">Σ</span></a> <a id="kn:374" class="idref" href="#kn:374"><span class="id" title="binder">kn</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_env"><span class="id" title="abbreviation">dearg_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#8ee2840a2eecf3b3bbbc3b69fb771fd5"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#kn:374"><span class="id" title="variable">kn</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#option_map"><span class="id" title="definition">option_map</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_decl"><span class="id" title="abbreviation">dearg_decl</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#kn:374"><span class="id" title="variable">kn</span></a>) (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#8ee2840a2eecf3b3bbbc3b69fb771fd5"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#kn:374"><span class="id" title="variable">kn</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Σ</span> <span class="id" title="keyword">as</span> [|((<span class="id" title="var">kn'</span>, <span class="id" title="var">has_deps</span>), <span class="id" title="var">decl</span>) <span class="id" title="var">Σ</span> <span class="id" title="var">IH</span>]; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">eq_kername</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaCoq.Common.Kernames.html#Kername.reflect_kername"><span class="id" title="instance">Kername.reflect_kername</span></a> <span class="id" title="keyword">as</span> [<span class="id" title="var">eq</span> <span class="id" title="var">Heq</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">Heq</span> <span class="id" title="var">kn</span> <span class="id" title="var">kn'</span>);<span class="id" title="tactic">subst</span>;[<span class="id" title="var">easy</span>| <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>].<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="declared_constant_dearg" class="idref" href="#declared_constant_dearg"><span class="id" title="lemma">declared_constant_dearg</span></a> <a id="0eef96af381f17f7f134619cb322a94f" class="idref" href="#0eef96af381f17f7f134619cb322a94f"><span class="id" title="binder">Σ</span></a> <a id="k:376" class="idref" href="#k:376"><span class="id" title="binder">k</span></a> <a id="cst:377" class="idref" href="#cst:377"><span class="id" title="binder">cst</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#declared_constant"><span class="id" title="definition">declared_constant</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#0eef96af381f17f7f134619cb322a94f"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:376"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#cst:377"><span class="id" title="variable">cst</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Utils.MCPrelude.html#cd4bc1b07c8b3bdc9f3bbc7941b56107"><span class="id" title="notation">∑</span></a> <a id="cst':378" class="idref" href="#cst':378"><span class="id" title="binder">cst'</span></a><a class="idref" href="MetaCoq.Utils.MCPrelude.html#cd4bc1b07c8b3bdc9f3bbc7941b56107"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#declared_constant"><span class="id" title="definition">declared_constant</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_env"><span class="id" title="abbreviation">dearg_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#0eef96af381f17f7f134619cb322a94f"><span class="id" title="variable">Σ</span></a>)) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:376"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#cst':378"><span class="id" title="variable">cst'</span></a> <a class="idref" href="MetaCoq.Utils.MCProd.html#52eddd74560fa276f934634af83eeaf4"><span class="id" title="notation">×</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EAst.html#cst_body"><span class="id" title="projection">EAst.cst_body</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#cst':378"><span class="id" title="variable">cst'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#option_map"><span class="id" title="definition">option_map</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Utils.MCPrelude.html#c90061783c20674b3a3a6b46d343da03"><span class="id" title="notation">∘</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_lambdas"><span class="id" title="definition">dearg_lambdas</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#get_const_mask"><span class="id" title="abbreviation">get_const_mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:376"><span class="id" title="variable">k</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaCoq.Erasure.EAst.html#cst_body"><span class="id" title="projection">EAst.cst_body</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#cst:377"><span class="id" title="variable">cst</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#declared_constant"><span class="id" title="definition">declared_constant</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_env_trans_env"><span class="id" title="lemma">lookup_env_trans_env</span></a>, <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_env_dearg_env"><span class="id" title="lemma">lookup_env_dearg_env</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">typ</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> <span class="id" title="keyword">as</span> [<span class="id" title="var">decl</span>|]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [|<span class="id" title="tactic">congruence</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">decl</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [|<span class="id" title="tactic">congruence</span>|]; <span class="id" title="var">noconf</span> <span class="id" title="var">typ</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="tactic">reflexivity</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">o</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a id="dearg_spec" class="idref" href="#dearg_spec"><span class="id" title="inductive">dearg_spec</span></a> : <a class="idref" href="MetaCoq.Erasure.EAst.html#term"><span class="id" title="inductive">term</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#term"><span class="id" title="inductive">term</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Type</span> :=<br/>
| <a id="dearg_spec_const" class="idref" href="#dearg_spec_const"><span class="id" title="constructor">dearg_spec_const</span></a> <a id="kn:381" class="idref" href="#kn:381"><span class="id" title="binder">kn</span></a> <a id="args:382" class="idref" href="#args:382"><span class="id" title="binder">args</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_spec:379"><span class="id" title="inductive">dearg_spec</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tConst"><span class="id" title="constructor">tConst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#kn:381"><span class="id" title="variable">kn</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:382"><span class="id" title="variable">args</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_single"><span class="id" title="definition">dearg_single</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#get_const_mask"><span class="id" title="abbreviation">get_const_mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#kn:381"><span class="id" title="variable">kn</span></a>) (<a class="idref" href="MetaCoq.Erasure.EAst.html#tConst"><span class="id" title="constructor">tConst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#kn:381"><span class="id" title="variable">kn</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:382"><span class="id" title="variable">args</span></a>))<br/>
| <a id="dearg_spec_ctor" class="idref" href="#dearg_spec_ctor"><span class="id" title="constructor">dearg_spec_ctor</span></a> <a id="ind:383" class="idref" href="#ind:383"><span class="id" title="binder">ind</span></a> <a id="c:384" class="idref" href="#c:384"><span class="id" title="binder">c</span></a> <a id="args0:385" class="idref" href="#args0:385"><span class="id" title="binder">args0</span></a> <a id="args:386" class="idref" href="#args:386"><span class="id" title="binder">args</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;NOTE:&nbsp;args0&nbsp;is&nbsp;not&nbsp;dearged,&nbsp;because&nbsp;we&nbsp;ignore&nbsp;constructors&nbsp;as&nbsp;blocks&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_spec:379"><span class="id" title="inductive">dearg_spec</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tConstruct"><span class="id" title="constructor">tConstruct</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:383"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c:384"><span class="id" title="variable">c</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args0:385"><span class="id" title="variable">args0</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:386"><span class="id" title="variable">args</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_single"><span class="id" title="definition">dearg_single</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#get_ctor_mask"><span class="id" title="abbreviation">get_ctor_mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:383"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c:384"><span class="id" title="variable">c</span></a>) (<a class="idref" href="MetaCoq.Erasure.EAst.html#tConstruct"><span class="id" title="constructor">tConstruct</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:383"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c:384"><span class="id" title="variable">c</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args0:385"><span class="id" title="variable">args0</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:386"><span class="id" title="variable">args</span></a>))<br/>
| <a id="dearg_spec_case" class="idref" href="#dearg_spec_case"><span class="id" title="constructor">dearg_spec_case</span></a> <a id="ind:387" class="idref" href="#ind:387"><span class="id" title="binder">ind</span></a> <a id="npars:388" class="idref" href="#npars:388"><span class="id" title="binder">npars</span></a> <a id="discr:389" class="idref" href="#discr:389"><span class="id" title="binder">discr</span></a> <a id="brs:390" class="idref" href="#brs:390"><span class="id" title="binder">brs</span></a> <a id="args:391" class="idref" href="#args:391"><span class="id" title="binder">args</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_spec:379"><span class="id" title="inductive">dearg_spec</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tCase"><span class="id" title="constructor">tCase</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:387"><span class="id" title="variable">ind</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#npars:388"><span class="id" title="variable">npars</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#discr:389"><span class="id" title="variable">discr</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#brs:390"><span class="id" title="variable">brs</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:391"><span class="id" title="variable">args</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tCase"><span class="id" title="constructor">tCase</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:387"><span class="id" title="variable">ind</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#npars:388"><span class="id" title="variable">npars</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#discr:389"><span class="id" title="variable">discr</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#brs:390"><span class="id" title="variable">brs</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:391"><span class="id" title="variable">args</span></a>))<br/>
| <a id="dearg_spec_proj" class="idref" href="#dearg_spec_proj"><span class="id" title="constructor">dearg_spec_proj</span></a> <a id="ind:392" class="idref" href="#ind:392"><span class="id" title="binder">ind</span></a> <a id="c:393" class="idref" href="#c:393"><span class="id" title="binder">c</span></a> <a id="npars:394" class="idref" href="#npars:394"><span class="id" title="binder">npars</span></a> <a id="t:395" class="idref" href="#t:395"><span class="id" title="binder">t</span></a> <a id="args:396" class="idref" href="#args:396"><span class="id" title="binder">args</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_spec:379"><span class="id" title="inductive">dearg_spec</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tProj"><span class="id" title="constructor">tProj</span></a> (<a class="idref" href="MetaCoq.Common.Kernames.html#mkProjection"><span class="id" title="constructor">mkProjection</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:392"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c:393"><span class="id" title="variable">c</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#npars:394"><span class="id" title="variable">npars</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:395"><span class="id" title="variable">t</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:396"><span class="id" title="variable">args</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tProj"><span class="id" title="constructor">tProj</span></a> (<a class="idref" href="MetaCoq.Common.Kernames.html#mkProjection"><span class="id" title="constructor">mkProjection</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:392"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c:393"><span class="id" title="variable">c</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#npars:394"><span class="id" title="variable">npars</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:395"><span class="id" title="variable">t</span></a>)) (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:396"><span class="id" title="variable">args</span></a>))<br/>
| <a id="dearg_spec_other" class="idref" href="#dearg_spec_other"><span class="id" title="constructor">dearg_spec_other</span></a> <a id="hd:397" class="idref" href="#hd:397"><span class="id" title="binder">hd</span></a> <a id="args:398" class="idref" href="#args:398"><span class="id" title="binder">args</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:397"><span class="id" title="variable">hd</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="MetaCoq.Erasure.EAst.html#tConst"><span class="id" title="constructor">tConst</span></a> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="MetaCoq.Erasure.EAst.html#tConstruct"><span class="id" title="constructor">tConstruct</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="MetaCoq.Erasure.EAst.html#tCase"><span class="id" title="constructor">tCase</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="MetaCoq.Erasure.EAst.html#tProj"><span class="id" title="constructor">tProj</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="MetaCoq.Erasure.EAst.html#tApp"><span class="id" title="constructor">tApp</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#False"><span class="id" title="inductive">False</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_spec:379"><span class="id" title="inductive">dearg_spec</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:397"><span class="id" title="variable">hd</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:398"><span class="id" title="variable">args</span></a>) (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:397"><span class="id" title="variable">hd</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:398"><span class="id" title="variable">args</span></a>)).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="dearg_elim" class="idref" href="#dearg_elim"><span class="id" title="lemma">dearg_elim</span></a> <a id="t:400" class="idref" href="#t:400"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_spec"><span class="id" title="inductive">dearg_spec</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:400"><span class="id" title="variable">t</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:400"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.EAstUtils.html#mkApps_elim"><span class="id" title="lemma">mkApps_elim</span></a> <span class="id" title="var">t</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#firstn"><span class="id" title="definition">firstn</span></a> <span class="id" title="var">n</span> <span class="id" title="var">l</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">args</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">args</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_mkApps"><span class="id" title="lemma">dearg_mkApps</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">f</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [<span class="id" title="var">now</span> <span class="id" title="tactic">econstructor</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_spec_case"><span class="id" title="constructor">dearg_spec_case</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_spec_proj"><span class="id" title="constructor">dearg_spec_proj</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="valid_cases_dearg_lambdas" class="idref" href="#valid_cases_dearg_lambdas"><span class="id" title="lemma">valid_cases_dearg_lambdas</span></a> <a id="mask:401" class="idref" href="#mask:401"><span class="id" title="binder">mask</span></a> <a id="t:402" class="idref" href="#t:402"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:402"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_lambdas"><span class="id" title="definition">dearg_lambdas</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:401"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:402"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">mask</span>, <span class="id" title="var">valid</span> |- × <span class="id" title="keyword">using</span> <a class="idref" href="MetaCoq.Erasure.EInduction.html#term_forall_list_ind"><span class="id" title="lemma">term_forall_list_ind</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span> <span class="id" title="keyword">as</span> [|[] <span class="id" title="var">mask</span>]; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_subst"><span class="id" title="lemma">valid_cases_subst</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="dearg_dearg_lambdas" class="idref" href="#dearg_dearg_lambdas"><span class="id" title="lemma">dearg_dearg_lambdas</span></a> <a id="mask:403" class="idref" href="#mask:403"><span class="id" title="binder">mask</span></a> <a id="t:404" class="idref" href="#t:404"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_dearg_mask"><span class="id" title="definition">valid_dearg_mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:403"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:404"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:404"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_lambdas"><span class="id" title="definition">dearg_lambdas</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:403"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:404"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_lambdas"><span class="id" title="definition">dearg_lambdas</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:403"><span class="id" title="variable">mask</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:404"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">vm</span> <span class="id" title="var">vc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">mask</span>, <span class="id" title="var">vm</span>, <span class="id" title="var">vc</span> |- × <span class="id" title="keyword">using</span> <a class="idref" href="MetaCoq.Erasure.EInduction.html#term_forall_list_ind"><span class="id" title="lemma">term_forall_list_ind</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [<span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span>; [|<span class="id" title="var">easy</span>]; <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_lambdas_nil"><span class="id" title="lemma">dearg_lambdas_nil</span></a>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span> <span class="id" title="keyword">as</span> [|[] <span class="id" title="var">mask</span>]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">refold'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst1"><span class="id" title="definition">subst1</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_subst"><span class="id" title="lemma">dearg_subst</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_dearg_lambdas"><span class="id" title="lemma">valid_cases_dearg_lambdas</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">refold'</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">refold'</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt2</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="dearg_substl" class="idref" href="#dearg_substl"><span class="id" title="lemma">dearg_substl</span></a> <a id="s:405" class="idref" href="#s:405"><span class="id" title="binder">s</span></a> <a id="t:406" class="idref" href="#t:406"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">closedn</span></a> 0) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:405"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:405"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:405"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:406"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> (<a class="idref" href="MetaCoq.Erasure.ECSubst.html#substl"><span class="id" title="definition">substl</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:405"><span class="id" title="variable">s</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:406"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.ECSubst.html#substl"><span class="id" title="definition">substl</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#s:405"><span class="id" title="variable">s</span></a>) (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:406"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">clos</span> <span class="id" title="var">valid</span> <span class="id" title="var">exp</span> <span class="id" title="var">valid_t</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">s</span> <span class="id" title="keyword">using</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#rev_ind"><span class="id" title="lemma">List.rev_ind</span></a>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.ECSubst.html#substl"><span class="id" title="definition">substl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_app"><span class="id" title="lemma">map_app</span></a>, !<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#fold_left_app"><span class="id" title="lemma">fold_left_app</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">exp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.ECSubst.html#closed_subst"><span class="id" title="lemma">closed_subst</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">refold'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_subst"><span class="id" title="lemma">dearg_subst</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.ECSubst.html#closed_subst"><span class="id" title="lemma">closed_subst</span></a> <span class="id" title="tactic">by</span> (<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#closedn_dearg_aux"><span class="id" title="lemma">closedn_dearg_aux</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHs</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_substl"><span class="id" title="lemma">valid_cases_substl</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="fix_subst_dearg" class="idref" href="#fix_subst_dearg"><span class="id" title="lemma">fix_subst_dearg</span></a> <a id="defs:407" class="idref" href="#defs:407"><span class="id" title="binder">defs</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#fix_subst"><span class="id" title="definition">fix_subst</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#map_def"><span class="id" title="definition">map_def</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:407"><span class="id" title="variable">defs</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> (<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#fix_subst"><span class="id" title="definition">fix_subst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:407"><span class="id" title="variable">defs</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#fix_subst"><span class="id" title="definition">fix_subst</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">defs</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHn</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="cofix_subst_dearg" class="idref" href="#cofix_subst_dearg"><span class="id" title="lemma">cofix_subst_dearg</span></a> <a id="defs:408" class="idref" href="#defs:408"><span class="id" title="binder">defs</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#cofix_subst"><span class="id" title="definition">cofix_subst</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#map_def"><span class="id" title="definition">map_def</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:408"><span class="id" title="variable">defs</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> (<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#cofix_subst"><span class="id" title="definition">cofix_subst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:408"><span class="id" title="variable">defs</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#cofix_subst"><span class="id" title="definition">cofix_subst</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">defs</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHn</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="dearg_cunfold_fix" class="idref" href="#dearg_cunfold_fix"><span class="id" title="lemma">dearg_cunfold_fix</span></a> <a id="defs:409" class="idref" href="#defs:409"><span class="id" title="binder">defs</span></a> <a id="i:410" class="idref" href="#i:410"><span class="id" title="binder">i</span></a> <a id="narg:411" class="idref" href="#narg:411"><span class="id" title="binder">narg</span></a> <a id="fn:412" class="idref" href="#fn:412"><span class="id" title="binder">fn</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#cunfold_fix"><span class="id" title="definition">cunfold_fix</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:409"><span class="id" title="variable">defs</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:410"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#narg:411"><span class="id" title="variable">narg</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#fn:412"><span class="id" title="variable">fn</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">closed</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tFix"><span class="id" title="constructor">tFix</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:409"><span class="id" title="variable">defs</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:410"><span class="id" title="variable">i</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tFix"><span class="id" title="constructor">tFix</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:409"><span class="id" title="variable">defs</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:410"><span class="id" title="variable">i</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tFix"><span class="id" title="constructor">tFix</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:409"><span class="id" title="variable">defs</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:410"><span class="id" title="variable">i</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#cunfold_fix"><span class="id" title="definition">cunfold_fix</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#map_def"><span class="id" title="definition">map_def</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:409"><span class="id" title="variable">defs</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:410"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#narg:411"><span class="id" title="variable">narg</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#fn:412"><span class="id" title="variable">fn</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">cuf</span> <span class="id" title="var">clos_fix</span> <span class="id" title="var">valid_fix</span> <span class="id" title="var">exp_fix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#cunfold_fix"><span class="id" title="definition">cunfold_fix</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#nth_error_map"><span class="id" title="lemma">nth_error_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">nth</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="var">noconf</span> <span class="id" title="var">cuf</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_substl"><span class="id" title="lemma">dearg_substl</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">f_equal</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#fix_subst_dearg"><span class="id" title="lemma">fix_subst_dearg</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#Forall_closed_fix_subst"><span class="id" title="lemma">Forall_closed_fix_subst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">setoid_rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_0_r"><span class="id" title="lemma">Nat.add_0_r</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_fix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#Forall_valid_cases_fix_subst"><span class="id" title="lemma">Forall_valid_cases_fix_subst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#Forall_is_expanded_fix_subst"><span class="id" title="lemma">Forall_is_expanded_fix_subst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#nth_error_forallb"><span class="id" title="lemma">nth_error_forallb</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_fix</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="dearg_cunfold_cofix" class="idref" href="#dearg_cunfold_cofix"><span class="id" title="lemma">dearg_cunfold_cofix</span></a> <a id="defs:413" class="idref" href="#defs:413"><span class="id" title="binder">defs</span></a> <a id="i:414" class="idref" href="#i:414"><span class="id" title="binder">i</span></a> <a id="narg:415" class="idref" href="#narg:415"><span class="id" title="binder">narg</span></a> <a id="fn:416" class="idref" href="#fn:416"><span class="id" title="binder">fn</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#cunfold_cofix"><span class="id" title="definition">cunfold_cofix</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:413"><span class="id" title="variable">defs</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:414"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#narg:415"><span class="id" title="variable">narg</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#fn:416"><span class="id" title="variable">fn</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">closed</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tCoFix"><span class="id" title="constructor">tCoFix</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:413"><span class="id" title="variable">defs</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:414"><span class="id" title="variable">i</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tCoFix"><span class="id" title="constructor">tCoFix</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:413"><span class="id" title="variable">defs</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:414"><span class="id" title="variable">i</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tCoFix"><span class="id" title="constructor">tCoFix</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:413"><span class="id" title="variable">defs</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:414"><span class="id" title="variable">i</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#cunfold_cofix"><span class="id" title="definition">cunfold_cofix</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#map_def"><span class="id" title="definition">map_def</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#defs:413"><span class="id" title="variable">defs</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:414"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#narg:415"><span class="id" title="variable">narg</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#fn:416"><span class="id" title="variable">fn</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">cuf</span> <span class="id" title="var">clos_fix</span> <span class="id" title="var">valid_fix</span> <span class="id" title="var">exp_fix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#cunfold_cofix"><span class="id" title="definition">cunfold_cofix</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#nth_error_map"><span class="id" title="lemma">nth_error_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">nth</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="var">noconf</span> <span class="id" title="var">cuf</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_substl"><span class="id" title="lemma">dearg_substl</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">f_equal</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#cofix_subst_dearg"><span class="id" title="lemma">cofix_subst_dearg</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#Forall_closed_cofix_subst"><span class="id" title="lemma">Forall_closed_cofix_subst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">setoid_rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_0_r"><span class="id" title="lemma">Nat.add_0_r</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_fix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#Forall_valid_cases_cofix_subst"><span class="id" title="lemma">Forall_valid_cases_cofix_subst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#Forall_is_expanded_cofix_subst"><span class="id" title="lemma">Forall_is_expanded_cofix_subst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#nth_error_forallb"><span class="id" title="lemma">nth_error_forallb</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_fix</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="isBox_mkApps" class="idref" href="#isBox_mkApps"><span class="id" title="lemma">isBox_mkApps</span></a> <a id="hd:417" class="idref" href="#hd:417"><span class="id" title="binder">hd</span></a> <a id="args:418" class="idref" href="#args:418"><span class="id" title="binder">args</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EAstUtils.html#isBox"><span class="id" title="definition">isBox</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:417"><span class="id" title="variable">hd</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:418"><span class="id" title="variable">args</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.EAstUtils.html#isBox"><span class="id" title="definition">isBox</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:417"><span class="id" title="variable">hd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:418"><span class="id" title="variable">args</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#ad2ec4e405f68c46c0a176e3e94ae2e3"><span class="id" title="notation">=?</span></a> 0<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">args</span> <span class="id" title="keyword">using</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#rev_ind"><span class="id" title="lemma">List.rev_ind</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Bool.Bool.html#andb_true_r"><span class="id" title="lemma">Bool.andb_true_r</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.EAstUtils.html#mkApps_app"><span class="id" title="lemma">mkApps_app</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_comm"><span class="id" title="lemma">Nat.add_comm</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Bool.Bool.html#andb_false_r"><span class="id" title="lemma">Bool.andb_false_r</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="isLambda_mkApps" class="idref" href="#isLambda_mkApps"><span class="id" title="lemma">isLambda_mkApps</span></a> <a id="hd:419" class="idref" href="#hd:419"><span class="id" title="binder">hd</span></a> <a id="args:420" class="idref" href="#args:420"><span class="id" title="binder">args</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EAst.html#isLambda"><span class="id" title="definition">isLambda</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:419"><span class="id" title="variable">hd</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:420"><span class="id" title="variable">args</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#isLambda"><span class="id" title="definition">isLambda</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:419"><span class="id" title="variable">hd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:420"><span class="id" title="variable">args</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#ad2ec4e405f68c46c0a176e3e94ae2e3"><span class="id" title="notation">=?</span></a> 0<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">args</span> <span class="id" title="keyword">using</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#rev_ind"><span class="id" title="lemma">List.rev_ind</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Bool.Bool.html#andb_true_r"><span class="id" title="lemma">Bool.andb_true_r</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.EAstUtils.html#mkApps_app"><span class="id" title="lemma">mkApps_app</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">right</span>; <span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="eval_mkApps_tConstruct" class="idref" href="#eval_mkApps_tConstruct"><span class="id" title="lemma">eval_mkApps_tConstruct</span></a> {<a id="wfl:421" class="idref" href="#wfl:421"><span class="id" title="binder">wfl</span></a> : <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">WcbvFlags</span></a>} <a id="74ab8167a0d7abc6ee9cb27c77b5befd" class="idref" href="#74ab8167a0d7abc6ee9cb27c77b5befd"><span class="id" title="binder">Σ</span></a> <a id="ind:423" class="idref" href="#ind:423"><span class="id" title="binder">ind</span></a> <a id="c:424" class="idref" href="#c:424"><span class="id" title="binder">c</span></a> <a id="args:425" class="idref" href="#args:425"><span class="id" title="binder">args</span></a> <a id="argsv:426" class="idref" href="#argsv:426"><span class="id" title="binder">argsv</span></a> <a id="mdecl:427" class="idref" href="#mdecl:427"><span class="id" title="binder">mdecl</span></a> <a id="idecl:428" class="idref" href="#idecl:428"><span class="id" title="binder">idecl</span></a> <a id="cdecl:429" class="idref" href="#cdecl:429"><span class="id" title="binder">cdecl</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="a:430" class="idref" href="#a:430"><span class="id" title="binder">a</span></a> : <a class="idref" href="MetaCoq.Utils.All_Forall.html#All2"><span class="id" title="inductive">All2</span></a> (<a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval"><span class="id" title="inductive">eval</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#74ab8167a0d7abc6ee9cb27c77b5befd"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:425"><span class="id" title="variable">args</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#argsv:426"><span class="id" title="variable">argsv</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#with_constructor_as_block"><span class="id" title="method">with_constructor_as_block</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#lookup_constructor"><span class="id" title="definition">EGlobalEnv.lookup_constructor</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#74ab8167a0d7abc6ee9cb27c77b5befd"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:423"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c:424"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mdecl:427"><span class="id" title="variable">mdecl</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#idecl:428"><span class="id" title="variable">idecl</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#cdecl:429"><span class="id" title="variable">cdecl</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#argsv:426"><span class="id" title="variable">argsv</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#cstr_arity"><span class="id" title="definition">cstr_arity</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mdecl:427"><span class="id" title="variable">mdecl</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#cdecl:429"><span class="id" title="variable">cdecl</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#74ab8167a0d7abc6ee9cb27c77b5befd"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">e</span></a><a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⊢</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tConstruct"><span class="id" title="constructor">tConstruct</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:423"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c:424"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:425"><span class="id" title="variable">args</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⇓</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tConstruct"><span class="id" title="constructor">tConstruct</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:423"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c:424"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#argsv:426"><span class="id" title="variable">argsv</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">argsv</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">args</span> <span class="id" title="keyword">using</span> <a class="idref" href="MetaCoq.Utils.MCList.html#rev_ind"><span class="id" title="lemma">MCList.rev_ind</span></a>; <span class="id" title="tactic">intros</span> <span class="id" title="var">argsv</span> <span class="id" title="var">all</span> <span class="id" title="var">block</span> <span class="id" title="var">ctor_look</span> <span class="id" title="var">argsv_lt</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">depelim</span> <span class="id" title="var">all</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#lookup_constructor"><span class="id" title="definition">EGlobalEnv.lookup_constructor</span></a> <span class="id" title="tactic">in</span> *;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#lookup_env"><span class="id" title="definition">EGlobalEnv.lookup_env</span></a> <span class="id" title="keyword">as</span> [<span class="id" title="var">g</span>|];<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">g</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">block</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">destruct</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a>;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">argsv</span> <span class="id" title="keyword">as</span> [|? ? <span class="id" title="var">_</span>] <span class="id" title="keyword">using</span> <a class="idref" href="MetaCoq.Utils.MCList.html#rev_ind"><span class="id" title="lemma">MCList.rev_ind</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#All2_length"><span class="id" title="lemma">All2_length</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">all</span> <span class="id" title="keyword">as</span> <span class="id" title="var">len</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">len</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">lia</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#All2_eval_snoc_elim"><span class="id" title="lemma">All2_eval_snoc_elim</span></a> <span class="id" title="var">all</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="MetaCoq.Erasure.EAstUtils.html#mkApps_app"><span class="id" title="lemma">mkApps_app</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">argsv_lt</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">argsv_lt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_construct"><span class="id" title="constructor">eval_construct</span></a>;<span class="id" title="tactic">eauto</span>;<span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHargs</span>;<span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>;<span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">facts</span> :=<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">repeat</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : ?<span class="id" title="var">Σ</span> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">e</span></a><a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⊢</span></a> ?<span class="id" title="var">t</span> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⇓</span></a> ?<span class="id" title="var">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|- <span class="id" title="var">_</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H'</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#is_true"><span class="id" title="definition">is_true</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">closed</span></a> <span class="id" title="var">v</span>) |- <span class="id" title="var">_</span> ⇒ <span class="id" title="tactic">fail</span> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>; <span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">closed</span></a> <span class="id" title="var">v</span>) <span class="id" title="tactic">by</span> (<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_closed"><span class="id" title="lemma">eval_closed</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span>); <span class="id" title="tactic">trivial</span>)<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>);<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H</span> : ?<span class="id" title="var">Σ</span> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">e</span></a><a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⊢</span></a> ?<span class="id" title="var">t</span> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⇓</span></a> ?<span class="id" title="var">v</span> |- <span class="id" title="var">_</span>] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H'</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#is_true"><span class="id" title="definition">is_true</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <span class="id" title="var">v</span>) |- <span class="id" title="var">_</span>] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fail</span> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <span class="id" title="var">v</span>) <span class="id" title="tactic">by</span> (<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#eval_valid_cases"><span class="id" title="lemma">eval_valid_cases</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span>); <span class="id" title="tactic">trivial</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>);<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H</span> : ?<span class="id" title="var">Σ</span> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">e</span></a><a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⊢</span></a> ?<span class="id" title="var">t</span> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⇓</span></a> ?<span class="id" title="var">v</span> |- <span class="id" title="var">_</span>] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H'</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#is_true"><span class="id" title="definition">is_true</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <span class="id" title="var">v</span>) |- <span class="id" title="var">_</span>] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fail</span> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <span class="id" title="var">v</span>) <span class="id" title="tactic">by</span> (<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#eval_is_expanded_aux"><span class="id" title="lemma">eval_is_expanded_aux</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> 0 <span class="id" title="var">_</span> <span class="id" title="var">H</span>); <span class="id" title="tactic">trivial</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="count_zeros_le" class="idref" href="#count_zeros_le"><span class="id" title="lemma">count_zeros_le</span></a> : <span class="id" title="keyword">∀</span> <a id="mask:431" class="idref" href="#mask:431"><span class="id" title="binder">mask</span></a>, <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:431"><span class="id" title="variable">mask</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:431"><span class="id" title="variable">mask</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">mask</span>;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>;<span class="id" title="var">cbn</span>; <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> <span class="id" title="tactic">in</span> *; <span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="count_zeros_rev" class="idref" href="#count_zeros_rev"><span class="id" title="lemma">count_zeros_rev</span></a> : <span class="id" title="keyword">∀</span> <a id="msk:432" class="idref" href="#msk:432"><span class="id" title="binder">msk</span></a>, <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#msk:432"><span class="id" title="variable">msk</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#rev"><span class="id" title="definition">List.rev</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#msk:432"><span class="id" title="variable">msk</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">msk</span>; <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>;<span class="id" title="tactic">simpl</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#filter_app"><span class="id" title="lemma">filter_app</span></a>;<span class="id" title="var">cbn</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#app_nil_r"><span class="id" title="lemma">app_nil_r</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#filter_app"><span class="id" title="lemma">filter_app</span></a>;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> <span class="id" title="tactic">in</span> *;<span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="count_zeros_repeat" class="idref" href="#count_zeros_repeat"><span class="id" title="lemma">count_zeros_repeat</span></a> : <span class="id" title="keyword">∀</span> <a id="n:433" class="idref" href="#n:433"><span class="id" title="binder">n</span></a>, <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#repeat"><span class="id" title="definition">repeat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:433"><span class="id" title="variable">n</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:433"><span class="id" title="variable">n</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span>;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">auto</span>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="masked_len" class="idref" href="#masked_len"><span class="id" title="lemma">masked_len</span></a> : <span class="id" title="keyword">∀</span> {<a id="A:434" class="idref" href="#A:434"><span class="id" title="binder">A</span></a>} <a id="m:435" class="idref" href="#m:435"><span class="id" title="binder">m</span></a> (<a id="l:436" class="idref" href="#l:436"><span class="id" title="binder">l</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#A:434"><span class="id" title="variable">A</span></a>) , <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#masked"><span class="id" title="definition">masked</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#m:435"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#l:436"><span class="id" title="variable">l</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#l:436"><span class="id" title="variable">l</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">m</span>;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span>;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHm</span> <span class="id" title="var">l</span>);<span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="count_zeros_distr_app" class="idref" href="#count_zeros_distr_app"><span class="id" title="lemma">count_zeros_distr_app</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="l1:437" class="idref" href="#l1:437"><span class="id" title="binder">l1</span></a> <a id="l2:438" class="idref" href="#l2:438"><span class="id" title="binder">l2</span></a> : <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#bitmask"><span class="id" title="definition">bitmask</span></a>), <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#l1:437"><span class="id" title="variable">l1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#l2:438"><span class="id" title="variable">l2</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#l1:437"><span class="id" title="variable">l1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#l2:438"><span class="id" title="variable">l2</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l1</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">l2</span>;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l2</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">l2</span>;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#app_nil_r"><span class="id" title="lemma">app_nil_r</span></a>;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#filter_app"><span class="id" title="lemma">filter_app</span></a>;<span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a>;<span class="id" title="var">cbn</span>; <span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="dearg_correct.dearg" class="idref" href="#dearg_correct.dearg"><span class="id" title="section">dearg</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<a id="wfl:439" class="idref" href="#wfl:439"><span class="id" title="binder">wfl</span></a> : <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">WcbvFlags</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<a id="n:440" class="idref" href="#n:440"><span class="id" title="binder">n</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<a id="3ef352bac1ca27deefe68c245dcb8c4d" class="idref" href="#3ef352bac1ca27deefe68c245dcb8c4d"><span class="id" title="binder">Σ</span></a> : <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#global_env"><span class="id" title="definition">global_env</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<a id="eb9164f5da66ece8b564a268bfe3e591" class="idref" href="#eb9164f5da66ece8b564a268bfe3e591"><span class="id" title="binder">clos_Σ</span></a> : <a class="idref" href="MetaCoq.Erasure.Typed.ClosedAux.html#env_closed"><span class="id" title="definition">env_closed</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#768b9254b7286c340e72d39183e874a7"><span class="id" title="variable">Σ</span></a>)).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<a id="6f4a7362920aca80b60988dfda40d266" class="idref" href="#6f4a7362920aca80b60988dfda40d266"><span class="id" title="binder">valid_Σ</span></a> : <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_masks_env"><span class="id" title="abbreviation">valid_masks_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#768b9254b7286c340e72d39183e874a7"><span class="id" title="variable">Σ</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<a id="c20eb59c654ab3cb7193e99a1d31713b" class="idref" href="#c20eb59c654ab3cb7193e99a1d31713b"><span class="id" title="binder">exp_Σ</span></a> : <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_env"><span class="id" title="abbreviation">is_expanded_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#768b9254b7286c340e72d39183e874a7"><span class="id" title="variable">Σ</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<a id="IH:448" class="idref" href="#IH:448"><span class="id" title="binder">IH</span></a> : <span class="id" title="keyword">∀</span> <a id="t:445" class="idref" href="#t:445"><span class="id" title="binder">t</span></a> <a id="v:446" class="idref" href="#v:446"><span class="id" title="binder">v</span></a> : <a class="idref" href="MetaCoq.Erasure.EAst.html#term"><span class="id" title="inductive">term</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">closed</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:445"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:445"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:445"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="ev:447" class="idref" href="#ev:447"><span class="id" title="binder">ev</span></a> : <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#768b9254b7286c340e72d39183e874a7"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">e</span></a><a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⊢</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:445"><span class="id" title="variable">t</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⇓</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#v:446"><span class="id" title="variable">v</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#deriv_length"><span class="id" title="definition">deriv_length</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ev:447"><span class="id" title="variable">ev</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.dearg.n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_env"><span class="id" title="abbreviation">dearg_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#768b9254b7286c340e72d39183e874a7"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">e</span></a><a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⊢</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:445"><span class="id" title="variable">t</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⇓</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#v:446"><span class="id" title="variable">v</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="lookup_ctor_trans_env" class="idref" href="#lookup_ctor_trans_env"><span class="id" title="lemma">lookup_ctor_trans_env</span></a> <a id="ind:449" class="idref" href="#ind:449"><span class="id" title="binder">ind</span></a> <a id="c:450" class="idref" href="#c:450"><span class="id" title="binder">c</span></a> <a id="01d6ee9067e93914bce559318eb6fca2" class="idref" href="#01d6ee9067e93914bce559318eb6fca2"><span class="id" title="binder">Σ0</span></a> <a id="mdecl:452" class="idref" href="#mdecl:452"><span class="id" title="binder">mdecl</span></a> <a id="idecl:453" class="idref" href="#idecl:453"><span class="id" title="binder">idecl</span></a> <a id="cdecl:454" class="idref" href="#cdecl:454"><span class="id" title="binder">cdecl</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#lookup_constructor"><span class="id" title="definition">EGlobalEnv.lookup_constructor</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#01d6ee9067e93914bce559318eb6fca2"><span class="id" title="variable">Σ0</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:449"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c:450"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mdecl:452"><span class="id" title="variable">mdecl</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#idecl:453"><span class="id" title="variable">idecl</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#cdecl:454"><span class="id" title="variable">cdecl</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Utils.MCPrelude.html#cd4bc1b07c8b3bdc9f3bbc7941b56107"><span class="id" title="notation">∑</span></a> <a id="mib:455" class="idref" href="#mib:455"><span class="id" title="binder">mib</span></a> <a id="oib:456" class="idref" href="#oib:456"><span class="id" title="binder">oib</span></a> <a id="ctor:457" class="idref" href="#ctor:457"><span class="id" title="binder">ctor</span></a><a class="idref" href="MetaCoq.Utils.MCPrelude.html#cd4bc1b07c8b3bdc9f3bbc7941b56107"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_constructor_full"><span class="id" title="definition">lookup_constructor_full</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#01d6ee9067e93914bce559318eb6fca2"><span class="id" title="variable">Σ0</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:449"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c:450"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mib:455"><span class="id" title="variable">mib</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#oib:456"><span class="id" title="variable">oib</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ctor:457"><span class="id" title="variable">ctor</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mdecl:452"><span class="id" title="variable">mdecl</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_mib"><span class="id" title="definition">trans_mib</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mib:455"><span class="id" title="variable">mib</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#idecl:453"><span class="id" title="variable">idecl</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_oib"><span class="id" title="definition">trans_oib</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#oib:456"><span class="id" title="variable">oib</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#cdecl:454"><span class="id" title="variable">cdecl</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#mkConstructor"><span class="id" title="constructor">mkConstructor</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ctor:457"><span class="id" title="variable">ctor</span></a><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1.1</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ctor:457"><span class="id" title="variable">ctor</span></a><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hlook</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#lookup_constructor"><span class="id" title="definition">EGlobalEnv.lookup_constructor</span></a>,<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_constructor_full"><span class="id" title="definition">lookup_constructor_full</span></a>,<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_minductive"><span class="id" title="definition">lookup_minductive</span></a> <span class="id" title="tactic">in</span> *;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_env_trans_env"><span class="id" title="lemma">lookup_env_trans_env</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlook</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>);<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">g</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#nth_error_map"><span class="id" title="lemma">nth_error_map</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlook</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>);<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_ctors"><span class="id" title="definition">trans_ctors</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#nth_error_map"><span class="id" title="lemma">nth_error_map</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlook</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">c</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">nth1</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">p0</span> ?];<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p0</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hlook</span>;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">eexists</span>;<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="lookup_ctor_trans_env_inv" class="idref" href="#lookup_ctor_trans_env_inv"><span class="id" title="lemma">lookup_ctor_trans_env_inv</span></a> <a id="ind:458" class="idref" href="#ind:458"><span class="id" title="binder">ind</span></a> <a id="c:459" class="idref" href="#c:459"><span class="id" title="binder">c</span></a> <a id="5edac1399e8fb8080ae569e8e3b505cf" class="idref" href="#5edac1399e8fb8080ae569e8e3b505cf"><span class="id" title="binder">Σ0</span></a> <a id="mib:461" class="idref" href="#mib:461"><span class="id" title="binder">mib</span></a> <a id="oib:462" class="idref" href="#oib:462"><span class="id" title="binder">oib</span></a> <a id="ctor:463" class="idref" href="#ctor:463"><span class="id" title="binder">ctor</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_constructor_full"><span class="id" title="definition">lookup_constructor_full</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#5edac1399e8fb8080ae569e8e3b505cf"><span class="id" title="variable">Σ0</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:458"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c:459"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mib:461"><span class="id" title="variable">mib</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#oib:462"><span class="id" title="variable">oib</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ctor:463"><span class="id" title="variable">ctor</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#lookup_constructor"><span class="id" title="definition">EGlobalEnv.lookup_constructor</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#5edac1399e8fb8080ae569e8e3b505cf"><span class="id" title="variable">Σ0</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:458"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c:459"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_mib"><span class="id" title="definition">trans_mib</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mib:461"><span class="id" title="variable">mib</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_oib"><span class="id" title="definition">trans_oib</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#oib:462"><span class="id" title="variable">oib</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#mkConstructor"><span class="id" title="constructor">mkConstructor</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ctor:463"><span class="id" title="variable">ctor</span></a><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1.1</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ctor:463"><span class="id" title="variable">ctor</span></a><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hlook</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#lookup_constructor"><span class="id" title="definition">EGlobalEnv.lookup_constructor</span></a>,<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_constructor_full"><span class="id" title="definition">lookup_constructor_full</span></a>,<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_minductive"><span class="id" title="definition">lookup_minductive</span></a> <span class="id" title="tactic">in</span> *;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_env_trans_env"><span class="id" title="lemma">lookup_env_trans_env</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>);<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">g</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#nth_error_map"><span class="id" title="lemma">nth_error_map</span></a>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>);<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_ctors"><span class="id" title="definition">trans_ctors</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#nth_error_map"><span class="id" title="lemma">nth_error_map</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">c</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">nth1</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">p0</span> ?];<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p0</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hlook</span>;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="lookup_ctor_dearg" class="idref" href="#lookup_ctor_dearg"><span class="id" title="lemma">lookup_ctor_dearg</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="ind:464" class="idref" href="#ind:464"><span class="id" title="binder">ind</span></a> : <a class="idref" href="MetaCoq.Common.Kernames.html#inductive"><span class="id" title="record">inductive</span></a>) (<a id="c:465" class="idref" href="#c:465"><span class="id" title="binder">c</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) <a id="mmasks:466" class="idref" href="#mmasks:466"><span class="id" title="binder">mmasks</span></a> (<a id="mdecl:467" class="idref" href="#mdecl:467"><span class="id" title="binder">mdecl</span></a> : <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#mutual_inductive_body"><span class="id" title="record">mutual_inductive_body</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="idecl:468" class="idref" href="#idecl:468"><span class="id" title="binder">idecl</span></a> : <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#one_inductive_body"><span class="id" title="record">one_inductive_body</span></a>) <a id="cdecl:469" class="idref" href="#cdecl:469"><span class="id" title="binder">cdecl</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_constructor_full"><span class="id" title="definition">lookup_constructor_full</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#768b9254b7286c340e72d39183e874a7"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:464"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c:465"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mdecl:467"><span class="id" title="variable">mdecl</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#idecl:468"><span class="id" title="variable">idecl</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#cdecl:469"><span class="id" title="variable">cdecl</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#get_mib_masks"><span class="id" title="definition">Optimize.get_mib_masks</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a> (<a class="idref" href="MetaCoq.Common.Kernames.html#inductive_mind"><span class="id" title="projection">inductive_mind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:464"><span class="id" title="variable">ind</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mmasks:466"><span class="id" title="variable">mmasks</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_constructor_full"><span class="id" title="definition">lookup_constructor_full</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_env"><span class="id" title="abbreviation">dearg_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#768b9254b7286c340e72d39183e874a7"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:464"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c:465"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_mib"><span class="id" title="definition">dearg_mib</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a> (<a class="idref" href="MetaCoq.Common.Kernames.html#inductive_mind"><span class="id" title="projection">inductive_mind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:464"><span class="id" title="variable">ind</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mdecl:467"><span class="id" title="variable">mdecl</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_oib"><span class="id" title="definition">dearg_oib</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mmasks:466"><span class="id" title="variable">mmasks</span></a> (<a class="idref" href="MetaCoq.Common.Kernames.html#inductive_ind"><span class="id" title="projection">inductive_ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:464"><span class="id" title="variable">ind</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#idecl:468"><span class="id" title="variable">idecl</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_ctor"><span class="id" title="definition">dearg_ctor</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#param_mask"><span class="id" title="projection">param_mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mmasks:466"><span class="id" title="variable">mmasks</span></a>) (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#get_branch_mask"><span class="id" title="definition">get_branch_mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mmasks:466"><span class="id" title="variable">mmasks</span></a> (<a class="idref" href="MetaCoq.Common.Kernames.html#inductive_ind"><span class="id" title="projection">inductive_ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:464"><span class="id" title="variable">ind</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c:465"><span class="id" title="variable">c</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#cdecl:469"><span class="id" title="variable">cdecl</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">ind</span> <span class="id" title="var">c</span> <span class="id" title="var">mmasks</span> <span class="id" title="var">mdecl</span> <span class="id" title="var">idecl</span> <span class="id" title="var">cdecl</span> <span class="id" title="var">Hlook</span> <span class="id" title="var">Hmasks</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_constructor_full"><span class="id" title="definition">lookup_constructor_full</span></a>,<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_minductive"><span class="id" title="definition">lookup_minductive</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_env_dearg_env"><span class="id" title="lemma">lookup_env_dearg_env</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">mdecl_e</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">Henv</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">mdecl_e</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">mib</span> |]<span class="id" title="var">eqn</span>:<span class="id" title="var">Hgd</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_mib"><span class="id" title="definition">dearg_mib</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hmasks</span>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#nth_error_mapi"><span class="id" title="lemma">nth_error_mapi</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> [|]<span class="id" title="var">eqn</span>:<span class="id" title="var">nth</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#nth_error_mapi"><span class="id" title="lemma">nth_error_mapi</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">c</span>);<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hlook</span>;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="lookup_ctor_lookup_env" class="idref" href="#lookup_ctor_lookup_env"><span class="id" title="lemma">lookup_ctor_lookup_env</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="m:470" class="idref" href="#m:470"><span class="id" title="binder">m</span></a> <a id="i:471" class="idref" href="#i:471"><span class="id" title="binder">i</span></a> <a id="ctr:472" class="idref" href="#ctr:472"><span class="id" title="binder">ctr</span></a> <a id="efb7e2a6adafd1fcbb27f5e53705e602" class="idref" href="#efb7e2a6adafd1fcbb27f5e53705e602"><span class="id" title="binder">Σ</span></a> <a id="ind:474" class="idref" href="#ind:474"><span class="id" title="binder">ind</span></a> <a id="c:475" class="idref" href="#c:475"><span class="id" title="binder">c</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#lookup_constructor"><span class="id" title="definition">EGlobalEnv.lookup_constructor</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#efb7e2a6adafd1fcbb27f5e53705e602"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:474"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c:475"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#m:470"><span class="id" title="variable">m</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:471"><span class="id" title="variable">i</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ctr:472"><span class="id" title="variable">ctr</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#lookup_env"><span class="id" title="definition">EGlobalEnv.lookup_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#efb7e2a6adafd1fcbb27f5e53705e602"><span class="id" title="variable">Σ</span></a> (<a class="idref" href="MetaCoq.Common.Kernames.html#inductive_mind"><span class="id" title="projection">inductive_mind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:474"><span class="id" title="variable">ind</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#InductiveDecl"><span class="id" title="constructor">EAst.InductiveDecl</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#m:470"><span class="id" title="variable">m</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#ind_bodies"><span class="id" title="projection">EAst.ind_bodies</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#m:470"><span class="id" title="variable">m</span></a>) (<a class="idref" href="MetaCoq.Common.Kernames.html#inductive_ind"><span class="id" title="projection">inductive_ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:474"><span class="id" title="variable">ind</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:471"><span class="id" title="variable">i</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> <span class="id" title="var">ctr</span> <span class="id" title="var">Σ0</span> <span class="id" title="var">ind0</span> <span class="id" title="var">c0</span> <span class="id" title="var">Hc0</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#lookup_constructor"><span class="id" title="definition">EGlobalEnv.lookup_constructor</span></a> <span class="id" title="tactic">in</span> *;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hc0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#lookup_env"><span class="id" title="definition">EGlobalEnv.lookup_env</span></a> <span class="id" title="var">Σ0</span> <span class="id" title="var">_</span>);<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">g</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">Hi</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>. <span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">c0</span>);<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="count_ones_zeros" class="idref" href="#count_ones_zeros"><span class="id" title="lemma">count_ones_zeros</span></a> <a id="m:476" class="idref" href="#m:476"><span class="id" title="binder">m</span></a> : <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#m:476"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_ones"><span class="id" title="definition">count_ones</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#m:476"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#m:476"><span class="id" title="variable">m</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> -<span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">m</span>;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>;<span class="id" title="var">cbn</span>; <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a>, <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_ones"><span class="id" title="definition">count_ones</span></a> <span class="id" title="tactic">in</span> *;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Hint Resolve</span> &lt;- <span class="id" title="var">forallb_Forall</span> : <span class="id" title="var">dearg</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="eval_tApp_dearg" class="idref" href="#eval_tApp_dearg"><span class="id" title="lemma">eval_tApp_dearg</span></a> {<a id="hd:477" class="idref" href="#hd:477"><span class="id" title="binder">hd</span></a> <a id="arg:478" class="idref" href="#arg:478"><span class="id" title="binder">arg</span></a> <a id="v:479" class="idref" href="#v:479"><span class="id" title="binder">v</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#with_constructor_as_block"><span class="id" title="method">with_constructor_as_block</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">closed</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:477"><span class="id" title="variable">hd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:477"><span class="id" title="variable">hd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:477"><span class="id" title="variable">hd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">closed</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#arg:478"><span class="id" title="variable">arg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#arg:478"><span class="id" title="variable">arg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#arg:478"><span class="id" title="variable">arg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="ev:480" class="idref" href="#ev:480"><span class="id" title="binder">ev</span></a> : <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#768b9254b7286c340e72d39183e874a7"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">e</span></a><a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⊢</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#tApp"><span class="id" title="constructor">tApp</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:477"><span class="id" title="variable">hd</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#arg:478"><span class="id" title="variable">arg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⇓</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#v:479"><span class="id" title="variable">v</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#deriv_length"><span class="id" title="definition">deriv_length</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ev:480"><span class="id" title="variable">ev</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.dearg.n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_env"><span class="id" title="abbreviation">dearg_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#768b9254b7286c340e72d39183e874a7"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">e</span></a><a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⊢</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#tApp"><span class="id" title="constructor">tApp</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:477"><span class="id" title="variable">hd</span></a>) (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#arg:478"><span class="id" title="variable">arg</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⇓</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#v:479"><span class="id" title="variable">v</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">with</span> <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">dearg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? <span class="id" title="var">clos_hd</span> <span class="id" title="var">valid_hd</span> <span class="id" title="var">exp_hd</span> <span class="id" title="var">clos_arg</span> <span class="id" title="var">valid_arg</span> <span class="id" title="var">exp_arg</span> <span class="id" title="var">ev</span> <span class="id" title="var">ev_len</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">depind</span> <span class="id" title="var">ev</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_box"><span class="id" title="constructor">eval_box</span></a> <span class="id" title="keyword">with</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">t'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.dearg.IH"><span class="id" title="variable">IH</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.dearg.IH"><span class="id" title="variable">IH</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> (<a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_beta"><span class="id" title="constructor">eval_beta</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">na</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">b</span>) <span class="id" title="var">_</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">a'</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.dearg.IH"><span class="id" title="variable">IH</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.dearg.IH"><span class="id" title="variable">IH</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">IHev1</span> <span class="id" title="var">IHev2</span> <span class="id" title="var">IHev3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">ev3</span> <span class="id" title="var">ev_len</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="MetaCoq.Erasure.ECSubst.html#closed_subst"><span class="id" title="lemma">closed_subst</span></a>; [|<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#closedn_dearg_aux"><span class="id" title="lemma">closedn_dearg_aux</span></a>|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_subst"><span class="id" title="lemma">dearg_subst</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="var">a'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.dearg.IH"><span class="id" title="variable">IH</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev3</span>)...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_subst"><span class="id" title="lemma">is_expanded_aux_subst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_fix"><span class="id" title="constructor">eval_fix</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#map_def"><span class="id" title="definition">map_def</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a>) <span class="id" title="var">mfix</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">idx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">argsv</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">av</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">fn</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">unshelve</span> <span class="id" title="var">epose</span> <span class="id" title="var">proof</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.dearg.IH"><span class="id" title="variable">IH</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev1</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ev</span>; <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_mkApps"><span class="id" title="lemma">dearg_mkApps</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ev</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.dearg.IH"><span class="id" title="variable">IH</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">invert_facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_cunfold_fix"><span class="id" title="lemma">dearg_cunfold_fix</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">invert_facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#closed_cunfold_fix"><span class="id" title="lemma">closed_cunfold_fix</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e1</span> <span class="id" title="keyword">as</span> ?; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_cunfold_fix"><span class="id" title="lemma">valid_cases_cunfold_fix</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e1</span> <span class="id" title="keyword">as</span> ?; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_cunfold_fix"><span class="id" title="lemma">is_expanded_cunfold_fix</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e1</span> <span class="id" title="keyword">as</span> ?; <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">dearg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_expanded"><span class="id" title="lemma">dearg_expanded</span></a>, &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_mkApps"><span class="id" title="lemma">dearg_mkApps</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHev3</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">ev</span> := <span class="id" title="var">ev3</span>)...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.ClosedAux.html#closed_mkApps"><span class="id" title="lemma">closed_mkApps</span></a>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_mkApps"><span class="id" title="lemma">valid_cases_mkApps</span></a>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_mkApps"><span class="id" title="lemma">is_expanded_aux_mkApps</span></a>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a>; [|<span class="id" title="var">eassumption</span>|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_expanded"><span class="id" title="lemma">dearg_expanded</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_mkApps"><span class="id" title="lemma">dearg_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_fix_value"><span class="id" title="constructor">eval_fix_value</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">narg</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">fn</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">unshelve</span> <span class="id" title="var">epose</span> <span class="id" title="var">proof</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.dearg.IH"><span class="id" title="variable">IH</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev1</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ev</span>; <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_mkApps"><span class="id" title="lemma">dearg_mkApps</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ev</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.dearg.IH"><span class="id" title="variable">IH</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">invert_facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_cunfold_fix"><span class="id" title="lemma">dearg_cunfold_fix</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_fix'"><span class="id" title="constructor">eval_fix'</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#map_def"><span class="id" title="definition">map_def</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_aux"><span class="id" title="abbreviation">dearg_aux</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>)) <span class="id" title="var">mfix</span>) <span class="id" title="var">idx</span> <span class="id" title="var">_</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">av</span>) (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">fn</span>) <span class="id" title="var">_</span> <span class="id" title="var">narg</span> <span class="id" title="var">unguarded</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">unshelve</span> <span class="id" title="var">epose</span> <span class="id" title="var">proof</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.dearg.IH"><span class="id" title="variable">IH</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev1</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ev</span>; <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_cunfold_fix"><span class="id" title="lemma">dearg_cunfold_fix</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">unshelve</span> <span class="id" title="var">epose</span> <span class="id" title="var">proof</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.dearg.IH"><span class="id" title="variable">IH</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev2</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ev</span>; <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHev3</span>;<span class="id" title="tactic">eauto</span>;<span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#closed_cunfold_fix"><span class="id" title="lemma">closed_cunfold_fix</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e0</span> <span class="id" title="keyword">as</span> <span class="id" title="var">c_fn</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_cunfold_fix"><span class="id" title="lemma">valid_cases_cunfold_fix</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e0</span> <span class="id" title="keyword">as</span> <span class="id" title="var">vc_fn</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_cunfold_fix"><span class="id" title="lemma">is_expanded_cunfold_fix</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e0</span> <span class="id" title="keyword">as</span> ?;<span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">dearg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_ctor_trans_env"><span class="id" title="lemma">lookup_ctor_trans_env</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e0</span> <span class="id" title="keyword">as</span> <span class="id" title="var">e0'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">e0'</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">mib</span> &amp; <span class="id" title="var">oib</span> &amp; <span class="id" title="var">ctor</span> &amp; <span class="id" title="var">Hlook</span> &amp; <span class="id" title="var">Hmib</span> &amp; <span class="id" title="var">Hoib</span> &amp; <span class="id" title="var">Hctor</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_expanded"><span class="id" title="lemma">dearg_expanded</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_mkApps"><span class="id" title="lemma">dearg_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">invert_facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_single_masked"><span class="id" title="lemma">dearg_single_masked</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">decl_ind</span> :<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#declared_inductive"><span class="id" title="definition">declared_inductive</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#768b9254b7286c340e72d39183e874a7"><span class="id" title="variable">Σ</span></a>) <span class="id" title="var">ind</span> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_mib"><span class="id" title="definition">trans_mib</span></a> <span class="id" title="var">mib</span>) (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_oib"><span class="id" title="definition">trans_oib</span></a> <span class="id" title="var">oib</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#declared_inductive"><span class="id" title="definition">declared_inductive</span></a>,<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#declared_minductive"><span class="id" title="definition">declared_minductive</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_ctor_lookup_env"><span class="id" title="lemma">lookup_ctor_lookup_env</span></a>;<span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">e0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_ctor_lookup_env"><span class="id" title="lemma">lookup_ctor_lookup_env</span></a>;<span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">e0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_ind_mask_inductive"><span class="id" title="lemma">valid_ind_mask_inductive</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#fd150ae4b0fa9490a0d6dd7f5ba66a24"><span class="id" title="variable">valid_Σ</span></a> <span class="id" title="var">decl_ind</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">mask</span> [<span class="id" title="var">Hmask</span> <span class="id" title="var">Hparams</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_mib"><span class="id" title="definition">trans_mib</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_mib"><span class="id" title="definition">dearg_mib</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a> (<a class="idref" href="MetaCoq.Common.Kernames.html#inductive_mind"><span class="id" title="projection">inductive_mind</span></a> <span class="id" title="var">ind</span>) <span class="id" title="var">mib</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">mib_dearg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_oib"><span class="id" title="definition">trans_oib</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_oib"><span class="id" title="definition">dearg_oib</span></a> <span class="id" title="var">mask</span> (<a class="idref" href="MetaCoq.Common.Kernames.html#inductive_ind"><span class="id" title="projection">inductive_ind</span></a> <span class="id" title="var">ind</span>) <span class="id" title="var">oib</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">oib_dearg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_ctor"><span class="id" title="definition">dearg_ctor</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#param_mask"><span class="id" title="projection">param_mask</span></a> <span class="id" title="var">mask</span>) (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#get_branch_mask"><span class="id" title="definition">get_branch_mask</span></a> <span class="id" title="var">mask</span> (<a class="idref" href="MetaCoq.Common.Kernames.html#inductive_ind"><span class="id" title="projection">inductive_ind</span></a> <span class="id" title="var">ind</span>) <span class="id" title="var">c</span>) <span class="id" title="var">ctor</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ctor_dearg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_construct"><span class="id" title="constructor">eval_construct</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mib_dearg</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">oib_dearg</span> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkConstructor"><span class="id" title="constructor">mkConstructor</span></a> <span class="id" title="var">ctor_dearg</span><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1.1</span></a> <span class="id" title="var">ctor_dearg</span><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>);<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">oib_dearg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_ctor_trans_env_inv"><span class="id" title="lemma">lookup_ctor_trans_env_inv</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_ctor_dearg"><span class="id" title="lemma">lookup_ctor_dearg</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_single_masked"><span class="id" title="lemma">dearg_single_masked</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_single"><span class="id" title="definition">dearg_single</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#get_ctor_mask"><span class="id" title="abbreviation">get_ctor_mask</span></a> <span class="id" title="var">ind</span> <span class="id" title="var">c</span>) (<a class="idref" href="MetaCoq.Erasure.EAst.html#tConstruct"><span class="id" title="constructor">tConstruct</span></a> <span class="id" title="var">ind</span> <span class="id" title="var">c</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">args</span>)) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_aux"><span class="id" title="abbreviation">dearg_aux</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">args</span>) (<a class="idref" href="MetaCoq.Erasure.EAst.html#tConstruct"><span class="id" title="constructor">tConstruct</span></a> <span class="id" title="var">ind</span> <span class="id" title="var">c</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_mkApps"><span class="id" title="lemma">dearg_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.dearg.IH"><span class="id" title="variable">IH</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev1</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">propify</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_mib"><span class="id" title="definition">trans_mib</span></a>,<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_mib"><span class="id" title="definition">dearg_mib</span></a>, <a class="idref" href="MetaCoq.Erasure.EAst.html#cstr_arity"><span class="id" title="definition">cstr_arity</span></a> <span class="id" title="tactic">in</span> *;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hparams</span> <span class="id" title="tactic">in</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#masked_count_zeros"><span class="id" title="lemma">masked_count_zeros</span></a> <span class="id" title="tactic">in</span> × <span class="id" title="tactic">by</span> (<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>;<span class="id" title="var">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#count_zeros_le"><span class="id" title="lemma">count_zeros_le</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#param_mask"><span class="id" title="projection">param_mask</span></a> <span class="id" title="var">mask</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">get_ctor_mask</span>, <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_ctor"><span class="id" title="definition">dearg_ctor</span></a> <span class="id" title="tactic">in</span> ×. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hmask</span> <span class="id" title="tactic">in</span> ×. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ctor</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">p0</span>]. <span class="id" title="tactic">destruct</span> <span class="id" title="var">p0</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#count_zeros_distr_app"><span class="id" title="lemma">count_zeros_distr_app</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#get_branch_mask"><span class="id" title="definition">get_branch_mask</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">bm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> <span class="id" title="var">bm</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">bm</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#count_zeros_le"><span class="id" title="lemma">count_zeros_le</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> <span class="id" title="var">bm</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_ones"><span class="id" title="definition">count_ones</span></a> <span class="id" title="var">bm</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">bm</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> ) <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#count_ones_zeros"><span class="id" title="lemma">count_ones_zeros</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.dearg.IH"><span class="id" title="variable">IH</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev2</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_expanded"><span class="id" title="lemma">dearg_expanded</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_app_cong"><span class="id" title="constructor">eval_app_cong</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.dearg.IH"><span class="id" title="variable">IH</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev1</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_elim"><span class="id" title="lemma">dearg_elim</span></a> <span class="id" title="var">f'</span>); <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">invert_facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_single_masked"><span class="id" title="lemma">dearg_single_masked</span></a> <span class="id" title="tactic">by</span> (<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#isLambda_mkApps"><span class="id" title="lemma">isLambda_mkApps</span></a>, <a class="idref" href="MetaCoq.Erasure.EAstUtils.html#isFixApp_mkApps"><span class="id" title="lemma">isFixApp_mkApps</span></a>, <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#isBox_mkApps"><span class="id" title="lemma">isBox_mkApps</span></a>, <a class="idref" href="MetaCoq.Erasure.EAstUtils.html#isConstructApp_mkApps"><span class="id" title="lemma">isConstructApp_mkApps</span></a>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.EAstUtils.html#isPrimApp_mkApps"><span class="id" title="lemma">isPrimApp_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#with_guarded_fix"><span class="id" title="method">with_guarded_fix</span></a>;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.EOptimizePropDiscr.html#isFix_mkApps"><span class="id" title="lemma">EOptimizePropDiscr.isFix_mkApps</span></a>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#isLambda_mkApps"><span class="id" title="lemma">isLambda_mkApps</span></a>, <a class="idref" href="MetaCoq.Erasure.EAstUtils.html#isFixApp_mkApps"><span class="id" title="lemma">isFixApp_mkApps</span></a>, <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#isBox_mkApps"><span class="id" title="lemma">isBox_mkApps</span></a>, <a class="idref" href="MetaCoq.Erasure.EAstUtils.html#isConstructApp_mkApps"><span class="id" title="lemma">isConstructApp_mkApps</span></a> <span class="id" title="tactic">in</span> *;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#with_guarded_fix"><span class="id" title="method">with_guarded_fix</span></a>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">unfold</span> <span class="id" title="var">dearg_case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#with_guarded_fix"><span class="id" title="method">with_guarded_fix</span></a>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#isLambda_mkApps"><span class="id" title="lemma">isLambda_mkApps</span></a>, <a class="idref" href="MetaCoq.Erasure.EAstUtils.html#isFixApp_mkApps"><span class="id" title="lemma">isFixApp_mkApps</span></a>, <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#isBox_mkApps"><span class="id" title="lemma">isBox_mkApps</span></a>, <a class="idref" href="MetaCoq.Erasure.EAstUtils.html#isConstructApp_mkApps"><span class="id" title="lemma">isConstructApp_mkApps</span></a>, <a class="idref" href="MetaCoq.Erasure.EAstUtils.html#isPrimApp_mkApps"><span class="id" title="lemma">isPrimApp_mkApps</span></a>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#isLambda_mkApps"><span class="id" title="lemma">isLambda_mkApps</span></a>, <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#isBox_mkApps"><span class="id" title="lemma">isBox_mkApps</span></a>, <a class="idref" href="MetaCoq.Erasure.EAstUtils.html#isConstructApp_mkApps"><span class="id" title="lemma">isConstructApp_mkApps</span></a>, <a class="idref" href="MetaCoq.Erasure.EOptimizePropDiscr.html#isFix_mkApps"><span class="id" title="lemma">EOptimizePropDiscr.isFix_mkApps</span></a>, <a class="idref" href="MetaCoq.Erasure.EAstUtils.html#isPrimApp_mkApps"><span class="id" title="lemma">isPrimApp_mkApps</span></a>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">unfold</span> <span class="id" title="var">dearg_proj</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">dearg_case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#with_guarded_fix"><span class="id" title="method">with_guarded_fix</span></a>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#isLambda_mkApps"><span class="id" title="lemma">isLambda_mkApps</span></a>, <a class="idref" href="MetaCoq.Erasure.EAstUtils.html#isFixApp_mkApps"><span class="id" title="lemma">isFixApp_mkApps</span></a>, <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#isBox_mkApps"><span class="id" title="lemma">isBox_mkApps</span></a>, <a class="idref" href="MetaCoq.Erasure.EAstUtils.html#isConstructApp_mkApps"><span class="id" title="lemma">isConstructApp_mkApps</span></a>, <a class="idref" href="MetaCoq.Erasure.EAstUtils.html#isPrimApp_mkApps"><span class="id" title="lemma">isPrimApp_mkApps</span></a>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#isLambda_mkApps"><span class="id" title="lemma">isLambda_mkApps</span></a>, <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#isBox_mkApps"><span class="id" title="lemma">isBox_mkApps</span></a>, <a class="idref" href="MetaCoq.Erasure.EAstUtils.html#isConstructApp_mkApps"><span class="id" title="lemma">isConstructApp_mkApps</span></a>, <a class="idref" href="MetaCoq.Erasure.EOptimizePropDiscr.html#isFix_mkApps"><span class="id" title="lemma">EOptimizePropDiscr.isFix_mkApps</span></a>, <a class="idref" href="MetaCoq.Erasure.EAstUtils.html#isPrimApp_mkApps"><span class="id" title="lemma">isPrimApp_mkApps</span></a>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">rewrite</span> !<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#isLambda_mkApps"><span class="id" title="lemma">isLambda_mkApps</span></a>, !<a class="idref" href="MetaCoq.Erasure.EAstUtils.html#isFixApp_mkApps"><span class="id" title="lemma">isFixApp_mkApps</span></a>, !<a class="idref" href="MetaCoq.Erasure.EOptimizePropDiscr.html#isFix_mkApps"><span class="id" title="lemma">EOptimizePropDiscr.isFix_mkApps</span></a>, !<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#isBox_mkApps"><span class="id" title="lemma">isBox_mkApps</span></a>, <a class="idref" href="MetaCoq.Erasure.EAstUtils.html#isConstructApp_mkApps"><span class="id" title="lemma">isConstructApp_mkApps</span></a>, <a class="idref" href="MetaCoq.Erasure.EAstUtils.html#isPrimApp_mkApps"><span class="id" title="lemma">isPrimApp_mkApps</span></a> <span class="id" title="tactic">in</span> ×<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">hd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#with_guarded_fix"><span class="id" title="method">with_guarded_fix</span></a>;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">args</span>;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">auto</span>;<span class="id" title="tactic">destruct</span> <span class="id" title="var">hd</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.dearg.IH"><span class="id" title="variable">IH</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev2</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="eval_mkApps_dearg" class="idref" href="#eval_mkApps_dearg"><span class="id" title="lemma">eval_mkApps_dearg</span></a> <a id="hd:481" class="idref" href="#hd:481"><span class="id" title="binder">hd</span></a> <a id="args:482" class="idref" href="#args:482"><span class="id" title="binder">args</span></a> <a id="v:483" class="idref" href="#v:483"><span class="id" title="binder">v</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#with_constructor_as_block"><span class="id" title="method">with_constructor_as_block</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">closed</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:481"><span class="id" title="variable">hd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:481"><span class="id" title="variable">hd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:481"><span class="id" title="variable">hd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">closedn</span></a> 0) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:482"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:482"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:482"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="ev:484" class="idref" href="#ev:484"><span class="id" title="binder">ev</span></a> : <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#768b9254b7286c340e72d39183e874a7"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">e</span></a><a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⊢</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:481"><span class="id" title="variable">hd</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:482"><span class="id" title="variable">args</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⇓</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#v:483"><span class="id" title="variable">v</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#deriv_length"><span class="id" title="definition">deriv_length</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ev:484"><span class="id" title="variable">ev</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.dearg.n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_env"><span class="id" title="abbreviation">dearg_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#768b9254b7286c340e72d39183e874a7"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">e</span></a><a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⊢</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:481"><span class="id" title="variable">hd</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:482"><span class="id" title="variable">args</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⇓</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#v:483"><span class="id" title="variable">v</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? <span class="id" title="var">clos_hd</span> <span class="id" title="var">valid_hd</span> <span class="id" title="var">exp_hd</span> <span class="id" title="var">clos_args</span> <span class="id" title="var">valid_args</span> <span class="id" title="var">exp_args</span> <span class="id" title="var">ev</span> <span class="id" title="var">ev_len</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#eval_mkApps_deriv"><span class="id" title="lemma">eval_mkApps_deriv</span></a> <span class="id" title="var">ev</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">hdv</span> &amp; <span class="id" title="var">ev_hd</span> &amp; <span class="id" title="var">argsv</span> &amp; <span class="id" title="var">ev_args</span> &amp; <span class="id" title="var">ev_args_len</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">ev_args</span> <span class="id" title="keyword">using</span> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#All2_rev_rect"><span class="id" title="lemma">All2_rev_rect</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">assert</span> (<span class="id" title="var">hdv</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">v</span>) <span class="id" title="keyword">as</span> → <span class="id" title="tactic">by</span> (<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_deterministic"><span class="id" title="lemma">eval_deterministic</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.dearg.IH"><span class="id" title="variable">IH</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev_hd</span> <span class="id" title="var">_</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">revert</span> <span class="id" title="var">ev</span> <span class="id" title="var">ev_len</span> <span class="id" title="var">ev_args_len</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_app"><span class="id" title="lemma">map_app</span></a>, !<a class="idref" href="MetaCoq.Erasure.EAstUtils.html#mkApps_app"><span class="id" title="lemma">mkApps_app</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_expanded"><span class="id" title="lemma">dearg_expanded</span></a>, &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_mkApps"><span class="id" title="lemma">dearg_mkApps</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#eval_tApp_dearg"><span class="id" title="lemma">eval_tApp_dearg</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.ClosedAux.html#closed_mkApps"><span class="id" title="lemma">closed_mkApps</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_mkApps"><span class="id" title="lemma">valid_cases_mkApps</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_mkApps"><span class="id" title="lemma">is_expanded_aux_mkApps</span></a>; [<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">exp_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">exp_args</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="eval_mkApps_dearg_reduce" class="idref" href="#eval_mkApps_dearg_reduce"><span class="id" title="lemma">eval_mkApps_dearg_reduce</span></a> {<a id="hd:485" class="idref" href="#hd:485"><span class="id" title="binder">hd</span></a> <a id="args:486" class="idref" href="#args:486"><span class="id" title="binder">args</span></a> <a id="v:487" class="idref" href="#v:487"><span class="id" title="binder">v</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#with_constructor_as_block"><span class="id" title="method">with_constructor_as_block</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">closed</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:485"><span class="id" title="variable">hd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:485"><span class="id" title="variable">hd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:485"><span class="id" title="variable">hd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">closedn</span></a> 0) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:486"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:486"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:486"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:486"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_env"><span class="id" title="abbreviation">dearg_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#768b9254b7286c340e72d39183e874a7"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">e</span></a><a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⊢</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:485"><span class="id" title="variable">hd</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⇓</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#v:487"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="ev:488" class="idref" href="#ev:488"><span class="id" title="binder">ev</span></a> : <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#768b9254b7286c340e72d39183e874a7"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">e</span></a><a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⊢</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:485"><span class="id" title="variable">hd</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:486"><span class="id" title="variable">args</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⇓</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#v:487"><span class="id" title="variable">v</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#deriv_length"><span class="id" title="definition">deriv_length</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ev:488"><span class="id" title="variable">ev</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.dearg.n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_env"><span class="id" title="abbreviation">dearg_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#768b9254b7286c340e72d39183e874a7"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">e</span></a><a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⊢</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#hd:485"><span class="id" title="variable">hd</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:486"><span class="id" title="variable">args</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⇓</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#v:487"><span class="id" title="variable">v</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? <span class="id" title="var">clos_hd</span> <span class="id" title="var">valid_hd</span> <span class="id" title="var">exp_hd</span> <span class="id" title="var">clos_args</span> <span class="id" title="var">valid_args</span> <span class="id" title="var">exp_args</span> <span class="id" title="var">no_args</span> <span class="id" title="var">ev</span> <span class="id" title="var">ev_len</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">args</span> <span class="id" title="keyword">as</span> [|? ? <span class="id" title="var">_</span>] <span class="id" title="keyword">using</span> <a class="idref" href="MetaCoq.Utils.MCList.html#rev_ind"><span class="id" title="lemma">MCList.rev_ind</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">ev</span> <span class="id" title="var">ev_len</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_app"><span class="id" title="lemma">map_app</span></a>, !<a class="idref" href="MetaCoq.Erasure.EAstUtils.html#mkApps_app"><span class="id" title="lemma">mkApps_app</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#eval_tApp_deriv"><span class="id" title="lemma">eval_tApp_deriv</span></a> <span class="id" title="var">ev</span>) <span class="id" title="keyword">as</span> (? &amp; ? &amp; ? &amp; ? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#eval_tApp_heads"><span class="id" title="lemma">eval_tApp_heads</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: { <span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#eval_mkApps_dearg"><span class="id" title="lemma">eval_mkApps_dearg</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">exp_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">lia</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: { <span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.dearg.IH"><span class="id" title="variable">IH</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.ClosedAux.html#closed_mkApps"><span class="id" title="lemma">closed_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_mkApps"><span class="id" title="lemma">valid_cases_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_mkApps"><span class="id" title="lemma">is_expanded_aux_mkApps</span></a>; [<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">exp_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">lia</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#eval_tApp_dearg"><span class="id" title="lemma">eval_tApp_dearg</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.ClosedAux.html#closed_mkApps"><span class="id" title="lemma">closed_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_mkApps"><span class="id" title="lemma">valid_cases_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">exp_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_mkApps"><span class="id" title="lemma">is_expanded_aux_mkApps</span></a>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">exp_args</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.dearg"><span class="id" title="section">dearg</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="env_closed_dearg" class="idref" href="#env_closed_dearg"><span class="id" title="lemma">env_closed_dearg</span></a> <a id="034eaac0095b294e052684a582248eb3" class="idref" href="#034eaac0095b294e052684a582248eb3"><span class="id" title="binder">Σ</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.ClosedAux.html#env_closed"><span class="id" title="definition">env_closed</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#034eaac0095b294e052684a582248eb3"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.ClosedAux.html#env_closed"><span class="id" title="definition">env_closed</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_env"><span class="id" title="abbreviation">dearg_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#034eaac0095b294e052684a582248eb3"><span class="id" title="variable">Σ</span></a>)).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">clos</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Σ</span> <span class="id" title="keyword">as</span> [|((<span class="id" title="var">kn</span> &amp; <span class="id" title="var">has_deps</span>) &amp; <span class="id" title="var">decl</span>) <span class="id" title="var">Σ</span> <span class="id" title="var">IH</span>]; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">decl</span>; [|<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>; <span class="id" title="tactic">split</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#cst_body"><span class="id" title="projection">cst_body</span></a> <span class="id" title="var">c</span>); [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#closedn_dearg_aux"><span class="id" title="lemma">closedn_dearg_aux</span></a>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#closedn_dearg_lambdas"><span class="id" title="lemma">closedn_dearg_lambdas</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">o</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="valid_dearg_mask_dearg_aux" class="idref" href="#valid_dearg_mask_dearg_aux"><span class="id" title="lemma">valid_dearg_mask_dearg_aux</span></a> <a id="mask:490" class="idref" href="#mask:490"><span class="id" title="binder">mask</span></a> <a id="t:491" class="idref" href="#t:491"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_dearg_mask"><span class="id" title="definition">valid_dearg_mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:490"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:491"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_dearg_mask"><span class="id" title="definition">valid_dearg_mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:490"><span class="id" title="variable">mask</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:491"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">mask</span>, <span class="id" title="var">t</span>, <span class="id" title="var">valid</span> |- *; <span class="id" title="tactic">auto</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span>; [<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_dearg_mask_nil"><span class="id" title="lemma">valid_dearg_mask_nil</span></a>|]).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">propify</span>; <span class="id" title="tactic">split</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_dead_dearg_aux"><span class="id" title="lemma">is_dead_dearg_aux</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="masked_length" class="idref" href="#masked_length"><span class="id" title="lemma">masked_length</span></a> {<a id="X:492" class="idref" href="#X:492"><span class="id" title="binder">X</span></a>} <a id="m:493" class="idref" href="#m:493"><span class="id" title="binder">m</span></a> (<a id="xs:494" class="idref" href="#xs:494"><span class="id" title="binder">xs</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#X:492"><span class="id" title="variable">X</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#m:493"><span class="id" title="variable">m</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#xs:494"><span class="id" title="variable">xs</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#masked"><span class="id" title="definition">masked</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#m:493"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#xs:494"><span class="id" title="variable">xs</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#m:493"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#xs:494"><span class="id" title="variable">xs</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#m:493"><span class="id" title="variable">m</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">len</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">m</span> <span class="id" title="tactic">in</span> <span class="id" title="var">xs</span>, <span class="id" title="var">len</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">xs</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">xs</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHm</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHm</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="masked_app" class="idref" href="#masked_app"><span class="id" title="lemma">masked_app</span></a> {<a id="X:495" class="idref" href="#X:495"><span class="id" title="binder">X</span></a>} <a id="m:496" class="idref" href="#m:496"><span class="id" title="binder">m</span></a> <a id="m':497" class="idref" href="#m':497"><span class="id" title="binder">m'</span></a> (<a id="xs:498" class="idref" href="#xs:498"><span class="id" title="binder">xs</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#X:495"><span class="id" title="variable">X</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#masked"><span class="id" title="definition">masked</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#m:496"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#m':497"><span class="id" title="variable">m'</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#xs:498"><span class="id" title="variable">xs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#firstn"><span class="id" title="definition">firstn</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#m:496"><span class="id" title="variable">m</span></a>) (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#masked"><span class="id" title="definition">masked</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#m:496"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#xs:498"><span class="id" title="variable">xs</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#masked"><span class="id" title="definition">masked</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#m':497"><span class="id" title="variable">m'</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#skipn"><span class="id" title="definition">skipn</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#m:496"><span class="id" title="variable">m</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#xs:498"><span class="id" title="variable">xs</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">m</span> <span class="id" title="tactic">in</span> <span class="id" title="var">m'</span>, <span class="id" title="var">xs</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">xs</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#firstn_nil"><span class="id" title="lemma">firstn_nil</span></a>, <a class="idref" href="MetaCoq.Utils.MCList.html#skipn_nil"><span class="id" title="lemma">skipn_nil</span></a>, <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#masked_nil"><span class="id" title="lemma">masked_nil</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#skipn_nil"><span class="id" title="lemma">skipn_nil</span></a>, <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#masked_nil"><span class="id" title="lemma">masked_nil</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHm</span>, <a class="idref" href="MetaCoq.Utils.MCList.html#skipn_S"><span class="id" title="lemma">skipn_S</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHm</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="masked_map" class="idref" href="#masked_map"><span class="id" title="lemma">masked_map</span></a> {<a id="X:499" class="idref" href="#X:499"><span class="id" title="binder">X</span></a> <a id="Y:500" class="idref" href="#Y:500"><span class="id" title="binder">Y</span></a>} <a id="m:501" class="idref" href="#m:501"><span class="id" title="binder">m</span></a> (<a id="f:502" class="idref" href="#f:502"><span class="id" title="binder">f</span></a> : <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#X:499"><span class="id" title="variable">X</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#Y:500"><span class="id" title="variable">Y</span></a>) <a id="xs:503" class="idref" href="#xs:503"><span class="id" title="binder">xs</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#masked"><span class="id" title="definition">masked</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#m:501"><span class="id" title="variable">m</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#f:502"><span class="id" title="variable">f</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#xs:503"><span class="id" title="variable">xs</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#f:502"><span class="id" title="variable">f</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#masked"><span class="id" title="definition">masked</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#m:501"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#xs:503"><span class="id" title="variable">xs</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">m</span> <span class="id" title="keyword">as</span> [|[] <span class="id" title="var">m</span> <span class="id" title="var">IH</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">xs</span> |- *; [<span class="id" title="var">easy</span>| |]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">xs</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">xs</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="filter_length" class="idref" href="#filter_length"><span class="id" title="lemma">filter_length</span></a> {<a id="X:504" class="idref" href="#X:504"><span class="id" title="binder">X</span></a>} (<a id="f:505" class="idref" href="#f:505"><span class="id" title="binder">f</span></a> : <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#X:504"><span class="id" title="variable">X</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>) (<a id="xs:506" class="idref" href="#xs:506"><span class="id" title="binder">xs</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#X:504"><span class="id" title="variable">X</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#f:505"><span class="id" title="variable">f</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#xs:506"><span class="id" title="variable">xs</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#xs:506"><span class="id" title="variable">xs</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">xs</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">f</span> <span class="id" title="var">a</span>); <span class="id" title="var">cbn</span>; <span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="map_repeat" class="idref" href="#map_repeat"><span class="id" title="lemma">map_repeat</span></a> {<a id="X:507" class="idref" href="#X:507"><span class="id" title="binder">X</span></a> <a id="Y:508" class="idref" href="#Y:508"><span class="id" title="binder">Y</span></a>} (<a id="f:509" class="idref" href="#f:509"><span class="id" title="binder">f</span></a> : <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#X:507"><span class="id" title="variable">X</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#Y:508"><span class="id" title="variable">Y</span></a>) <a id="x:510" class="idref" href="#x:510"><span class="id" title="binder">x</span></a> <a id="n:511" class="idref" href="#n:511"><span class="id" title="binder">n</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#f:509"><span class="id" title="variable">f</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#repeat"><span class="id" title="definition">repeat</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#x:510"><span class="id" title="variable">x</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:511"><span class="id" title="variable">n</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#repeat"><span class="id" title="definition">repeat</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#f:509"><span class="id" title="variable">f</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#x:510"><span class="id" title="variable">x</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:511"><span class="id" title="variable">n</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">cbn</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHn</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="nth_error_masked" class="idref" href="#nth_error_masked"><span class="id" title="lemma">nth_error_masked</span></a> {<a id="X:512" class="idref" href="#X:512"><span class="id" title="binder">X</span></a>} <a id="m:513" class="idref" href="#m:513"><span class="id" title="binder">m</span></a> (<a id="xs:514" class="idref" href="#xs:514"><span class="id" title="binder">xs</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#X:512"><span class="id" title="variable">X</span></a>) <a id="n:515" class="idref" href="#n:515"><span class="id" title="binder">n</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth"><span class="id" title="definition">nth</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:515"><span class="id" title="variable">n</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#m:513"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#masked"><span class="id" title="definition">masked</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#m:513"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#xs:514"><span class="id" title="variable">xs</span></a>) (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:515"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_ones"><span class="id" title="definition">count_ones</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#firstn"><span class="id" title="definition">firstn</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:515"><span class="id" title="variable">n</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#m:513"><span class="id" title="variable">m</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#xs:514"><span class="id" title="variable">xs</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:515"><span class="id" title="variable">n</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">not_removed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="tactic">in</span> <span class="id" title="var">m</span>, <span class="id" title="var">xs</span>, <span class="id" title="var">not_removed</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">xs</span>; [<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#masked_nil"><span class="id" title="lemma">masked_nil</span></a>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">xs</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#nth_error_nil"><span class="id" title="lemma">nth_error_nil</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.sub_succ_l"><span class="id" title="lemma">Nat.sub_succ_l</span></a>; [<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHn</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">transitivity</span> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#firstn"><span class="id" title="definition">firstn</span></a> <span class="id" title="var">n</span> <span class="id" title="var">m</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>; [|<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#firstn_length"><span class="id" title="lemma">firstn_length</span></a>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#filter_length"><span class="id" title="lemma">filter_length</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="dearged_ctor_arity" class="idref" href="#dearged_ctor_arity"><span class="id" title="definition">dearged_ctor_arity</span></a> (<a id="mm:516" class="idref" href="#mm:516"><span class="id" title="binder">mm</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#mib_masks"><span class="id" title="record">mib_masks</span></a>) (<a id="ind_index:517" class="idref" href="#ind_index:517"><span class="id" title="binder">ind_index</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="ctor_index:518" class="idref" href="#ctor_index:518"><span class="id" title="binder">ctor_index</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="ctor_body:519" class="idref" href="#ctor_body:519"><span class="id" title="binder">ctor_body</span></a> : <a class="idref" href="MetaCoq.Erasure.EAst.html#constructor_body"><span class="id" title="record">constructor_body</span></a>) : <a class="idref" href="MetaCoq.Erasure.EAst.html#constructor_body"><span class="id" title="record">constructor_body</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mm:516"><span class="id" title="variable">mm</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">mm0</span> ⇒ <a class="idref" href="MetaCoq.Erasure.EAst.html#mkConstructor"><span class="id" title="constructor">mkConstructor</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#cstr_name"><span class="id" title="projection">cstr_name</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ctor_body:519"><span class="id" title="variable">ctor_body</span></a>) (<a class="idref" href="MetaCoq.Erasure.EAst.html#cstr_nargs"><span class="id" title="projection">cstr_nargs</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ctor_body:519"><span class="id" title="variable">ctor_body</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_ones"><span class="id" title="definition">count_ones</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#get_branch_mask"><span class="id" title="definition">get_branch_mask</span></a> <span class="id" title="var">mm0</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind_index:517"><span class="id" title="variable">ind_index</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ctor_index:518"><span class="id" title="variable">ctor_index</span></a>))<br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ctor_body:519"><span class="id" title="variable">ctor_body</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="constructor_isprop_pars_decl_trans_env_dearg_env" class="idref" href="#constructor_isprop_pars_decl_trans_env_dearg_env"><span class="id" title="lemma">constructor_isprop_pars_decl_trans_env_dearg_env</span></a> <a id="36057eec56567c86c732eb0989b3c741" class="idref" href="#36057eec56567c86c732eb0989b3c741"><span class="id" title="binder">Σ</span></a> <a id="ind:522" class="idref" href="#ind:522"><span class="id" title="binder">ind</span></a> <a id="c:523" class="idref" href="#c:523"><span class="id" title="binder">c</span></a> <a id="b:524" class="idref" href="#b:524"><span class="id" title="binder">b</span></a> <a id="cdecl:525" class="idref" href="#cdecl:525"><span class="id" title="binder">cdecl</span></a> <a id="pars:526" class="idref" href="#pars:526"><span class="id" title="binder">pars</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="mm:527" class="idref" href="#mm:527"><span class="id" title="binder">mm</span></a> := <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> (<a class="idref" href="MetaCoq.Common.Kernames.html#inductive_mind"><span class="id" title="projection">inductive_mind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:522"><span class="id" title="variable">ind</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#constructor_isprop_pars_decl"><span class="id" title="definition">constructor_isprop_pars_decl</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#36057eec56567c86c732eb0989b3c741"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:522"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c:523"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#b:524"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#pars:526"><span class="id" title="variable">pars</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#cdecl:525"><span class="id" title="variable">cdecl</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#constructor_isprop_pars_decl"><span class="id" title="definition">constructor_isprop_pars_decl</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_env"><span class="id" title="abbreviation">dearg_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#36057eec56567c86c732eb0989b3c741"><span class="id" title="variable">Σ</span></a>)) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:522"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c:523"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#b:524"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearged_npars"><span class="id" title="definition">dearged_npars</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mm:527"><span class="id" title="variable">mm</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#pars:526"><span class="id" title="variable">pars</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearged_ctor_arity"><span class="id" title="definition">dearged_ctor_arity</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mm:527"><span class="id" title="variable">mm</span></a> (<a class="idref" href="MetaCoq.Common.Kernames.html#inductive_ind"><span class="id" title="projection">inductive_ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:522"><span class="id" title="variable">ind</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c:523"><span class="id" title="variable">c</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#cdecl:525"><span class="id" title="variable">cdecl</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? <span class="id" title="var">Hc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#constructor_isprop_pars_decl"><span class="id" title="definition">constructor_isprop_pars_decl</span></a>,<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearged_npars"><span class="id" title="definition">dearged_npars</span></a> <span class="id" title="tactic">in</span> *;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_env_trans_env"><span class="id" title="lemma">lookup_env_trans_env</span></a>, <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_env_dearg_env"><span class="id" title="lemma">lookup_env_dearg_env</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">g</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="MetaCoq.Utils.MCList.html#nth_error_map"><span class="id" title="lemma">nth_error_map</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_mib"><span class="id" title="definition">dearg_mib</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#nth_error_mapi"><span class="id" title="lemma">nth_error_mapi</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_ctors"><span class="id" title="definition">trans_ctors</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#nth_error_map"><span class="id" title="lemma">nth_error_map</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#nth_error_mapi"><span class="id" title="lemma">nth_error_mapi</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hc</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="inductive_isprop_and_pars_trans_env_dearg_env" class="idref" href="#inductive_isprop_and_pars_trans_env_dearg_env"><span class="id" title="lemma">inductive_isprop_and_pars_trans_env_dearg_env</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="13ac3e484f0856ad7bd5387b3129ec62" class="idref" href="#13ac3e484f0856ad7bd5387b3129ec62"><span class="id" title="binder">Σ</span></a> : <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#global_env"><span class="id" title="definition">global_env</span></a>) (<a id="ind:529" class="idref" href="#ind:529"><span class="id" title="binder">ind</span></a> : <a class="idref" href="MetaCoq.Common.Kernames.html#inductive"><span class="id" title="record">inductive</span></a>) (<a id="pars:530" class="idref" href="#pars:530"><span class="id" title="binder">pars</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#inductive_isprop_and_pars"><span class="id" title="definition">inductive_isprop_and_pars</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#13ac3e484f0856ad7bd5387b3129ec62"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:529"><span class="id" title="variable">ind</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#pars:530"><span class="id" title="variable">pars</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#inductive_isprop_and_pars"><span class="id" title="definition">inductive_isprop_and_pars</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_env"><span class="id" title="abbreviation">dearg_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#13ac3e484f0856ad7bd5387b3129ec62"><span class="id" title="variable">Σ</span></a>)) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:529"><span class="id" title="variable">ind</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearged_npars"><span class="id" title="definition">dearged_npars</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> (<a class="idref" href="MetaCoq.Common.Kernames.html#inductive_mind"><span class="id" title="projection">inductive_mind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:529"><span class="id" title="variable">ind</span></a>)) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#pars:530"><span class="id" title="variable">pars</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Σ</span> <span class="id" title="var">ind</span> <span class="id" title="var">pars</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#inductive_isprop_and_pars"><span class="id" title="definition">inductive_isprop_and_pars</span></a> <span class="id" title="tactic">in</span> *;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_env_trans_env"><span class="id" title="lemma">lookup_env_trans_env</span></a>, <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_env_dearg_env"><span class="id" title="lemma">lookup_env_dearg_env</span></a> <span class="id" title="tactic">in</span> *;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">g</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="MetaCoq.Utils.MCList.html#nth_error_map"><span class="id" title="lemma">nth_error_map</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_mib"><span class="id" title="definition">dearg_mib</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#nth_error_mapi"><span class="id" title="lemma">nth_error_mapi</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>;<span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;NOTE:&nbsp;there&nbsp;is&nbsp;a&nbsp;similar&nbsp;lemma&nbsp;in&nbsp;MetaCoq,&nbsp;but&nbsp;it's&nbsp;missing<br/>
&nbsp;&nbsp;&nbsp;the&nbsp;fact&nbsp;about&nbsp;arguments&nbsp;and&nbsp;the&nbsp;arity.&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <a id="eval_mkApps_Construct_inv'" class="idref" href="#eval_mkApps_Construct_inv'"><span class="id" title="lemma">eval_mkApps_Construct_inv'</span></a> {<a id="fl:531" class="idref" href="#fl:531"><span class="id" title="binder">fl</span></a> : <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">WcbvFlags</span></a>} <a id="5af8b4b176137ecf9b0a413e58ca9851" class="idref" href="#5af8b4b176137ecf9b0a413e58ca9851"><span class="id" title="binder">Σ</span></a> <a id="kn:533" class="idref" href="#kn:533"><span class="id" title="binder">kn</span></a> <a id="c:534" class="idref" href="#c:534"><span class="id" title="binder">c</span></a> <a id="args:535" class="idref" href="#args:535"><span class="id" title="binder">args</span></a> <a id="e:536" class="idref" href="#e:536"><span class="id" title="binder">e</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#with_constructor_as_block"><span class="id" title="method">with_constructor_as_block</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval"><span class="id" title="inductive">eval</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#5af8b4b176137ecf9b0a413e58ca9851"><span class="id" title="variable">Σ</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tConstruct"><span class="id" title="constructor">tConstruct</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#kn:533"><span class="id" title="variable">kn</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c:534"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:535"><span class="id" title="variable">args</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#e:536"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Utils.MCPrelude.html#cd4bc1b07c8b3bdc9f3bbc7941b56107"><span class="id" title="notation">∑</span></a> <a id="args':537" class="idref" href="#args':537"><span class="id" title="binder">args'</span></a> <a id="mdecl:538" class="idref" href="#mdecl:538"><span class="id" title="binder">mdecl</span></a> <a id="idecl:539" class="idref" href="#idecl:539"><span class="id" title="binder">idecl</span></a> <a id="cdecl:540" class="idref" href="#cdecl:540"><span class="id" title="binder">cdecl</span></a><a class="idref" href="MetaCoq.Utils.MCPrelude.html#cd4bc1b07c8b3bdc9f3bbc7941b56107"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Utils.MCProd.html#e1d373c00c5388a2c7aaca322473d464"><span class="id" title="notation">[×</span></a> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#lookup_constructor"><span class="id" title="definition">EGlobalEnv.lookup_constructor</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#5af8b4b176137ecf9b0a413e58ca9851"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#kn:533"><span class="id" title="variable">kn</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c:534"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mdecl:538"><span class="id" title="variable">mdecl</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#idecl:539"><span class="id" title="variable">idecl</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#cdecl:540"><span class="id" title="variable">cdecl</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="MetaCoq.Utils.MCProd.html#e1d373c00c5388a2c7aaca322473d464"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Utils.MCProd.html#e1d373c00c5388a2c7aaca322473d464"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:535"><span class="id" title="variable">args</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#cstr_arity"><span class="id" title="definition">cstr_arity</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mdecl:538"><span class="id" title="variable">mdecl</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#cdecl:540"><span class="id" title="variable">cdecl</span></a><a class="idref" href="MetaCoq.Utils.MCProd.html#e1d373c00c5388a2c7aaca322473d464"><span class="id" title="notation">),</span></a> <a class="idref" href="MetaCoq.Utils.MCProd.html#e1d373c00c5388a2c7aaca322473d464"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#e:536"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tConstruct"><span class="id" title="constructor">tConstruct</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#kn:533"><span class="id" title="variable">kn</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c:534"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args':537"><span class="id" title="variable">args'</span></a><a class="idref" href="MetaCoq.Utils.MCProd.html#e1d373c00c5388a2c7aaca322473d464"><span class="id" title="notation">)</span></a> <a class="idref" href="MetaCoq.Utils.MCProd.html#e1d373c00c5388a2c7aaca322473d464"><span class="id" title="notation">&amp;</span></a> <a class="idref" href="MetaCoq.Utils.All_Forall.html#All2"><span class="id" title="inductive">All2</span></a> (<a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval"><span class="id" title="inductive">eval</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#5af8b4b176137ecf9b0a413e58ca9851"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args:535"><span class="id" title="variable">args</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args':537"><span class="id" title="variable">args'</span></a><a class="idref" href="MetaCoq.Utils.MCProd.html#e1d373c00c5388a2c7aaca322473d464"><span class="id" title="notation">]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">hblock</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">e</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">args</span> <span class="id" title="keyword">using</span> <a class="idref" href="MetaCoq.Utils.MCList.html#rev_ind"><span class="id" title="lemma">rev_ind</span></a>; <span class="id" title="tactic">intros</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">ev</span>. <span class="id" title="var">depelim</span> <span class="id" title="var">ev</span>. <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.ssr.ssrbool.html#isSome"><span class="id" title="definition">isSome</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#lookup_constructor"><span class="id" title="definition">EGlobalEnv.lookup_constructor</span></a> <span class="id" title="var">Σ</span> <span class="id" title="var">kn</span> <span class="id" title="var">c</span>) <span class="id" title="keyword">as</span> [[[<span class="id" title="var">mdecl</span> <span class="id" title="var">idecl</span>] <span class="id" title="var">cdecl</span>] |] <span class="id" title="var">eqn</span>:<span class="id" title="var">Hlook</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">eexists</span>;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">eauto</span>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">ev</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.EAstUtils.html#mkApps_app"><span class="id" title="lemma">mkApps_app</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">depelim</span> <span class="id" title="var">ev</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>:<span class="id" title="tactic">try</span> <span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHargs</span> <span class="id" title="var">_</span> <span class="id" title="var">ev1</span>) <span class="id" title="keyword">as</span> [? [? [? [? [? ?]]]]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">solve_discr</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">noconf</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">∃</span> (<span class="id" title="var">x0</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="var">a'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>), <span class="id" title="var">x1</span>, <span class="id" title="var">x2</span>, <span class="id" title="var">x3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>;<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H</span> : <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">args</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">x0</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#All2_length"><span class="id" title="lemma">All2_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e1</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">e1</span>;<span class="id" title="tactic">subst</span>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.EAstUtils.html#mkApps_app"><span class="id" title="lemma">mkApps_app</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#All2_app"><span class="id" title="lemma">All2_app</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">subst</span> <span class="id" title="var">f'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.EAstUtils.html#isConstructApp_mkApps"><span class="id" title="lemma">isConstructApp_mkApps</span></a> <span class="id" title="tactic">in</span> *;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">i</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="dearg_branch_body_rec_dearg" class="idref" href="#dearg_branch_body_rec_dearg"><span class="id" title="lemma">dearg_branch_body_rec_dearg</span></a> <a id="n:541" class="idref" href="#n:541"><span class="id" title="binder">n</span></a> <a id="mask:542" class="idref" href="#mask:542"><span class="id" title="binder">mask</span></a> <a id="t:543" class="idref" href="#t:543"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:543"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_branch_body_rec"><span class="id" title="definition">dearg_branch_body_rec</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:541"><span class="id" title="variable">n</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:542"><span class="id" title="variable">mask</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:543"><span class="id" title="variable">t</span></a>)<a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">).2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_branch_body_rec"><span class="id" title="definition">dearg_branch_body_rec</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:541"><span class="id" title="variable">n</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask:542"><span class="id" title="variable">mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:543"><span class="id" title="variable">t</span></a><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">).2</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">n</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">mask</span>;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">intros</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;× <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_branch_body_rec"><span class="id" title="definition">dearg_branch_body_rec</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst1"><span class="id" title="definition">subst1</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="MetaCoq.Erasure.EAst.html#tBox"><span class="id" title="constructor">tBox</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="MetaCoq.Erasure.EAst.html#tBox"><span class="id" title="constructor">tBox</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_subst"><span class="id" title="lemma">dearg_subst</span></a>;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHmask</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_subst"><span class="id" title="lemma">valid_cases_subst</span></a>.<br/>
&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHmask</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="valid_dearg_mask_branch_last_true" class="idref" href="#valid_dearg_mask_branch_last_true"><span class="id" title="lemma">valid_dearg_mask_branch_last_true</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="m:544" class="idref" href="#m:544"><span class="id" title="binder">m</span></a> <a id="t0:545" class="idref" href="#t0:545"><span class="id" title="binder">t0</span></a> <a id="i:546" class="idref" href="#i:546"><span class="id" title="binder">i</span></a>, <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_dearg_mask_branch"><span class="id" title="definition">valid_dearg_mask_branch</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:546"><span class="id" title="variable">i</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#m:544"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t0:545"><span class="id" title="variable">t0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#m:544"><span class="id" title="variable">m</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:546"><span class="id" title="variable">i</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t0:545"><span class="id" title="variable">t0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_dearg_mask_branch"><span class="id" title="definition">valid_dearg_mask_branch</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:546"><span class="id" title="variable">i</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#m:544"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t0:545"><span class="id" title="variable">t0</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">m</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">m</span>;<span class="id" title="tactic">intros</span> <span class="id" title="var">t2</span> <span class="id" title="var">i</span> <span class="id" title="var">HH</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="var">propify</span>;<span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">m</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">i</span>)) <span class="id" title="keyword">with</span> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">m</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">i</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">HH</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">dead_t</span> <span class="id" title="var">valid_t</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="var">now</span> <span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHm</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">valid_t</span>) <span class="id" title="keyword">as</span> [??].<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="valid_dearg_mask_branch_last_false" class="idref" href="#valid_dearg_mask_branch_last_false"><span class="id" title="lemma">valid_dearg_mask_branch_last_false</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="m:547" class="idref" href="#m:547"><span class="id" title="binder">m</span></a> <a id="t0:548" class="idref" href="#t0:548"><span class="id" title="binder">t0</span></a> <a id="i:549" class="idref" href="#i:549"><span class="id" title="binder">i</span></a>, <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_dearg_mask_branch"><span class="id" title="definition">valid_dearg_mask_branch</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:549"><span class="id" title="variable">i</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#m:547"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t0:548"><span class="id" title="variable">t0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_dearg_mask_branch"><span class="id" title="definition">valid_dearg_mask_branch</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:549"><span class="id" title="variable">i</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#m:547"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t0:548"><span class="id" title="variable">t0</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">m</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">m</span>;<span class="id" title="tactic">intros</span> <span class="id" title="var">t2</span> <span class="id" title="var">i</span> <span class="id" title="var">HH</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="var">propify</span>;<span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="dearg_branch_body_rec_all_zeros" class="idref" href="#dearg_branch_body_rec_all_zeros"><span class="id" title="lemma">dearg_branch_body_rec_all_zeros</span></a> <a id="n:550" class="idref" href="#n:550"><span class="id" title="binder">n</span></a> <a id="t:551" class="idref" href="#t:551"><span class="id" title="binder">t</span></a> <a id="i:552" class="idref" href="#i:552"><span class="id" title="binder">i</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_branch_body_rec"><span class="id" title="definition">dearg_branch_body_rec</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:552"><span class="id" title="variable">i</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#repeat"><span class="id" title="definition">repeat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:550"><span class="id" title="variable">n</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:551"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:552"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:550"><span class="id" title="variable">n</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:551"><span class="id" title="variable">t</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.add_0_r"><span class="id" title="lemma">Nat.add_0_r</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">replace</span> (<span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">n</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">n</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="valid_dearg_mask_branch_all_zeros" class="idref" href="#valid_dearg_mask_branch_all_zeros"><span class="id" title="lemma">valid_dearg_mask_branch_all_zeros</span></a> <a id="i:553" class="idref" href="#i:553"><span class="id" title="binder">i</span></a> <a id="n:554" class="idref" href="#n:554"><span class="id" title="binder">n</span></a> <a id="t:555" class="idref" href="#t:555"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_dearg_mask_branch"><span class="id" title="definition">valid_dearg_mask_branch</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:553"><span class="id" title="variable">i</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#repeat"><span class="id" title="definition">repeat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:554"><span class="id" title="variable">n</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:555"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">intros</span>;<span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="valid_cases_dearg_branch_body_rec" class="idref" href="#valid_cases_dearg_branch_body_rec"><span class="id" title="lemma">valid_cases_dearg_branch_body_rec</span></a> <a id="m:556" class="idref" href="#m:556"><span class="id" title="binder">m</span></a> <a id="i:557" class="idref" href="#i:557"><span class="id" title="binder">i</span></a> <a id="br0:558" class="idref" href="#br0:558"><span class="id" title="binder">br0</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#br0:558"><span class="id" title="variable">br0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_branch_body_rec"><span class="id" title="definition">dearg_branch_body_rec</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:557"><span class="id" title="variable">i</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#m:556"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#br0:558"><span class="id" title="variable">br0</span></a><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">).2</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">i</span> <span class="id" title="var">br0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">m</span>;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">br0</span> <span class="id" title="var">Hvalid</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">IHm</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_subst"><span class="id" title="lemma">valid_cases_subst</span></a>.<br/>
&nbsp;&nbsp;+ <span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="Forall_masked" class="idref" href="#Forall_masked"><span class="id" title="lemma">Forall_masked</span></a> {<a id="A:559" class="idref" href="#A:559"><span class="id" title="binder">A</span></a>} <a id="m:560" class="idref" href="#m:560"><span class="id" title="binder">m</span></a> (<a id="l:561" class="idref" href="#l:561"><span class="id" title="binder">l</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#A:559"><span class="id" title="variable">A</span></a>) (<a id="P:562" class="idref" href="#P:562"><span class="id" title="binder">P</span></a> : <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#A:559"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#P:562"><span class="id" title="variable">P</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#l:561"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#P:562"><span class="id" title="variable">P</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#masked"><span class="id" title="definition">masked</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#m:560"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#l:561"><span class="id" title="variable">l</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">m</span>;<span class="id" title="tactic">intros</span> <span class="id" title="var">l</span> <span class="id" title="var">H</span>;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span>;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>;<span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="masked_all_zeros" class="idref" href="#masked_all_zeros"><span class="id" title="lemma">masked_all_zeros</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> {<a id="A:563" class="idref" href="#A:563"><span class="id" title="binder">A</span></a>} <a id="n:564" class="idref" href="#n:564"><span class="id" title="binder">n</span></a> (<a id="l:565" class="idref" href="#l:565"><span class="id" title="binder">l</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#A:563"><span class="id" title="variable">A</span></a>), <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#masked"><span class="id" title="definition">masked</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#repeat"><span class="id" title="definition">repeat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:564"><span class="id" title="variable">n</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#l:565"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#l:565"><span class="id" title="variable">l</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">A</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">k</span>;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span>;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHk</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="mask_last" class="idref" href="#mask_last"><span class="id" title="lemma">mask_last</span></a> : <span class="id" title="keyword">∀</span> {<a id="A:566" class="idref" href="#A:566"><span class="id" title="binder">A</span></a>} <a id="msk:567" class="idref" href="#msk:567"><span class="id" title="binder">msk</span></a> <a id="b:568" class="idref" href="#b:568"><span class="id" title="binder">b</span></a> (<a id="l:569" class="idref" href="#l:569"><span class="id" title="binder">l</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#A:566"><span class="id" title="variable">A</span></a>) (<a id="a:570" class="idref" href="#a:570"><span class="id" title="binder">a</span></a> : <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#A:566"><span class="id" title="variable">A</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#msk:567"><span class="id" title="variable">msk</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#l:569"><span class="id" title="variable">l</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#masked"><span class="id" title="definition">masked</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#msk:567"><span class="id" title="variable">msk</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#b:568"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>) (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#l:569"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#a:570"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#masked"><span class="id" title="definition">masked</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#msk:567"><span class="id" title="variable">msk</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#l:569"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <span class="id" title="keyword">if</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#b:568"><span class="id" title="variable">b</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <span class="id" title="keyword">else</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#a:570"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">msk</span>;<span class="id" title="tactic">intros</span> ??? <span class="id" title="var">H</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span>;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">f_equal</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="mask_rev" class="idref" href="#mask_rev"><span class="id" title="lemma">mask_rev</span></a> : <span class="id" title="keyword">∀</span> {<a id="A:571" class="idref" href="#A:571"><span class="id" title="binder">A</span></a>} <a id="msk:572" class="idref" href="#msk:572"><span class="id" title="binder">msk</span></a> (<a id="l0:573" class="idref" href="#l0:573"><span class="id" title="binder">l0</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#A:571"><span class="id" title="variable">A</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#msk:572"><span class="id" title="variable">msk</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#l0:573"><span class="id" title="variable">l0</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#rev"><span class="id" title="definition">List.rev</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#masked"><span class="id" title="definition">masked</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#msk:572"><span class="id" title="variable">msk</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#l0:573"><span class="id" title="variable">l0</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#masked"><span class="id" title="definition">masked</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#rev"><span class="id" title="definition">List.rev</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#msk:572"><span class="id" title="variable">msk</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#rev"><span class="id" title="definition">List.rev</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#l0:573"><span class="id" title="variable">l0</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">A</span> <span class="id" title="var">msk</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">msk</span>;<span class="id" title="tactic">intros</span> <span class="id" title="var">l0</span> <span class="id" title="var">Hl0</span>;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l0</span>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#masked_nil"><span class="id" title="lemma">masked_nil</span></a>.<br/>
&nbsp;&nbsp;× <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×. <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask_last"><span class="id" title="lemma">mask_last</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">now</span> <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#rev_length"><span class="id" title="lemma">List.rev_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>;<span class="id" title="var">cbn</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#app_nil_r"><span class="id" title="lemma">app_nil_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">f_equal</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="dearg_branch_body_rec_substl_correct" class="idref" href="#dearg_branch_body_rec_substl_correct"><span class="id" title="lemma">dearg_branch_body_rec_substl_correct</span></a> : <span class="id" title="keyword">∀</span> <a id="mm:574" class="idref" href="#mm:574"><span class="id" title="binder">mm</span></a> <a id="args0:575" class="idref" href="#args0:575"><span class="id" title="binder">args0</span></a> <a id="t:576" class="idref" href="#t:576"><span class="id" title="binder">t</span></a> <a id="ctx0:577" class="idref" href="#ctx0:577"><span class="id" title="binder">ctx0</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#forallb"><span class="id" title="definition">forallb</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">closedn</span></a> 0) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args0:575"><span class="id" title="variable">args0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mm:574"><span class="id" title="variable">mm</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args0:575"><span class="id" title="variable">args0</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args0:575"><span class="id" title="variable">args0</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ctx0:577"><span class="id" title="variable">ctx0</span></a><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_dearg_mask_branch"><span class="id" title="definition">valid_dearg_mask_branch</span></a> 0 (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#complete_ctx_mask"><span class="id" title="definition">complete_ctx_mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mm:574"><span class="id" title="variable">mm</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ctx0:577"><span class="id" title="variable">ctx0</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:576"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.ECSubst.html#substl"><span class="id" title="definition">substl</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#rev"><span class="id" title="definition">List.rev</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#masked"><span class="id" title="definition">masked</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mm:574"><span class="id" title="variable">mm</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args0:575"><span class="id" title="variable">args0</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_branch_body_rec"><span class="id" title="definition">dearg_branch_body_rec</span></a> 0 (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#complete_ctx_mask"><span class="id" title="definition">complete_ctx_mask</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mm:574"><span class="id" title="variable">mm</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ctx0:577"><span class="id" title="variable">ctx0</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:576"><span class="id" title="variable">t</span></a><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">).2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.ECSubst.html#substl"><span class="id" title="definition">substl</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#rev"><span class="id" title="definition">List.rev</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#args0:575"><span class="id" title="variable">args0</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:576"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">mm</span> <span class="id" title="var">args0</span> <span class="id" title="var">t</span> <span class="id" title="var">ctx0</span> <span class="id" title="var">Hc</span> <span class="id" title="var">Hlen</span> <span class="id" title="var">Hctx</span> <span class="id" title="var">Hv</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">args0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">ctx0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">mm</span>;<span class="id" title="tactic">simpl</span>;<span class="id" title="tactic">intros</span> <span class="id" title="var">ctx0</span> <span class="id" title="var">t</span> <span class="id" title="var">Hv</span> <span class="id" title="var">args0</span> <span class="id" title="var">Hc</span> <span class="id" title="var">Hlen</span> <span class="id" title="var">Hctx</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#complete_ctx_mask"><span class="id" title="definition">complete_ctx_mask</span></a>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#app_nil_r"><span class="id" title="lemma">app_nil_r</span></a>. <span class="id" title="tactic">replace</span> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">ctx0</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> 0) <span class="id" title="keyword">with</span> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">ctx0</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_branch_body_rec_all_zeros"><span class="id" title="lemma">dearg_branch_body_rec_all_zeros</span></a>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">args0</span>.<br/>
&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hlen</span>.<br/>
&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#complete_ctx_mask"><span class="id" title="definition">complete_ctx_mask</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hv</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#app_assoc"><span class="id" title="lemma">app_assoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_dearg_mask_branch_last_true"><span class="id" title="lemma">valid_dearg_mask_branch_last_true</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hv</span> <span class="id" title="keyword">as</span> [??].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ctx0</span>;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hctx</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hctx0</span>];<span class="id" title="tactic">clear</span> <span class="id" title="var">Hctx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hmm</span> : <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mm</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">args0</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">Hlen</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.ECSubst.html#substl"><span class="id" title="definition">substl</span></a>,<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_branch_body_rec"><span class="id" title="definition">dearg_branch_body_rec</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#app_assoc"><span class="id" title="lemma">app_assoc</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#fold_left_app"><span class="id" title="lemma">fold_left_app</span></a>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#repeat"><span class="id" title="definition">repeat</span></a> <span class="id" title="var">_</span> (<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a>?<span class="id" title="var">y</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <span class="id" title="var">_</span>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#rev"><span class="id" title="definition">List.rev</span></a> ?<span class="id" title="var">x</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#complete_ctx_mask"><span class="id" title="definition">complete_ctx_mask</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#fold_left"><span class="id" title="definition">fold_left</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>0<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">t</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">as</span> [<span class="id" title="var">n1</span> <span class="id" title="var">t1</span>] <span class="id" title="var">eqn</span>:<span class="id" title="var">Hfl</span>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#complete_ctx_mask"><span class="id" title="definition">complete_ctx_mask</span></a> <span class="id" title="var">mm</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ctx_mask</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#fold_left"><span class="id" title="definition">fold_left</span></a> <span class="id" title="var">_</span> ?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>0<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">t</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">with</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_branch_body_rec"><span class="id" title="definition">dearg_branch_body_rec</span></a> 0 <span class="id" title="var">x</span> <span class="id" title="var">t</span>) <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#fold_left_app"><span class="id" title="lemma">fold_left_app</span></a>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <span class="id" title="var">t1</span> <span class="id" title="keyword">with</span> <a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_branch_body_rec"><span class="id" title="definition">dearg_branch_body_rec</span></a> 0 <span class="id" title="var">ctx_mask</span> <span class="id" title="var">t</span><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">).2</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hfl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hn0</span> : <span class="id" title="var">n1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> <span class="id" title="var">ctx_mask</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">change</span> <span class="id" title="var">n1</span> <span class="id" title="keyword">with</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">n1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">t1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hfl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> <span class="id" title="var">ctx_mask</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> 0) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_branch_body_rec_count_zeros"><span class="id" title="lemma">dearg_branch_body_rec_count_zeros</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <span class="id" title="var">n1</span> <span class="id" title="keyword">with</span> (0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">n1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> 0) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hn0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst1"><span class="id" title="definition">subst1</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_branch_body_rec_subst"><span class="id" title="lemma">dearg_branch_body_rec_subst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.ECSubst.html#substl"><span class="id" title="definition">substl</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IHmm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hctx_mask</span> : <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">ctx_mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">ctx0</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#complete_ctx_mask_length"><span class="id" title="lemma">complete_ctx_mask_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hctx_mask</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHmm</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#fold_left"><span class="id" title="definition">fold_left</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">t</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="MetaCoq.Erasure.ECSubst.html#substl"><span class="id" title="definition">substl</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#rev"><span class="id" title="definition">List.rev</span></a> <span class="id" title="var">args0</span>) <span class="id" title="var">t</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.EOptimizePropDiscr.html#substl_subst"><span class="id" title="lemma">EOptimizePropDiscr.substl_subst</span></a> <span class="id" title="tactic">by</span> (<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#forallb_rev"><span class="id" title="lemma">forallb_rev</span></a>;<span class="id" title="tactic">assumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.ECSubst.html#subst_csubst_comm"><span class="id" title="lemma">subst_csubst_comm</span></a> <span class="id" title="tactic">by</span> (<span class="id" title="tactic">auto</span>;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#forallb_rev"><span class="id" title="lemma">forallb_rev</span></a>;<span class="id" title="tactic">assumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#rev_length"><span class="id" title="lemma">List.rev_length</span></a> <span class="id" title="tactic">in</span> ×.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hctx0</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.ECSubst.html#closed_subst"><span class="id" title="lemma">closed_subst</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">assumption</span>.<br/>
</div>

<div class="doc">
NOTE: here we use the fact that the the variable doesn't occur, that is <span class="inlinecode"><span class="id" title="var">is_dead</span></span> 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#no_use_subst"><span class="id" title="lemma">no_use_subst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_dearg_branch_subst"><span class="id" title="lemma">valid_dearg_branch_subst</span></a>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#complete_ctx_mask"><span class="id" title="definition">complete_ctx_mask</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hv</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#app_assoc"><span class="id" title="lemma">app_assoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_dearg_mask_branch_last_false"><span class="id" title="lemma">valid_dearg_mask_branch_last_false</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ctx0</span>;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hmm</span> : <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mm</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">args0</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">Hlen</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#complete_ctx_mask"><span class="id" title="definition">complete_ctx_mask</span></a>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.ECSubst.html#substl"><span class="id" title="definition">substl</span></a>,<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_branch_body_rec"><span class="id" title="definition">dearg_branch_body_rec</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#app_assoc"><span class="id" title="lemma">app_assoc</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#repeat"><span class="id" title="definition">repeat</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ctx_mask</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#fold_left_app"><span class="id" title="lemma">fold_left_app</span></a>;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#fold_left"><span class="id" title="definition">fold_left</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>0<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">t</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">as</span> [<span class="id" title="var">n1</span> <span class="id" title="var">t1</span>] <span class="id" title="var">eqn</span>:<span class="id" title="var">Hfl</span>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <span class="id" title="var">t1</span> <span class="id" title="keyword">with</span> <a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_branch_body_rec"><span class="id" title="definition">dearg_branch_body_rec</span></a> 0 <span class="id" title="var">ctx_mask</span> <span class="id" title="var">t</span><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">).2</span></a> <span class="id" title="tactic">by</span> (<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_branch_body_rec"><span class="id" title="definition">dearg_branch_body_rec</span></a>;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hfl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hn0</span> : <span class="id" title="var">n1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> <span class="id" title="var">ctx_mask</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">change</span> <span class="id" title="var">n1</span> <span class="id" title="keyword">with</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">n1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">t1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hfl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> <span class="id" title="var">ctx_mask</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> 0) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_branch_body_rec_count_zeros"><span class="id" title="lemma">dearg_branch_body_rec_count_zeros</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.ECSubst.html#substl"><span class="id" title="definition">substl</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IHmm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHmm</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="masked_weakening" class="idref" href="#masked_weakening"><span class="id" title="lemma">masked_weakening</span></a> : <span class="id" title="keyword">∀</span> {<a id="A:578" class="idref" href="#A:578"><span class="id" title="binder">A</span></a>} <a id="msk:579" class="idref" href="#msk:579"><span class="id" title="binder">msk</span></a> (<a id="l:580" class="idref" href="#l:580"><span class="id" title="binder">l</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#A:578"><span class="id" title="variable">A</span></a>) <a id="n:581" class="idref" href="#n:581"><span class="id" title="binder">n</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#masked"><span class="id" title="definition">masked</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#msk:579"><span class="id" title="variable">msk</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#l:580"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#masked"><span class="id" title="definition">masked</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#msk:579"><span class="id" title="variable">msk</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#repeat"><span class="id" title="definition">repeat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:581"><span class="id" title="variable">n</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#l:580"><span class="id" title="variable">l</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? <span class="id" title="var">msk</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">msk</span>;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#masked_all_zeros"><span class="id" title="lemma">masked_all_zeros</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span>;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">f_equal</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="Forall_closed_repeat_tBox" class="idref" href="#Forall_closed_repeat_tBox"><span class="id" title="lemma">Forall_closed_repeat_tBox</span></a> <a id="n:582" class="idref" href="#n:582"><span class="id" title="binder">n</span></a> <a id="k:583" class="idref" href="#k:583"><span class="id" title="binder">k</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">closedn</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#k:583"><span class="id" title="variable">k</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#repeat"><span class="id" title="definition">repeat</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#tBox"><span class="id" title="constructor">tBox</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:582"><span class="id" title="variable">n</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="dearg_repeat_tBox" class="idref" href="#dearg_repeat_tBox"><span class="id" title="lemma">dearg_repeat_tBox</span></a> : <span class="id" title="keyword">∀</span> <a id="n:584" class="idref" href="#n:584"><span class="id" title="binder">n</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#repeat"><span class="id" title="definition">repeat</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#tBox"><span class="id" title="constructor">tBox</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:584"><span class="id" title="variable">n</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#repeat"><span class="id" title="definition">repeat</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#tBox"><span class="id" title="constructor">tBox</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:584"><span class="id" title="variable">n</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n1</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">n1</span>;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">f_equal</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Forall_repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Forall_forallb</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Forall_rev</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Forall_masked</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Forall_skipn</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">valid_cases_dearg_branch_body_rec</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">valid_dearg_mask_branch_dearg</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Forall_closed_repeat_tBox</span> : <span class="id" title="var">dearg</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">simpl_length</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#length"><span class="id" title="abbreviation">List.length</span></a> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <span class="id" title="var">_</span>) ] ⇒ <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#length"><span class="id" title="abbreviation">List.length</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#repeat"><span class="id" title="definition">repeat</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ] ⇒ <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#repeat_length"><span class="id" title="lemma">repeat_length</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#length"><span class="id" title="abbreviation">List.length</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#skipn"><span class="id" title="definition">skipn</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ] ⇒ <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#skipn_length"><span class="id" title="lemma">skipn_length</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#length"><span class="id" title="abbreviation">List.length</span></a> (<a class="idref" href="MetaCoq.Utils.MCList.html#rev"><span class="id" title="definition">rev</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ] ⇒ <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#rev_length"><span class="id" title="lemma">rev_length</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#length"><span class="id" title="abbreviation">List.length</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#rev"><span class="id" title="definition">List.rev</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ] ⇒ <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#rev_length"><span class="id" title="lemma">List.rev_length</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#length"><span class="id" title="abbreviation">List.length</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ] ⇒ <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="dearg_correct" class="idref" href="#dearg_correct"><span class="id" title="lemma">dearg_correct</span></a> {<a id="wfl:585" class="idref" href="#wfl:585"><span class="id" title="binder">wfl</span></a> : <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">WcbvFlags</span></a>} <a id="0d51a7e8f6749027b2c50a573d234b8f" class="idref" href="#0d51a7e8f6749027b2c50a573d234b8f"><span class="id" title="binder">Σ</span></a> <a id="t:587" class="idref" href="#t:587"><span class="id" title="binder">t</span></a> <a id="v:588" class="idref" href="#v:588"><span class="id" title="binder">v</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#with_constructor_as_block"><span class="id" title="method">with_constructor_as_block</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.ClosedAux.html#env_closed"><span class="id" title="definition">env_closed</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#0d51a7e8f6749027b2c50a573d234b8f"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">closed</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:587"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_masks_env"><span class="id" title="abbreviation">valid_masks_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#0d51a7e8f6749027b2c50a573d234b8f"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:587"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_env"><span class="id" title="abbreviation">is_expanded_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#0d51a7e8f6749027b2c50a573d234b8f"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:587"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#0d51a7e8f6749027b2c50a573d234b8f"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">e</span></a><a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⊢</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:587"><span class="id" title="variable">t</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⇓</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#v:588"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_env"><span class="id" title="abbreviation">dearg_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#0d51a7e8f6749027b2c50a573d234b8f"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">e</span></a><a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⊢</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:587"><span class="id" title="variable">t</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⇓</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#v:588"><span class="id" title="variable">v</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">block</span> <span class="id" title="var">clos_env</span> <span class="id" title="var">clos_t</span> <span class="id" title="var">valid_env</span> <span class="id" title="var">valid_t</span> <span class="id" title="var">exp_env</span> <span class="id" title="var">exp_t</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">enough</span> (<span class="id" title="keyword">∀</span> <a id="n:591" class="idref" href="#n:591"><span class="id" title="binder">n</span></a> (<a id="ev:592" class="idref" href="#ev:592"><span class="id" title="binder">ev</span></a> : <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <span class="id" title="var">Σ</span> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">e</span></a><a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⊢</span></a> <span class="id" title="var">t</span> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⇓</span></a> <span class="id" title="var">v</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#deriv_length"><span class="id" title="definition">deriv_length</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ev:590"><span class="id" title="variable">ev</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:589"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_env"><span class="id" title="abbreviation">dearg_env</span></a> <span class="id" title="var">Σ</span>) <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">e</span></a><a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⊢</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">t</span> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⇓</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">v</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">ev</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<span class="id" title="var">H</span> <span class="id" title="var">_</span> <span class="id" title="var">ev</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.le_refl"><span class="id" title="lemma">Nat.le_refl</span></a>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">IH</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">t</span>, <span class="id" title="var">v</span>, <span class="id" title="var">clos_t</span>, <span class="id" title="var">valid_t</span>, <span class="id" title="var">exp_t</span> |- *; <span class="id" title="tactic">intros</span> <span class="id" title="var">ev</span> <span class="id" title="var">deriv_len</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">now</span> <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#deriv_length_min"><span class="id" title="lemma">deriv_length_min</span></a> <span class="id" title="var">ev</span>). }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_elim"><span class="id" title="lemma">dearg_elim</span></a> <span class="id" title="var">t</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_mkApps_inv"><span class="id" title="lemma">is_expanded_aux_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">exp_t</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">exp_hd</span> &amp; <span class="id" title="var">exp_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_single_masked"><span class="id" title="lemma">dearg_single_masked</span></a> <span class="id" title="tactic">by</span> (<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#eval_mkApps_deriv"><span class="id" title="lemma">eval_mkApps_deriv</span></a> <span class="id" title="var">ev</span>) <span class="id" title="keyword">as</span> (? &amp; <span class="id" title="var">ev_const</span> &amp; <span class="id" title="var">argsv</span> &amp; <span class="id" title="var">ev_args</span> &amp; <span class="id" title="var">deriv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">depelim</span> <span class="id" title="var">ev_const</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#declared_constant_dearg"><span class="id" title="lemma">declared_constant_dearg</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">isdecl</span> <span class="id" title="keyword">as</span> <span class="id" title="var">isdecl_dearg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">isdecl_dearg</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">cst_dearg</span> &amp; <span class="id" title="var">decl_dearg</span> &amp; <span class="id" title="var">body_dearg</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">body_dearg</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">enough</span> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_env"><span class="id" title="abbreviation">dearg_env</span></a> <span class="id" title="var">Σ</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">e</span></a><a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⊢</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_lambdas"><span class="id" title="definition">dearg_lambdas</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#get_const_mask"><span class="id" title="abbreviation">get_const_mask</span></a> <span class="id" title="var">kn</span>) <span class="id" title="var">body</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#masked"><span class="id" title="definition">masked</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#get_const_mask"><span class="id" title="abbreviation">get_const_mask</span></a> <span class="id" title="var">kn</span>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">args</span>)) <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⇓</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">v</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ev'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#eval_mkApps_head"><span class="id" title="lemma">eval_mkApps_head</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev'</span> <span class="id" title="keyword">as</span> <span class="id" title="var">ev_hd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ev_hd</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">hdv</span> &amp; <span class="id" title="var">ev_hd</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#eval_mkApps_heads"><span class="id" title="lemma">eval_mkApps_heads</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3: <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">econstructor</span>; <span class="id" title="var">eassumption</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_dearg_lambdas"><span class="id" title="lemma">dearg_dearg_lambdas</span></a> <span class="id" title="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eauto</span> <span class="id" title="keyword">using</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_dearg_mask_constant"><span class="id" title="lemma">valid_dearg_mask_constant</span></a>, <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_constant"><span class="id" title="lemma">valid_cases_constant</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Utils.MCPrelude.html#cd4bc1b07c8b3bdc9f3bbc7941b56107"><span class="id" title="notation">∑</span></a> <a id="ev':594" class="idref" href="#ev':594"><span class="id" title="binder">ev'</span></a> : <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <span class="id" title="var">Σ</span> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">e</span></a><a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⊢</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <span class="id" title="var">body</span> <span class="id" title="var">args</span> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⇓</span></a> <span class="id" title="var">v</span><a class="idref" href="MetaCoq.Utils.MCPrelude.html#cd4bc1b07c8b3bdc9f3bbc7941b56107"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#deriv_length"><span class="id" title="definition">deriv_length</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ev':593"><span class="id" title="variable">ev'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#deriv_length"><span class="id" title="definition">deriv_length</span></a> <span class="id" title="var">ev</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">ev_body</span> &amp; <span class="id" title="var">deriv_body</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">unshelve</span> <span class="id" title="var">epose</span> <span class="id" title="var">proof</span> (<a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#eval_mkApps_heads_deriv"><span class="id" title="lemma">eval_mkApps_heads_deriv</span></a> <span class="id" title="var">_</span> <span class="id" title="var">ev_const</span> <span class="id" title="var">ev</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">ev'</span> &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">∃</span> <span class="id" title="var">ev'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_lambdas_correct"><span class="id" title="lemma">dearg_lambdas_correct</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#env_closed_dearg"><span class="id" title="lemma">env_closed_dearg</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#closedn_dearg_aux"><span class="id" title="lemma">closedn_dearg_aux</span></a>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#closed_constant"><span class="id" title="lemma">closed_constant</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#Forall_map"><span class="id" title="lemma">Forall_map</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.ClosedAux.html#closed_mkApps_inv"><span class="id" title="lemma">closed_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_t</span> <span class="id" title="keyword">as</span> (? &amp; <span class="id" title="var">clos_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#Forall_impl"><span class="id" title="lemma">Forall_impl</span></a>; [<span class="id" title="tactic">exact</span> <span class="id" title="var">clos_args</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#closedn_dearg_aux"><span class="id" title="lemma">closedn_dearg_aux</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_dearg_mask_dearg_aux"><span class="id" title="lemma">valid_dearg_mask_dearg_aux</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_dearg_mask_constant"><span class="id" title="lemma">valid_dearg_mask_constant</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#eval_mkApps_dearg"><span class="id" title="lemma">eval_mkApps_dearg</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6: <span class="id" title="tactic">exact</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#closed_constant"><span class="id" title="lemma">closed_constant</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_constant"><span class="id" title="lemma">valid_cases_constant</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_constant"><span class="id" title="lemma">is_expanded_constant</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.ClosedAux.html#closed_mkApps_inv"><span class="id" title="lemma">closed_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_mkApps_inv"><span class="id" title="lemma">valid_cases_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">lia</span>.<br/>

<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">specialize</span> (<a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#eval_mkApps_deriv"><span class="id" title="lemma">eval_mkApps_deriv</span></a> <span class="id" title="var">ev</span>) <span class="id" title="keyword">as</span> (? &amp; <span class="id" title="var">ev_constr</span> &amp; <span class="id" title="var">argsv</span> &amp; <span class="id" title="var">ev_args</span> &amp; <span class="id" title="var">deriv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_mkApps_inv"><span class="id" title="lemma">valid_cases_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_t</span> <span class="id" title="keyword">as</span> (? &amp; <span class="id" title="var">valid_apps</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;NOTE:&nbsp;we&nbsp;use&nbsp;validity&nbsp;of&nbsp;cases&nbsp;to&nbsp;ensure&nbsp;that&nbsp;the&nbsp;block&nbsp;constructor&nbsp;argument&nbsp;is&nbsp;an&nbsp;empty&nbsp;list&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">args0</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#eval_mkApps_Construct_inv'"><span class="id" title="lemma">eval_mkApps_Construct_inv'</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev</span> <span class="id" title="keyword">as</span> <span class="id" title="var">ev_c</span>;<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ev_c</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">argsv'</span> &amp; <span class="id" title="var">mdecl</span> &amp; <span class="id" title="var">idecl</span> &amp; <span class="id" title="var">cdecl</span> &amp; [<span class="id" title="var">ctor_look</span> <span class="id" title="var">Heq</span> <span class="id" title="var">ev_args'</span> <span class="id" title="var">a</span>]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">argsv'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">argsv</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_deterministic_all"><span class="id" title="lemma">eval_deterministic_all</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_mkApps"><span class="id" title="lemma">dearg_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#All2_length"><span class="id" title="lemma">All2_length</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev_args</span> <span class="id" title="keyword">as</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_mkApps_inv"><span class="id" title="lemma">is_expanded_aux_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">exp_t</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">exp_hd</span> &amp; <span class="id" title="var">exp_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> -[<span class="id" title="var">EGlobalEnv.lookup_constructor</span>] <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_single_masked"><span class="id" title="lemma">dearg_single_masked</span></a> <span class="id" title="tactic">by</span> (<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">ev_args_dearg</span> : <a class="idref" href="MetaCoq.Utils.All_Forall.html#All2"><span class="id" title="inductive">All2</span></a> (<a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval"><span class="id" title="inductive">eval</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_env"><span class="id" title="abbreviation">dearg_env</span></a> <span class="id" title="var">Σ</span>))) (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">args</span>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">argsv</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">assert</span> (<span class="id" title="var">all_smaller</span> : <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#sum_deriv_lengths"><span class="id" title="definition">sum_deriv_lengths</span></a> <span class="id" title="var">ev_args</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#deriv_length_min"><span class="id" title="lemma">deriv_length_min</span></a> <span class="id" title="var">ev_constr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.ClosedAux.html#closed_mkApps_inv"><span class="id" title="lemma">closed_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_t</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">_</span> &amp; <span class="id" title="var">clos_apps</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> -<span class="id" title="var">clos_apps</span> <span class="id" title="var">valid_apps</span> <span class="id" title="var">exp_args</span> <span class="id" title="var">IH</span> <span class="id" title="var">ev_args</span> <span class="id" title="var">all_smaller</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">ev_args</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">unshelve</span> <span class="id" title="var">epose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">IHev_args</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ev_suf</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="var">depelim</span> <span class="id" title="var">clos_apps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="var">depelim</span> <span class="id" title="var">valid_apps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="var">depelim</span> <span class="id" title="var">exp_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">unshelve</span> <span class="id" title="var">epose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">IH</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">r</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ev_dearg</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="var">depelim</span> <span class="id" title="var">clos_apps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="var">depelim</span> <span class="id" title="var">valid_apps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="var">depelim</span> <span class="id" title="var">exp_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">lia</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_ctor_trans_env"><span class="id" title="lemma">lookup_ctor_trans_env</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ctor_look</span> <span class="id" title="keyword">as</span> <span class="id" title="var">e0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">e0</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">mib</span> &amp; <span class="id" title="var">oib</span> &amp; <span class="id" title="var">ctor</span> &amp; <span class="id" title="var">Hc</span> &amp; <span class="id" title="var">Hmib</span> &amp; <span class="id" title="var">Hoib</span> &amp; <span class="id" title="var">Hctor</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">decl_ind</span> :<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#declared_inductive"><span class="id" title="definition">declared_inductive</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <span class="id" title="var">Σ</span>) <span class="id" title="var">ind</span> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_mib"><span class="id" title="definition">trans_mib</span></a> <span class="id" title="var">mib</span>) (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_oib"><span class="id" title="definition">trans_oib</span></a> <span class="id" title="var">oib</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#declared_inductive"><span class="id" title="definition">declared_inductive</span></a>,<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#declared_minductive"><span class="id" title="definition">declared_minductive</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_ctor_lookup_env"><span class="id" title="lemma">lookup_ctor_lookup_env</span></a>;<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_ctor_lookup_env"><span class="id" title="lemma">lookup_ctor_lookup_env</span></a>;<span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">ctor_look</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_ind_mask_inductive"><span class="id" title="lemma">valid_ind_mask_inductive</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">valid_env</span> <span class="id" title="var">decl_ind</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">mask</span> [<span class="id" title="var">Hmask</span> <span class="id" title="var">Hparams</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_mib"><span class="id" title="definition">trans_mib</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_mib"><span class="id" title="definition">dearg_mib</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a> (<a class="idref" href="MetaCoq.Common.Kernames.html#inductive_mind"><span class="id" title="projection">inductive_mind</span></a> <span class="id" title="var">ind</span>) <span class="id" title="var">mib</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">mib_dearg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_oib"><span class="id" title="definition">trans_oib</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_oib"><span class="id" title="definition">dearg_oib</span></a> <span class="id" title="var">mask</span> (<a class="idref" href="MetaCoq.Common.Kernames.html#inductive_ind"><span class="id" title="projection">inductive_ind</span></a> <span class="id" title="var">ind</span>) <span class="id" title="var">oib</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">oib_dearg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_ctor"><span class="id" title="definition">dearg_ctor</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#param_mask"><span class="id" title="projection">param_mask</span></a> <span class="id" title="var">mask</span>) (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#get_branch_mask"><span class="id" title="definition">get_branch_mask</span></a> <span class="id" title="var">mask</span> (<a class="idref" href="MetaCoq.Common.Kernames.html#inductive_ind"><span class="id" title="projection">inductive_ind</span></a> <span class="id" title="var">ind</span>) <span class="id" title="var">c</span>) <span class="id" title="var">ctor</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ctor_dearg</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#eval_mkApps_tConstruct"><span class="id" title="lemma">eval_mkApps_tConstruct</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">mib_dearg</span> <span class="id" title="var">oib_dearg</span> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkConstructor"><span class="id" title="constructor">mkConstructor</span></a> <span class="id" title="var">ctor_dearg</span><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1.1</span></a> <span class="id" title="var">ctor_dearg</span><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a>));<span class="id" title="tactic">eauto</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#All2_masked"><span class="id" title="lemma">All2_masked</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_ctor_trans_env_inv"><span class="id" title="lemma">lookup_ctor_trans_env_inv</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_ctor_dearg"><span class="id" title="lemma">lookup_ctor_dearg</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_mib"><span class="id" title="definition">trans_mib</span></a>,<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_mib"><span class="id" title="definition">dearg_mib</span></a>, <a class="idref" href="MetaCoq.Erasure.EAst.html#cstr_arity"><span class="id" title="definition">cstr_arity</span></a> <span class="id" title="tactic">in</span> *;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hparams</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#masked_count_zeros"><span class="id" title="lemma">masked_count_zeros</span></a> <span class="id" title="tactic">in</span> × <span class="id" title="tactic">by</span> (<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>;<span class="id" title="var">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#count_zeros_le"><span class="id" title="lemma">count_zeros_le</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#param_mask"><span class="id" title="projection">param_mask</span></a> <span class="id" title="var">mask</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">get_ctor_mask</span>, <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_ctor"><span class="id" title="definition">dearg_ctor</span></a> <span class="id" title="tactic">in</span> ×. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hmask</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ctor</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">p0</span>]. <span class="id" title="tactic">destruct</span> <span class="id" title="var">p0</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#count_zeros_distr_app"><span class="id" title="lemma">count_zeros_distr_app</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#get_branch_mask"><span class="id" title="definition">get_branch_mask</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">bm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> <span class="id" title="var">bm</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">bm</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#count_zeros_le"><span class="id" title="lemma">count_zeros_le</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> <span class="id" title="var">bm</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_ones"><span class="id" title="definition">count_ones</span></a> <span class="id" title="var">bm</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">bm</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> ) <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#count_ones_zeros"><span class="id" title="lemma">count_ones_zeros</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.ClosedAux.html#closed_mkApps_inv"><span class="id" title="lemma">closed_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_t</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">clos_t</span> &amp; <span class="id" title="var">clos_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_mkApps_inv"><span class="id" title="lemma">valid_cases_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_t</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">valid_t</span> &amp; <span class="id" title="var">valid_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_mkApps_inv"><span class="id" title="lemma">is_expanded_aux_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">exp_t</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">exp_hd</span> &amp; <span class="id" title="var">exp_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#eval_mkApps_dearg_reduce"><span class="id" title="lemma">eval_mkApps_dearg_reduce</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;6: <span class="id" title="tactic">exact</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> →.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>; <span class="id" title="var">refold'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">clos_t</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">clos_discr</span> &amp; <span class="id" title="var">clos_brs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">valid_t</span> <span class="id" title="keyword">as</span> ((<span class="id" title="var">valid_discr</span> &amp; <span class="id" title="var">valid_brs</span>) &amp; <span class="id" title="var">valid_brs_masks</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">exp_hd</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">exp_discr</span> &amp; <span class="id" title="var">exp_brs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">dearg_case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;We&nbsp;need&nbsp;induction&nbsp;as&nbsp;casing&nbsp;on&nbsp;a&nbsp;cofix&nbsp;involves&nbsp;casing&nbsp;on&nbsp;whatever&nbsp;it&nbsp;evaluates&nbsp;to&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">depind</span> <span class="id" title="var">ev</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Normal&nbsp;pattern&nbsp;match&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">IHev1</span> <span class="id" title="var">IHev2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">clos_args</span> <span class="id" title="var">valid_args</span> <span class="id" title="var">exp_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">invert_facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> <span class="id" title="var">e1</span> <span class="id" title="keyword">as</span> <span class="id" title="var">ee</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#constructor_isprop_pars_decl"><span class="id" title="definition">constructor_isprop_pars_decl</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e1</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_env_trans_env"><span class="id" title="lemma">lookup_env_trans_env</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">g</span>|]<span class="id" title="var">eqn</span>:<span class="id" title="var">Hg</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">g</span> <span class="id" title="keyword">as</span> [ | <span class="id" title="var">mib</span> |] <span class="id" title="var">eqn</span>:<span class="id" title="var">Hmib</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#nth_error_map"><span class="id" title="lemma">nth_error_map</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="keyword">as</span> [<span class="id" title="var">oib</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">Hoib</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">c</span>);<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">e1</span>;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">decl_ind</span> :<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#declared_inductive"><span class="id" title="definition">declared_inductive</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <span class="id" title="var">Σ</span>) <span class="id" title="var">ind</span> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_mib"><span class="id" title="definition">trans_mib</span></a> <span class="id" title="var">mib</span>) (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_oib"><span class="id" title="definition">trans_oib</span></a> <span class="id" title="var">oib</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#declared_inductive"><span class="id" title="definition">declared_inductive</span></a>,<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#declared_minductive"><span class="id" title="definition">declared_minductive</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_env_trans_env"><span class="id" title="lemma">lookup_env_trans_env</span></a>. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_mib"><span class="id" title="definition">trans_mib</span></a>;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#nth_error_map"><span class="id" title="lemma">nth_error_map</span></a>. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hoib</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_ind_mask_inductive"><span class="id" title="lemma">valid_ind_mask_inductive</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">valid_env</span> <span class="id" title="var">decl_ind</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">mask</span> [<span class="id" title="var">Hmask</span> <span class="id" title="var">Hparams</span>]].<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_case_branch"><span class="id" title="definition">dearg_case_branch</span></a> <span class="id" title="var">mask</span> <span class="id" title="var">ind</span> <span class="id" title="var">c</span> (<a class="idref" href="MetaCoq.Utils.MCProd.html#on_snd"><span class="id" title="definition">on_snd</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">br</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">br_dearg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_iota"><span class="id" title="constructor">eval_iota</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">c</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#masked"><span class="id" title="definition">masked</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#get_ctor_mask"><span class="id" title="abbreviation">get_ctor_mask</span></a> <span class="id" title="var">ind</span> <span class="id" title="var">c</span>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">args</span>)) <span class="id" title="var">_</span> <span class="id" title="var">br_dearg</span>);<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">unshelve</span> <span class="id" title="var">epose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">IH</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev1</span> <span class="id" title="var">_</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_mkApps"><span class="id" title="lemma">dearg_mkApps</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_single_masked"><span class="id" title="lemma">dearg_single_masked</span></a> <span class="id" title="tactic">in</span> × <span class="id" title="tactic">by</span> (<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#constructor_isprop_pars_decl_trans_env_dearg_env"><span class="id" title="lemma">constructor_isprop_pars_decl_trans_env_dearg_env</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_case_branches"><span class="id" title="definition">dearg_case_branches</span></a>,<span class="id" title="var">valid_case_masks</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hmask</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_case_branch"><span class="id" title="definition">dearg_case_branch</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#nth_error_mapi"><span class="id" title="lemma">nth_error_mapi</span></a>, <a class="idref" href="MetaCoq.Utils.MCList.html#nth_error_map"><span class="id" title="lemma">nth_error_map</span></a>, <span class="id" title="var">e2</span>;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_ctors"><span class="id" title="definition">trans_ctors</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearged_npars"><span class="id" title="definition">dearged_npars</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">get_ctor_mask</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">valid_case_masks</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hmask</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">valid_brs_masks</span> <span class="id" title="keyword">as</span> [? <span class="id" title="var">Hall</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#alli_Alli"><span class="id" title="lemma">alli_Alli</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaCoq.Utils.All_Forall.html#Alli_nth_error"><span class="id" title="lemma">Alli_nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hall</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">e2</span>;<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">br</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">ctx</span> <span class="id" title="var">br</span>];<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">e2</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">bm_ctx</span> <span class="id" title="var">valid_bm</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#skipn_length"><span class="id" title="lemma">skipn_length</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#masked_count_zeros"><span class="id" title="lemma">masked_count_zeros</span></a> <span class="id" title="tactic">by</span> (<span class="id" title="var">simpl_length</span>;<span class="id" title="var">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">get_ctor_mask</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#count_zeros_distr_app"><span class="id" title="lemma">count_zeros_distr_app</span></a>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#get_branch_mask"><span class="id" title="definition">get_branch_mask</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">bm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> <span class="id" title="var">bm</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">bm</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#count_zeros_le"><span class="id" title="lemma">count_zeros_le</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> <span class="id" title="var">bm</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_ones"><span class="id" title="definition">count_ones</span></a> <span class="id" title="var">bm</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">bm</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> ) <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#count_ones_zeros"><span class="id" title="lemma">count_ones_zeros</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#skipn_length"><span class="id" title="lemma">skipn_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">valid_case_masks</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hmask</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">valid_brs_masks</span> <span class="id" title="keyword">as</span> [? <span class="id" title="var">Hall</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#alli_Alli"><span class="id" title="lemma">alli_Alli</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaCoq.Utils.All_Forall.html#Alli_nth_error"><span class="id" title="lemma">Alli_nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hall</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">e2</span>;<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">br</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">ctx</span> <span class="id" title="var">br</span>];<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#is_true"><span class="id" title="definition">is_true</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Bool.Bool.html#andb_true_iff"><span class="id" title="lemma">andb_true_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">e2</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">bm_ctx</span> <span class="id" title="var">valid_bm</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_case_branch"><span class="id" title="definition">dearg_case_branch</span></a> <span class="id" title="tactic">in</span> *;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">br_dearg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">bm_ctx</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">get_ctor_mask</span>, <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_ctor"><span class="id" title="definition">dearg_ctor</span></a> <span class="id" title="tactic">in</span> ×. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hmask</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#masked_count_zeros"><span class="id" title="lemma">masked_count_zeros</span></a> <span class="id" title="tactic">by</span> (<span class="id" title="var">simpl_length</span>;<span class="id" title="var">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#get_branch_mask"><span class="id" title="definition">get_branch_mask</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">bm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#count_zeros_distr_app"><span class="id" title="lemma">count_zeros_distr_app</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#complete_ctx_mask"><span class="id" title="definition">complete_ctx_mask</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">mm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hmm</span> : <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mm</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">ctx</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>;<span class="id" title="var">propify</span>;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#complete_ctx_mask_length"><span class="id" title="lemma">complete_ctx_mask_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#masked_count_zeros"><span class="id" title="lemma">masked_count_zeros</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">mm</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hmm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#complete_ctx_mask"><span class="id" title="definition">complete_ctx_mask</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#count_zeros_distr_app"><span class="id" title="lemma">count_zeros_distr_app</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#count_zeros_rev"><span class="id" title="lemma">count_zeros_rev</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#count_zeros_repeat"><span class="id" title="lemma">count_zeros_repeat</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#skipn_length"><span class="id" title="lemma">skipn_length</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e4</span>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">get_ctor_mask</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hmask</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#iota_red"><span class="id" title="definition">iota_red</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#skipn"><span class="id" title="definition">skipn</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#param_mask"><span class="id" title="projection">param_mask</span></a> <span class="id" title="var">mask</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#masked"><span class="id" title="definition">masked</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#param_mask"><span class="id" title="projection">param_mask</span></a> <span class="id" title="var">mask</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#get_branch_mask"><span class="id" title="definition">get_branch_mask</span></a> <span class="id" title="var">mask</span> (<a class="idref" href="MetaCoq.Common.Kernames.html#inductive_ind"><span class="id" title="projection">inductive_ind</span></a> <span class="id" title="var">ind</span>) <span class="id" title="var">c</span>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">args</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#masked"><span class="id" title="definition">masked</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#get_branch_mask"><span class="id" title="definition">get_branch_mask</span></a> <span class="id" title="var">mask</span> (<a class="idref" href="MetaCoq.Common.Kernames.html#inductive_ind"><span class="id" title="projection">inductive_ind</span></a> <span class="id" title="var">ind</span>) <span class="id" title="var">c</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#skipn"><span class="id" title="definition">skipn</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#param_mask"><span class="id" title="projection">param_mask</span></a> <span class="id" title="var">mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">args</span>))); <span class="id" title="var">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#get_branch_mask"><span class="id" title="definition">get_branch_mask</span></a> <span class="id" title="var">mask</span> (<a class="idref" href="MetaCoq.Common.Kernames.html#inductive_ind"><span class="id" title="projection">inductive_ind</span></a> <span class="id" title="var">ind</span>) <span class="id" title="var">c</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">m2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">args</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#param_mask"><span class="id" title="projection">param_mask</span></a> <span class="id" title="var">mask</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">m1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">m1</span> <span class="id" title="var">ts</span> <span class="id" title="var">m2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">m1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ts</span>, <span class="id" title="var">m2</span> |- *; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> !<a class="idref" href="MetaCoq.Utils.MCList.html#skipn_0"><span class="id" title="lemma">skipn_0</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">ts</span>; [<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> !<a class="idref" href="MetaCoq.Utils.MCList.html#skipn_nil"><span class="id" title="lemma">skipn_nil</span></a>, !<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#masked_nil"><span class="id" title="lemma">masked_nil</span></a>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#skipn_S"><span class="id" title="lemma">skipn_S</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHm1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">ts</span>; [<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> !<a class="idref" href="MetaCoq.Utils.MCList.html#skipn_nil"><span class="id" title="lemma">skipn_nil</span></a>, !<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#masked_nil"><span class="id" title="lemma">masked_nil</span></a>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="MetaCoq.Utils.MCList.html#skipn_S"><span class="id" title="lemma">skipn_S</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHm1</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#skipn_map"><span class="id" title="lemma">skipn_map</span></a>, <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#masked_map"><span class="id" title="lemma">masked_map</span></a>, &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_rev"><span class="id" title="lemma">map_rev</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">br_dearg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_case_branch"><span class="id" title="definition">dearg_case_branch</span></a>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">valid_case_masks</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hmask</span> <span class="id" title="tactic">in</span>×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">valid_brs_masks</span> <span class="id" title="keyword">as</span> [? <span class="id" title="var">Hall</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#alli_Alli"><span class="id" title="lemma">alli_Alli</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaCoq.Utils.All_Forall.html#Alli_nth_error"><span class="id" title="lemma">Alli_nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hall</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">e2</span> <span class="id" title="keyword">as</span> <span class="id" title="var">HH</span>;<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">br</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">ctx</span> <span class="id" title="var">br</span>];<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#is_true"><span class="id" title="definition">is_true</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Bool.Bool.html#andb_true_iff"><span class="id" title="lemma">andb_true_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">HH</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">bm_ctx</span> <span class="id" title="var">valid_bm</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">bm_ctx</span>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_aux"><span class="id" title="abbreviation">dearg_aux</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>) <span class="id" title="keyword">with</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_nth_error"><span class="id" title="lemma">forallb_nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">c</span> <span class="id" title="var">valid_brs</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">valid_br</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_br</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_branch_body_rec_dearg"><span class="id" title="lemma">dearg_branch_body_rec_dearg</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">invert_facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#ind_npars"><span class="id" title="projection">ind_npars</span></a> <span class="id" title="var">mib</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">pars</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">closed_args</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#forallb"><span class="id" title="definition">forallb</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">closedn</span></a> 0) <span class="id" title="var">args</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">closed_args_skip</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#forallb"><span class="id" title="definition">forallb</span></a> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">closedn</span></a> 0) (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#skipn"><span class="id" title="definition">skipn</span></a> <span class="id" title="var">pars</span> <span class="id" title="var">args</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_skipn"><span class="id" title="lemma">forallb_skipn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_substl"><span class="id" title="lemma">dearg_substl</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">dearg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hparams</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_branch_body_rec_substl_correct"><span class="id" title="lemma">dearg_branch_body_rec_substl_correct</span></a>;<span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">ev</span> := <span class="id" title="var">ev2</span>);<span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>;<span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">dearg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.ECSubst.html#closed_substl"><span class="id" title="lemma">closed_substl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#forallb_rev"><span class="id" title="lemma">forallb_rev</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#nth_error_forallb"><span class="id" title="lemma">nth_error_forallb</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_brs</span>;<span class="id" title="tactic">eauto</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#rev_length"><span class="id" title="lemma">List.rev_length</span></a>,<span class="id" title="var">e4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#nth_error_forallb"><span class="id" title="lemma">nth_error_forallb</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_brs</span>;<span class="id" title="tactic">eauto</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_substl"><span class="id" title="lemma">valid_cases_substl</span></a>; <span class="id" title="tactic">auto</span>;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall_rev"><span class="id" title="lemma">Forall_rev</span></a>, <a class="idref" href="MetaCoq.Utils.All_Forall.html#Forall_skipn"><span class="id" title="lemma">Forall_skipn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#nth_error_forallb"><span class="id" title="lemma">nth_error_forallb</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">exp_brs</span>;<span class="id" title="tactic">eauto</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_substl"><span class="id" title="lemma">is_expanded_substl</span></a>;<span class="id" title="tactic">auto</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#Forall_rev"><span class="id" title="lemma">Forall_rev</span></a>, <a class="idref" href="MetaCoq.Utils.All_Forall.html#Forall_skipn"><span class="id" title="lemma">Forall_skipn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#skipn_length"><span class="id" title="lemma">skipn_length</span></a> <span class="id" title="tactic">in</span> ×. <span class="id" title="var">propify</span>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">clear</span> <span class="id" title="var">IHev1</span> <span class="id" title="var">IHev2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Singleton&nbsp;pattern&nbsp;match&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">brs</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">mm</span> := <span class="id" title="keyword">match</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> (<a class="idref" href="MetaCoq.Common.Kernames.html#inductive_mind"><span class="id" title="projection">inductive_mind</span></a> <span class="id" title="var">ind</span>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">mm</span> ⇒ <span class="id" title="var">mm</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#Build_mib_masks"><span class="id" title="constructor">Build_mib_masks</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">ctx_mask</span> := <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#complete_ctx_mask"><span class="id" title="definition">complete_ctx_mask</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#get_branch_mask"><span class="id" title="definition">get_branch_mask</span></a> <span class="id" title="var">mm</span> (<a class="idref" href="MetaCoq.Common.Kernames.html#inductive_ind"><span class="id" title="projection">inductive_ind</span></a> <span class="id" title="var">ind</span>) 0) <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_iota_sing"><span class="id" title="constructor">eval_iota_sing</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">if</span> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#get_branch_mask"><span class="id" title="definition">get_branch_mask</span></a> <span class="id" title="var">mm</span> (<a class="idref" href="MetaCoq.Common.Kernames.html#inductive_ind"><span class="id" title="projection">inductive_ind</span></a> <span class="id" title="var">ind</span>) 0<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#0f31f5c1c6b6a21a3a187247222bc9e4"><span class="id" title="notation">&lt;=?</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">n</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#masked"><span class="id" title="definition">masked</span></a> <span class="id" title="var">ctx_mask</span> <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_case_branch"><span class="id" title="definition">dearg_case_branch</span></a> <span class="id" title="var">mm</span> <span class="id" title="var">ind</span> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">f4</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="MetaCoq.Utils.MCProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">).2</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<span class="id" title="var">IH</span> <span class="id" title="var">_</span> <a class="idref" href="MetaCoq.Erasure.EAst.html#tBox"><span class="id" title="constructor">tBox</span></a>); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#inductive_isprop_and_pars_trans_env_dearg_env"><span class="id" title="lemma">inductive_isprop_and_pars_trans_env_dearg_env</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> <span class="id" title="var">_</span>); <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Utils.MCProd.html#on_snd"><span class="id" title="definition">on_snd</span></a>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_case_branch"><span class="id" title="definition">dearg_case_branch</span></a>,<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_branch_body"><span class="id" title="definition">dearg_branch_body</span></a>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#0f31f5c1c6b6a21a3a187247222bc9e4"><span class="id" title="notation">&lt;=?</span></a> <span class="id" title="var">_</span>);<span class="id" title="var">cbn</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">subst</span> <span class="id" title="var">ctx_mask</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#complete_ctx_mask"><span class="id" title="definition">complete_ctx_mask</span></a>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#app_nil_r"><span class="id" title="lemma">app_nil_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#masked_all_zeros"><span class="id" title="lemma">masked_all_zeros</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#fold_left"><span class="id" title="definition">fold_left</span></a> <span class="id" title="var">_</span> ?<span class="id" title="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>?<span class="id" title="var">i</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a>?<span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">with</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_branch_body_rec"><span class="id" title="definition">dearg_branch_body_rec</span></a> <span class="id" title="var">i</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_branch_body_rec_all_zeros"><span class="id" title="lemma">dearg_branch_body_rec_all_zeros</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">unfold</span> <span class="id" title="var">valid_case_masks</span> <span class="id" title="tactic">in</span> ×. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_brs_masks</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<span class="id" title="keyword">if</span> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#get_branch_mask"><span class="id" title="definition">get_branch_mask</span></a> <span class="id" title="var">mm</span> (<a class="idref" href="MetaCoq.Common.Kernames.html#inductive_ind"><span class="id" title="projection">inductive_ind</span></a> <span class="id" title="var">ind</span>) 0<a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#0f31f5c1c6b6a21a3a187247222bc9e4"><span class="id" title="notation">&lt;=?</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">n</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#masked"><span class="id" title="definition">masked</span></a> <span class="id" title="var">ctx_mask</span> <span class="id" title="var">n</span> <span class="id" title="keyword">else</span> <span class="id" title="var">n</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">masked_n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#repeat"><span class="id" title="definition">repeat</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#tBox"><span class="id" title="constructor">tBox</span></a> <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#masked"><span class="id" title="definition">masked</span></a> <span class="id" title="var">ctx_mask</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#repeat"><span class="id" title="definition">repeat</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#tBox"><span class="id" title="constructor">tBox</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">n</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>)); <span class="id" title="var">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">unfold</span> <span class="id" title="var">valid_case_masks</span> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_brs_masks</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">mm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">valid_brs_masks</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">_</span> &amp; (<span class="id" title="var">bound</span> &amp; <span class="id" title="var">_</span>) &amp; <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hlen</span> : <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">ctx_mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">n</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>) <span class="id" title="tactic">by</span> (<span class="id" title="tactic">subst</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#complete_ctx_mask_length"><span class="id" title="lemma">complete_ctx_mask_length</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#0f31f5c1c6b6a21a3a187247222bc9e4"><span class="id" title="notation">&lt;=?</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">Hbm</span>;<span class="id" title="var">cbn</span>;<span class="id" title="var">propify</span>;<span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heqmasked_n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#masked_count_zeros"><span class="id" title="lemma">masked_count_zeros</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> <span class="id" title="var">ctx_mask</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> <span class="id" title="var">ctx_mask</span> ) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hlen</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">Heqmasked_n</span> <span class="id" title="var">Hlen</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">ctx_mask</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">intros</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">subst</span> <span class="id" title="var">mm</span> <span class="id" title="var">ctx_mask</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#complete_ctx_mask"><span class="id" title="definition">complete_ctx_mask</span></a> <span class="id" title="tactic">in</span> *;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#app_nil_r"><span class="id" title="lemma">app_nil_r</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heqmasked_n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#masked_all_zeros"><span class="id" title="lemma">masked_all_zeros</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_case_branch"><span class="id" title="definition">dearg_case_branch</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#0f31f5c1c6b6a21a3a187247222bc9e4"><span class="id" title="notation">&lt;=?</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">Hbm</span>;<span class="id" title="var">cbn</span>;<span class="id" title="var">propify</span>;<span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hlen</span> : <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">ctx_mask</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">n</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>) <span class="id" title="tactic">by</span> (<span class="id" title="tactic">subst</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#complete_ctx_mask_length"><span class="id" title="lemma">complete_ctx_mask_length</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#complete_ctx_mask"><span class="id" title="definition">complete_ctx_mask</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ctx_mask</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">ctx_mask</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Utils.MCList.html#rev_repeat"><span class="id" title="lemma">rev_repeat</span></a>, &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#rev_app_distr"><span class="id" title="lemma">rev_app_distr</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<a class="idref" href="MetaCoq.Utils.MCList.html#rev_repeat"><span class="id" title="lemma">rev_repeat</span></a> <span class="id" title="var">_</span> <a class="idref" href="MetaCoq.Erasure.EAst.html#tBox"><span class="id" title="constructor">tBox</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">mm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask_rev"><span class="id" title="lemma">mask_rev</span></a> <span class="id" title="tactic">by</span> (<span class="id" title="var">simpl_length</span>; <span class="id" title="var">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#masked_weakening"><span class="id" title="lemma">masked_weakening</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_branch_body_rec_substl_correct"><span class="id" title="lemma">dearg_branch_body_rec_substl_correct</span></a>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="var">simpl_length</span>; <span class="id" title="var">lia</span>);<span class="id" title="tactic">intuition</span>;<span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">dearg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#rev_repeat"><span class="id" title="lemma">rev_repeat</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_repeat_tBox"><span class="id" title="lemma">dearg_repeat_tBox</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_substl"><span class="id" title="lemma">dearg_substl</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">dearg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">ev</span> := <span class="id" title="var">ev2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*** <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.ECSubst.html#closed_substl"><span class="id" title="lemma">closed_substl</span></a>;<span class="id" title="var">simpl_length</span>;<span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">dearg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*** <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_substl"><span class="id" title="lemma">valid_cases_substl</span></a>;<span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">dearg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*** <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_substl"><span class="id" title="lemma">is_expanded_substl</span></a>;<span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">dearg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*** <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">subst</span> <span class="id" title="var">mm</span>. <span class="id" title="var">cbn</span> -[<span class="id" title="var">dearg_branch_body_rec</span>] <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#app_nil_r"><span class="id" title="lemma">app_nil_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_branch_body_rec_all_zeros"><span class="id" title="lemma">dearg_branch_body_rec_all_zeros</span></a>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">ctx_mask</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#complete_ctx_mask"><span class="id" title="definition">complete_ctx_mask</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Utils.MCList.html#rev_repeat"><span class="id" title="lemma">rev_repeat</span></a>, &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#rev_app_distr"><span class="id" title="lemma">rev_app_distr</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<a class="idref" href="MetaCoq.Utils.MCList.html#rev_repeat"><span class="id" title="lemma">rev_repeat</span></a> <span class="id" title="var">_</span> <a class="idref" href="MetaCoq.Erasure.EAst.html#tBox"><span class="id" title="constructor">tBox</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#mask_rev"><span class="id" title="lemma">mask_rev</span></a> <span class="id" title="tactic">by</span> (<span class="id" title="var">cbn</span>;<span class="id" title="var">simpl_length</span>; <span class="id" title="var">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#masked_weakening"><span class="id" title="lemma">masked_weakening</span></a>;<span class="id" title="var">cbn</span> -[<span class="id" title="var">substl</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_repeat_tBox"><span class="id" title="lemma">dearg_repeat_tBox</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_rev"><span class="id" title="lemma">map_rev</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_substl"><span class="id" title="lemma">dearg_substl</span></a>;<span class="id" title="tactic">intuition</span>; <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">dearg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#rev_repeat"><span class="id" title="lemma">rev_repeat</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">ev</span> := <span class="id" title="var">ev2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*** <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.ECSubst.html#closed_substl"><span class="id" title="lemma">closed_substl</span></a>;<span class="id" title="var">simpl_length</span>;<span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">dearg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*** <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_substl"><span class="id" title="lemma">valid_cases_substl</span></a>;<span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">dearg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*** <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_substl"><span class="id" title="lemma">is_expanded_substl</span></a>;<span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">dearg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*** <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Unfold&nbsp;cofix&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">clos_args</span> <span class="id" title="var">valid_args</span> <span class="id" title="var">exp_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">invert_facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_cofix_case"><span class="id" title="constructor">eval_cofix_case</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">args</span>) <span class="id" title="var">_</span> <span class="id" title="var">narg</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">fn</span>)); [|<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_cunfold_cofix"><span class="id" title="lemma">dearg_cunfold_cofix</span></a>;<span class="id" title="tactic">eauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">closed</span></a> <span class="id" title="var">fn</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#closed_cunfold_cofix"><span class="id" title="lemma">closed_cunfold_cofix</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <span class="id" title="var">fn</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_cunfold_cofix"><span class="id" title="lemma">valid_cases_cunfold_cofix</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <span class="id" title="var">fn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_cunfold_cofix"><span class="id" title="lemma">is_expanded_cunfold_cofix</span></a>; [<span class="id" title="var">eassumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tCoFix"><span class="id" title="constructor">tCoFix</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#map_def"><span class="id" title="definition">map_def</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a>) <span class="id" title="var">mfix</span>) <span class="id" title="var">idx</span>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tCoFix"><span class="id" title="constructor">tCoFix</span></a> <span class="id" title="var">mfix</span> <span class="id" title="var">idx</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_expanded"><span class="id" title="lemma">dearg_expanded</span></a>, &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_mkApps"><span class="id" title="lemma">dearg_mkApps</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">ev</span> := <span class="id" title="var">ev1</span>);<span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">dearg</span>;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">clear</span> <span class="id" title="var">IHev1</span> <span class="id" title="var">IHev2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <span class="id" title="var">fn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_cunfold_cofix"><span class="id" title="lemma">is_expanded_cunfold_cofix</span></a>; [<span class="id" title="var">eassumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tCase"><span class="id" title="constructor">tCase</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">ind</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">npars</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <span class="id" title="var">fn</span> <span class="id" title="var">args</span>) <span class="id" title="var">brs</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">b</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">dearg_case</span> <span class="id" title="tactic">in</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_expanded"><span class="id" title="lemma">dearg_expanded</span></a>, &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_mkApps"><span class="id" title="lemma">dearg_mkApps</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tCase"><span class="id" title="constructor">tCase</span></a> <span class="id" title="var">_</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <span class="id" title="var">fn</span> <span class="id" title="var">args</span>)) <span class="id" title="var">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tCase"><span class="id" title="constructor">tCase</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">ind</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">npars</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <span class="id" title="var">fn</span> <span class="id" title="var">args</span>) <span class="id" title="var">brs</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">closed</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <span class="id" title="var">fn</span> <span class="id" title="var">args</span>)) <span class="id" title="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.ClosedAux.html#closed_mkApps"><span class="id" title="lemma">closed_mkApps</span></a>;[<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#closed_cunfold_cofix"><span class="id" title="lemma">closed_cunfold_cofix</span></a>;<span class="id" title="tactic">eauto</span>|<span class="id" title="tactic">eauto</span>]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <span class="id" title="var">fn</span> <span class="id" title="var">args</span>)) <span class="id" title="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> (<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_mkApps"><span class="id" title="lemma">valid_cases_mkApps</span></a>;[<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_cunfold_cofix"><span class="id" title="lemma">valid_cases_cunfold_cofix</span></a>;<span class="id" title="tactic">eauto</span>|<span class="id" title="tactic">eauto</span>]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <span class="id" title="var">fn</span> <span class="id" title="var">args</span>)) <span class="id" title="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_mkApps"><span class="id" title="lemma">is_expanded_aux_mkApps</span></a>;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">dearg</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a>;<span class="id" title="tactic">eauto</span>;<span class="id" title="var">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">ev</span> := <span class="id" title="var">ev2</span>);<span class="id" title="var">cbn</span>;<span class="id" title="var">propify</span>;<span class="id" title="tactic">intuition</span>;<span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">dearg</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.ClosedAux.html#closed_mkApps_inv"><span class="id" title="lemma">closed_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_t</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">clos_hd</span> &amp; <span class="id" title="var">clos_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_mkApps_inv"><span class="id" title="lemma">valid_cases_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_t</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">valid_hd</span> &amp; <span class="id" title="var">valid_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_mkApps_inv"><span class="id" title="lemma">is_expanded_aux_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">exp_t</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">exp_hd</span> &amp; <span class="id" title="var">exp_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> × |-.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#eval_mkApps_dearg_reduce"><span class="id" title="lemma">eval_mkApps_dearg_reduce</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;6: <span class="id" title="tactic">exact</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> →.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">refold'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">clos_args</span> <span class="id" title="var">valid_args</span> <span class="id" title="var">exp_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">depind</span> <span class="id" title="var">ev</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Cofix&nbsp;projection&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">valid_hd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">invert_facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_cofix_proj"><span class="id" title="constructor">eval_cofix_proj</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ((<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#map_def"><span class="id" title="definition">map_def</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_aux"><span class="id" title="abbreviation">dearg_aux</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>)) <span class="id" title="var">mfix</span>)) <span class="id" title="var">idx</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">args</span>) <span class="id" title="var">_</span> <span class="id" title="var">narg</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">fn</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">change</span> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tCoFix"><span class="id" title="constructor">tCoFix</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tCoFix"><span class="id" title="constructor">tCoFix</span></a> <span class="id" title="var">mfix</span> <span class="id" title="var">idx</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_expanded"><span class="id" title="lemma">dearg_expanded</span></a>, &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_mkApps"><span class="id" title="lemma">dearg_mkApps</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">ev</span> := <span class="id" title="var">ev1</span>);<span class="id" title="var">now</span> <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">dearg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_cunfold_cofix"><span class="id" title="lemma">dearg_cunfold_cofix</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <span class="id" title="var">fn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_cunfold_cofix"><span class="id" title="lemma">is_expanded_cunfold_cofix</span></a>; [<span class="id" title="var">eassumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#forallb_Forall"><span class="id" title="lemma">forallb_Forall</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_expanded"><span class="id" title="lemma">dearg_expanded</span></a>, &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_mkApps"><span class="id" title="lemma">dearg_mkApps</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tProj"><span class="id" title="constructor">tProj</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tProj"><span class="id" title="constructor">tProj</span></a> {| <a class="idref" href="MetaCoq.Common.Kernames.html#proj_ind"><span class="id" title="projection">proj_ind</span></a> := <span class="id" title="var">ind</span>; <a class="idref" href="MetaCoq.Common.Kernames.html#proj_npars"><span class="id" title="projection">proj_npars</span></a> := <span class="id" title="var">c</span>; <a class="idref" href="MetaCoq.Common.Kernames.html#proj_arg"><span class="id" title="projection">proj_arg</span></a> := <span class="id" title="var">npars</span> |} (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <span class="id" title="var">fn</span> <span class="id" title="var">args</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">closed</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <span class="id" title="var">fn</span> <span class="id" title="var">args</span>)) <span class="id" title="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.ClosedAux.html#closed_mkApps"><span class="id" title="lemma">closed_mkApps</span></a>;[<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#closed_cunfold_cofix"><span class="id" title="lemma">closed_cunfold_cofix</span></a>;<span class="id" title="tactic">eauto</span>|<span class="id" title="tactic">eauto</span>]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <span class="id" title="var">fn</span> <span class="id" title="var">args</span>)) <span class="id" title="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> (<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_mkApps"><span class="id" title="lemma">valid_cases_mkApps</span></a>;[<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_cunfold_cofix"><span class="id" title="lemma">valid_cases_cunfold_cofix</span></a>;<span class="id" title="tactic">eauto</span>|<span class="id" title="tactic">eauto</span>]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <span class="id" title="var">fn</span> <span class="id" title="var">args</span>)) <span class="id" title="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_mkApps"><span class="id" title="lemma">is_expanded_aux_mkApps</span></a>;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">dearg</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a>;<span class="id" title="tactic">eauto</span>; <span class="id" title="var">lia</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">ev</span> := <span class="id" title="var">ev2</span>);<span class="id" title="var">cbn</span>;<span class="id" title="var">propify</span>;<span class="id" title="var">now</span> <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">dearg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Regular&nbsp;projection&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">IHev1</span> <span class="id" title="var">IHev2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">valid_hd</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">valid_hd</span> &amp; <span class="id" title="var">valid_p</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">invert_facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">dearg_proj</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_proj"><span class="id" title="constructor">eval_proj</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#masked"><span class="id" title="definition">masked</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#get_ctor_mask"><span class="id" title="abbreviation">get_ctor_mask</span></a> <span class="id" title="var">ind</span> 0) (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">args</span>)) (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">a</span>));<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">unshelve</span> <span class="id" title="var">epose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">IH</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev1</span> <span class="id" title="var">_</span>); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_mkApps"><span class="id" title="lemma">dearg_mkApps</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_single_masked"><span class="id" title="lemma">dearg_single_masked</span></a> <span class="id" title="tactic">in</span> × <span class="id" title="tactic">by</span> (<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#constructor_isprop_pars_decl_trans_env_dearg_env"><span class="id" title="lemma">constructor_isprop_pars_decl_trans_env_dearg_env</span></a>;<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearged_ctor_arity"><span class="id" title="definition">dearged_ctor_arity</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#constructor_isprop_pars_decl"><span class="id" title="definition">constructor_isprop_pars_decl</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e1</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_env_trans_env"><span class="id" title="lemma">lookup_env_trans_env</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">g</span>|]<span class="id" title="var">eqn</span>:<span class="id" title="var">Hg</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">g</span> <span class="id" title="keyword">as</span> [ | <span class="id" title="var">mib</span> |] <span class="id" title="var">eqn</span>:<span class="id" title="var">Hmib</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#nth_error_map"><span class="id" title="lemma">nth_error_map</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="keyword">as</span> [<span class="id" title="var">oib</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">Hoib</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">decl_ind</span> :<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#declared_inductive"><span class="id" title="definition">declared_inductive</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <span class="id" title="var">Σ</span>) <span class="id" title="var">ind</span> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_mib"><span class="id" title="definition">trans_mib</span></a> <span class="id" title="var">mib</span>) (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_oib"><span class="id" title="definition">trans_oib</span></a> <span class="id" title="var">oib</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#declared_inductive"><span class="id" title="definition">declared_inductive</span></a>,<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#declared_minductive"><span class="id" title="definition">declared_minductive</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_env_trans_env"><span class="id" title="lemma">lookup_env_trans_env</span></a>. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_mib"><span class="id" title="definition">trans_mib</span></a>;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#nth_error_map"><span class="id" title="lemma">nth_error_map</span></a>. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hoib</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_ind_mask_inductive"><span class="id" title="lemma">valid_ind_mask_inductive</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">valid_env</span> <span class="id" title="var">decl_ind</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">mask</span> [<span class="id" title="var">Hmask</span> <span class="id" title="var">Hparams</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">get_ctor_mask</span>,<span class="id" title="var">valid_proj</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hmask</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#masked_count_zeros"><span class="id" title="lemma">masked_count_zeros</span></a> <span class="id" title="tactic">by</span> (<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>;<span class="id" title="var">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#count_zeros_distr_app"><span class="id" title="lemma">count_zeros_distr_app</span></a>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#get_branch_mask"><span class="id" title="definition">get_branch_mask</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">bm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> <span class="id" title="var">bm</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">bm</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#count_zeros_le"><span class="id" title="lemma">count_zeros_le</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> <span class="id" title="var">bm</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_ones"><span class="id" title="definition">count_ones</span></a> <span class="id" title="var">bm</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">bm</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> ) <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#count_ones_zeros"><span class="id" title="lemma">count_ones_zeros</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#constructor_isprop_pars_decl"><span class="id" title="definition">constructor_isprop_pars_decl</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e1</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_env_trans_env"><span class="id" title="lemma">lookup_env_trans_env</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">g</span>|]<span class="id" title="var">eqn</span>:<span class="id" title="var">Hg</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">g</span> <span class="id" title="keyword">as</span> [ | <span class="id" title="var">mib</span> |] <span class="id" title="var">eqn</span>:<span class="id" title="var">Hmib</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#nth_error_map"><span class="id" title="lemma">nth_error_map</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="keyword">as</span> [<span class="id" title="var">oib</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">Hoib</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">decl_ind</span> :<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#declared_inductive"><span class="id" title="definition">declared_inductive</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <span class="id" title="var">Σ</span>) <span class="id" title="var">ind</span> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_mib"><span class="id" title="definition">trans_mib</span></a> <span class="id" title="var">mib</span>) (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_oib"><span class="id" title="definition">trans_oib</span></a> <span class="id" title="var">oib</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#declared_inductive"><span class="id" title="definition">declared_inductive</span></a>,<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#declared_minductive"><span class="id" title="definition">declared_minductive</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_env_trans_env"><span class="id" title="lemma">lookup_env_trans_env</span></a>. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_mib"><span class="id" title="definition">trans_mib</span></a>;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#nth_error_map"><span class="id" title="lemma">nth_error_map</span></a>. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hoib</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_ind_mask_inductive"><span class="id" title="lemma">valid_ind_mask_inductive</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">valid_env</span> <span class="id" title="var">decl_ind</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">mask</span> [<span class="id" title="var">Hmask</span> <span class="id" title="var">Hparams</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">get_ctor_mask</span>, <span class="id" title="var">valid_proj</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hmask</span> <span class="id" title="tactic">in</span> *;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">args</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">nth</span>; [|<span class="id" title="var">now</span> <span class="id" title="var">depelim</span> <span class="id" title="var">ev2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">valid_p</span> <span class="id" title="keyword">as</span> (&lt;- &amp; <span class="id" title="var">arg_unused</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#masked_map"><span class="id" title="lemma">masked_map</span></a>, <a class="idref" href="MetaCoq.Utils.MCList.html#nth_error_map"><span class="id" title="lemma">nth_error_map</span></a>, <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#masked_app"><span class="id" title="lemma">masked_app</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error_app2"><span class="id" title="lemma">nth_error_app2</span></a>; <span class="id" title="var">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#firstn_length"><span class="id" title="lemma">firstn_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#firstn_length"><span class="id" title="lemma">firstn_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Arith.PeanoNat.html#Nat.min_l"><span class="id" title="lemma">Nat.min_l</span></a>; <span class="id" title="var">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#masked_length"><span class="id" title="lemma">masked_length</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#param_mask"><span class="id" title="projection">param_mask</span></a> <span class="id" title="var">mask</span>) <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">(</span></a><span class="id" title="var">npars</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_ones"><span class="id" title="definition">count_ones</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#firstn"><span class="id" title="definition">firstn</span></a> <span class="id" title="var">npars</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#get_branch_mask"><span class="id" title="definition">get_branch_mask</span></a> <span class="id" title="var">mask</span> (<a class="idref" href="MetaCoq.Common.Kernames.html#inductive_ind"><span class="id" title="projection">inductive_ind</span></a> <span class="id" title="var">ind</span>) 0))<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#param_mask"><span class="id" title="projection">param_mask</span></a> <span class="id" title="var">mask</span>)) <span class="id" title="keyword">with</span> (<span class="id" title="var">npars</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#count_ones"><span class="id" title="definition">count_ones</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#firstn"><span class="id" title="definition">firstn</span></a> <span class="id" title="var">npars</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#get_branch_mask"><span class="id" title="definition">get_branch_mask</span></a> <span class="id" title="var">mask</span> (<a class="idref" href="MetaCoq.Common.Kernames.html#inductive_ind"><span class="id" title="projection">inductive_ind</span></a> <span class="id" title="var">ind</span>) 0)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#nth_error_masked"><span class="id" title="lemma">nth_error_masked</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#nth_error_skipn"><span class="id" title="lemma">nth_error_skipn</span></a>, <span class="id" title="var">nth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<span class="id" title="var">IH</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev2</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#nth_error_forall"><span class="id" title="lemma">nth_error_forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H5</span>; [|<span class="id" title="var">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#nth_error_forall"><span class="id" title="lemma">nth_error_forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H6</span>; [|<span class="id" title="var">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Utils.All_Forall.html#nth_error_forall"><span class="id" title="lemma">nth_error_forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H7</span>; [|<span class="id" title="var">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Project&nbsp;out&nbsp;of&nbsp;box&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">IHev</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">valid_hd</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">valid_hd</span> &amp; <span class="id" title="var">valid_p</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">dearg_proj</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_proj_prop"><span class="id" title="constructor">eval_proj_prop</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<span class="id" title="var">IH</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev</span> <span class="id" title="var">_</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#inductive_isprop_and_pars_trans_env_dearg_env"><span class="id" title="lemma">inductive_isprop_and_pars_trans_env_dearg_env</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.ClosedAux.html#closed_mkApps_inv"><span class="id" title="lemma">closed_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_t</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">clos_t</span> &amp; <span class="id" title="var">clos_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_mkApps_inv"><span class="id" title="lemma">valid_cases_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_t</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">valid_t</span> &amp; <span class="id" title="var">valid_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_mkApps_inv"><span class="id" title="lemma">is_expanded_aux_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">exp_t</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">exp_t</span> &amp; <span class="id" title="var">exp_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#eval_mkApps_dearg_reduce"><span class="id" title="lemma">eval_mkApps_dearg_reduce</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;6: <span class="id" title="tactic">exact</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">hd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> →.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">depelim</span> <span class="id" title="var">ev</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">y</span>; <span class="id" title="var">refold'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<span class="id" title="var">IH</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev1</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">revert</span> <span class="id" title="var">ev2</span> <span class="id" title="var">deriv_len</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="MetaCoq.Erasure.ECSubst.html#closed_subst"><span class="id" title="lemma">closed_subst</span></a> <span class="id" title="tactic">by</span> (<span class="id" title="tactic">auto</span>; <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_closed"><span class="id" title="lemma">eval_closed</span></a>;<span class="id" title="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.ECSubst.html#closed_subst"><span class="id" title="lemma">closed_subst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst0"><span class="id" title="abbreviation">subst0</span></a> ?<span class="id" title="var">a</span> ?<span class="id" title="var">t</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="MetaCoq.Erasure.ELiftSubst.html#subst0"><span class="id" title="abbreviation">subst0</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="var">b0'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>) <span class="id" title="var">t</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_subst"><span class="id" title="lemma">dearg_subst</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<span class="id" title="var">IH</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev2</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.ClosedAux.html#closedn_subst0"><span class="id" title="lemma">closedn_subst0</span></a>;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_cases_subst"><span class="id" title="lemma">valid_cases_subst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#is_expanded_aux_subst"><span class="id" title="lemma">is_expanded_aux_subst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#closedn_dearg_aux"><span class="id" title="lemma">closedn_dearg_aux</span></a>;<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">y</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct"><span class="id" title="section">dearg_correct</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="lookup_env_debox_env_types" class="idref" href="#lookup_env_debox_env_types"><span class="id" title="lemma">lookup_env_debox_env_types</span></a> <a id="491027ad53cd0e1fa89efe8a3515caa4" class="idref" href="#491027ad53cd0e1fa89efe8a3515caa4"><span class="id" title="binder">Σ</span></a> <a id="kn:596" class="idref" href="#kn:596"><span class="id" title="binder">kn</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#debox_env_types"><span class="id" title="definition">debox_env_types</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#491027ad53cd0e1fa89efe8a3515caa4"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#kn:596"><span class="id" title="variable">kn</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#option_map"><span class="id" title="definition">option_map</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#debox_type_decl"><span class="id" title="definition">debox_type_decl</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#491027ad53cd0e1fa89efe8a3515caa4"><span class="id" title="variable">Σ</span></a>) (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#491027ad53cd0e1fa89efe8a3515caa4"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#kn:596"><span class="id" title="variable">kn</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#debox_env_types"><span class="id" title="definition">debox_env_types</span></a>, <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="var">Σ</span> <span class="id" title="tactic">at</span> 1 3.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">masks</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Σ</span> <span class="id" title="keyword">as</span> [|((<span class="id" title="var">kn'</span>, <span class="id" title="var">has_deps</span>), <span class="id" title="var">decl</span>) <span class="id" title="var">Σ</span> <span class="id" title="var">IH</span>]; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">eq_kername</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">eq_kername</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaCoq.Common.Kernames.html#Kername.reflect_kername"><span class="id" title="instance">Kername.reflect_kername</span></a> <span class="id" title="keyword">as</span> [<span class="id" title="var">eq</span> <span class="id" title="var">Heq</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">Heq</span> <span class="id" title="var">kn</span> <span class="id" title="var">kn'</span>); [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="constructor_isprop_pars_decl_trans_env_debox_types" class="idref" href="#constructor_isprop_pars_decl_trans_env_debox_types"><span class="id" title="lemma">constructor_isprop_pars_decl_trans_env_debox_types</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="dfc55193e91f59a3f9e4deb7d1b755d3" class="idref" href="#dfc55193e91f59a3f9e4deb7d1b755d3"><span class="id" title="binder">Σ</span></a> : <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#global_env"><span class="id" title="definition">global_env</span></a>) (<a id="ind:598" class="idref" href="#ind:598"><span class="id" title="binder">ind</span></a> : <a class="idref" href="MetaCoq.Common.Kernames.html#inductive"><span class="id" title="record">inductive</span></a>) (<a id="c:599" class="idref" href="#c:599"><span class="id" title="binder">c</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) <a id="r:600" class="idref" href="#r:600"><span class="id" title="binder">r</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#constructor_isprop_pars_decl"><span class="id" title="definition">constructor_isprop_pars_decl</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dfc55193e91f59a3f9e4deb7d1b755d3"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:598"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c:599"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#r:600"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#constructor_isprop_pars_decl"><span class="id" title="definition">constructor_isprop_pars_decl</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#debox_env_types"><span class="id" title="definition">debox_env_types</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dfc55193e91f59a3f9e4deb7d1b755d3"><span class="id" title="variable">Σ</span></a>)) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:598"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c:599"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#r:600"><span class="id" title="variable">r</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Σ</span> <span class="id" title="var">ind</span> <span class="id" title="var">pars</span> <span class="id" title="var">c</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#constructor_isprop_pars_decl"><span class="id" title="definition">constructor_isprop_pars_decl</span></a> <span class="id" title="tactic">in</span> *;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_env_trans_env"><span class="id" title="lemma">lookup_env_trans_env</span></a>, <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_env_debox_env_types"><span class="id" title="lemma">lookup_env_debox_env_types</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">g</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="MetaCoq.Utils.MCList.html#nth_error_map"><span class="id" title="lemma">nth_error_map</span></a> <span class="id" title="tactic">in</span> ×. <span class="id" title="tactic">destruct</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_ctors"><span class="id" title="definition">trans_ctors</span></a> <span class="id" title="tactic">in</span> *;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#nth_error_map"><span class="id" title="lemma">nth_error_map</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">p0</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">p0</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="inductive_isprop_and_pars_trans_env_debox_types" class="idref" href="#inductive_isprop_and_pars_trans_env_debox_types"><span class="id" title="lemma">inductive_isprop_and_pars_trans_env_debox_types</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="2770a6d5fa6c00426ebd0f7ed8041614" class="idref" href="#2770a6d5fa6c00426ebd0f7ed8041614"><span class="id" title="binder">Σ</span></a> : <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#global_env"><span class="id" title="definition">global_env</span></a>) (<a id="ind:602" class="idref" href="#ind:602"><span class="id" title="binder">ind</span></a> : <a class="idref" href="MetaCoq.Common.Kernames.html#inductive"><span class="id" title="record">inductive</span></a>) (<a id="r:603" class="idref" href="#r:603"><span class="id" title="binder">r</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#inductive_isprop_and_pars"><span class="id" title="definition">inductive_isprop_and_pars</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#2770a6d5fa6c00426ebd0f7ed8041614"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:602"><span class="id" title="variable">ind</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#r:603"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#inductive_isprop_and_pars"><span class="id" title="definition">inductive_isprop_and_pars</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#debox_env_types"><span class="id" title="definition">debox_env_types</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#2770a6d5fa6c00426ebd0f7ed8041614"><span class="id" title="variable">Σ</span></a>)) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:602"><span class="id" title="variable">ind</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#r:603"><span class="id" title="variable">r</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Σ</span> <span class="id" title="var">ind</span> <span class="id" title="var">r</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#inductive_isprop_and_pars"><span class="id" title="definition">inductive_isprop_and_pars</span></a> <span class="id" title="tactic">in</span> *;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_env_trans_env"><span class="id" title="lemma">lookup_env_trans_env</span></a>, <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_env_debox_env_types"><span class="id" title="lemma">lookup_env_debox_env_types</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">g</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="MetaCoq.Utils.MCList.html#nth_error_map"><span class="id" title="lemma">nth_error_map</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="lookup_constructor_debox_types" class="idref" href="#lookup_constructor_debox_types"><span class="id" title="lemma">lookup_constructor_debox_types</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="ab1cf764bd18f97c0645fa879d549c30" class="idref" href="#ab1cf764bd18f97c0645fa879d549c30"><span class="id" title="binder">Σ</span></a> : <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#global_env"><span class="id" title="definition">global_env</span></a>) (<a id="ind:605" class="idref" href="#ind:605"><span class="id" title="binder">ind</span></a> : <a class="idref" href="MetaCoq.Common.Kernames.html#inductive"><span class="id" title="record">inductive</span></a>) (<a id="c:606" class="idref" href="#c:606"><span class="id" title="binder">c</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) <a id="m:607" class="idref" href="#m:607"><span class="id" title="binder">m</span></a> <a id="o:608" class="idref" href="#o:608"><span class="id" title="binder">o</span></a> <a id="i:609" class="idref" href="#i:609"><span class="id" title="binder">i</span></a> <a id="n:610" class="idref" href="#n:610"><span class="id" title="binder">n</span></a> <a id="l:611" class="idref" href="#l:611"><span class="id" title="binder">l</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="e:612" class="idref" href="#e:612"><span class="id" title="binder">e</span></a> : <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_constructor_full"><span class="id" title="definition">lookup_constructor_full</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ab1cf764bd18f97c0645fa879d549c30"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:605"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c:606"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#m:607"><span class="id" title="variable">m</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#o:608"><span class="id" title="variable">o</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:609"><span class="id" title="variable">i</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:610"><span class="id" title="variable">n</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#l:611"><span class="id" title="variable">l</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">))</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_constructor_full"><span class="id" title="definition">lookup_constructor_full</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#debox_env_types"><span class="id" title="definition">debox_env_types</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ab1cf764bd18f97c0645fa879d549c30"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:605"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c:606"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#debox_type_mib"><span class="id" title="definition">debox_type_mib</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ab1cf764bd18f97c0645fa879d549c30"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#m:607"><span class="id" title="variable">m</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#debox_type_oib"><span class="id" title="definition">debox_type_oib</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ab1cf764bd18f97c0645fa879d549c30"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#o:608"><span class="id" title="variable">o</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,(</span></a><a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#i:609"><span class="id" title="variable">i</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="MetaCoq.Utils.MCProd.html#on_snd"><span class="id" title="definition">on_snd</span></a> (<span class="id" title="keyword">fun</span> <a id="x:613" class="idref" href="#x:613"><span class="id" title="binder">x</span></a> : <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#box_type"><span class="id" title="inductive">box_type</span></a> ⇒ <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#reindex"><span class="id" title="definition">reindex</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#ind_type_vars"><span class="id" title="projection">ind_type_vars</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#o:608"><span class="id" title="variable">o</span></a>) (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#debox_box_type"><span class="id" title="definition">debox_box_type</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ab1cf764bd18f97c0645fa879d549c30"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#x:613"><span class="id" title="variable">x</span></a>))) <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#n:610"><span class="id" title="variable">n</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#l:611"><span class="id" title="variable">l</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">))</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Σ</span> <span class="id" title="var">ind</span> <span class="id" title="var">c</span> <span class="id" title="var">m</span> <span class="id" title="var">o</span> <span class="id" title="var">i</span> <span class="id" title="var">n</span> <span class="id" title="var">l</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_constructor_full"><span class="id" title="definition">lookup_constructor_full</span></a> <span class="id" title="tactic">in</span> *;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_constructor_full"><span class="id" title="definition">lookup_constructor_full</span></a>,<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_minductive"><span class="id" title="definition">lookup_minductive</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_env_debox_env_types"><span class="id" title="lemma">lookup_env_debox_env_types</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">mdecl_e</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">Henv</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">mdecl_e</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">mib</span> |]<span class="id" title="var">eqn</span>:<span class="id" title="var">Hgd</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#nth_error_map"><span class="id" title="lemma">nth_error_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> [|]<span class="id" title="var">eqn</span>:<span class="id" title="var">nth</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Utils.MCList.html#nth_error_map"><span class="id" title="lemma">nth_error_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">c</span>);<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">p0</span>]. <span class="id" title="tactic">destruct</span> <span class="id" title="var">p0</span>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>;<span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="eval_debox_env_types" class="idref" href="#eval_debox_env_types"><span class="id" title="lemma">eval_debox_env_types</span></a> {<a id="wfl:614" class="idref" href="#wfl:614"><span class="id" title="binder">wfl</span></a> : <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">WcbvFlags</span></a>} <a id="03b1e7afef797d584980fe1aafbb3a7e" class="idref" href="#03b1e7afef797d584980fe1aafbb3a7e"><span class="id" title="binder">Σ</span></a> <a id="t:616" class="idref" href="#t:616"><span class="id" title="binder">t</span></a> <a id="v:617" class="idref" href="#v:617"><span class="id" title="binder">v</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#with_constructor_as_block"><span class="id" title="method">with_constructor_as_block</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#03b1e7afef797d584980fe1aafbb3a7e"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">e</span></a><a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⊢</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:616"><span class="id" title="variable">t</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⇓</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#v:617"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#debox_env_types"><span class="id" title="definition">debox_env_types</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#03b1e7afef797d584980fe1aafbb3a7e"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">e</span></a><a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⊢</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#t:616"><span class="id" title="variable">t</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⇓</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#v:617"><span class="id" title="variable">v</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">wcab</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> 1; <span class="id" title="tactic">eauto</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_iota"><span class="id" title="constructor">eval_iota</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#constructor_isprop_pars_decl_trans_env_debox_types"><span class="id" title="lemma">constructor_isprop_pars_decl_trans_env_debox_types</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_iota_sing"><span class="id" title="constructor">eval_iota_sing</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#inductive_isprop_and_pars_trans_env_debox_types"><span class="id" title="lemma">inductive_isprop_and_pars_trans_env_debox_types</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_delta"><span class="id" title="constructor">eval_delta</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#declared_constant"><span class="id" title="definition">declared_constant</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_env_trans_env"><span class="id" title="lemma">lookup_env_trans_env</span></a>, <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_env_debox_env_types"><span class="id" title="lemma">lookup_env_debox_env_types</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [|<span class="id" title="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">g</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">destruct</span> <span class="id" title="var">o</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_proj"><span class="id" title="constructor">eval_proj</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#constructor_isprop_pars_decl_trans_env_debox_types"><span class="id" title="lemma">constructor_isprop_pars_decl_trans_env_debox_types</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_proj_prop"><span class="id" title="constructor">eval_proj_prop</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#inductive_isprop_and_pars_trans_env_debox_types"><span class="id" title="lemma">inductive_isprop_and_pars_trans_env_debox_types</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_ctor_trans_env"><span class="id" title="lemma">lookup_ctor_trans_env</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e0</span> <span class="id" title="keyword">as</span> <span class="id" title="var">ee</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ee</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">mib</span> &amp; <span class="id" title="var">oib</span> &amp; <span class="id" title="var">ctor</span> &amp; <span class="id" title="var">Hc</span> &amp; <span class="id" title="var">Hmib</span> &amp; <span class="id" title="var">Hoib</span> &amp; <span class="id" title="var">Hctor</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ctor</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">i</span> <span class="id" title="var">n</span>] <span class="id" title="var">l0</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_constructor_debox_types"><span class="id" title="lemma">lookup_constructor_debox_types</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_construct"><span class="id" title="constructor">eval_construct</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_ctor_trans_env_inv"><span class="id" title="lemma">lookup_ctor_trans_env_inv</span></a>;<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span> : <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#eval_atom"><span class="id" title="constructor">eval_atom</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">depelim</span> <span class="id" title="var">t</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span>;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">i0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaCoq.Erasure.EGlobalEnv.html#lookup_constructor"><span class="id" title="definition">EGlobalEnv.lookup_constructor</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <span class="id" title="var">Σ</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">p</span> | ] <span class="id" title="var">eqn</span>:<span class="id" title="var">He</span>;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span> <span class="id" title="keyword">as</span> [[??]?].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_ctor_trans_env"><span class="id" title="lemma">lookup_ctor_trans_env</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">He</span> <span class="id" title="keyword">as</span> <span class="id" title="var">ee</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ee</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">mib</span> &amp; <span class="id" title="var">oib</span> &amp; <span class="id" title="var">ctor</span> &amp; <span class="id" title="var">Hc</span> &amp; <span class="id" title="var">Hmib</span> &amp; <span class="id" title="var">Hoib</span> &amp; <span class="id" title="var">Hctor</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ctor</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">ind</span> <span class="id" title="var">m</span>] <span class="id" title="var">l0</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_constructor_debox_types"><span class="id" title="lemma">lookup_constructor_debox_types</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#lookup_ctor_trans_env_inv"><span class="id" title="lemma">lookup_ctor_trans_env_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hc</span>;<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hc</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="eval_const_construct_expanded" class="idref" href="#eval_const_construct_expanded"><span class="id" title="lemma">eval_const_construct_expanded</span></a> {<a id="wfl:618" class="idref" href="#wfl:618"><span class="id" title="binder">wfl</span></a> : <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">WcbvFlags</span></a>} <a id="62eb0b21c414bb95ce7b135a3873411d" class="idref" href="#62eb0b21c414bb95ce7b135a3873411d"><span class="id" title="binder">Σ</span></a> <a id="kn:620" class="idref" href="#kn:620"><span class="id" title="binder">kn</span></a> <a id="ind:621" class="idref" href="#ind:621"><span class="id" title="binder">ind</span></a> <a id="c:622" class="idref" href="#c:622"><span class="id" title="binder">c</span></a> <a id="im:623" class="idref" href="#im:623"><span class="id" title="binder">im</span></a> <a id="cm:624" class="idref" href="#cm:624"><span class="id" title="binder">cm</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#62eb0b21c414bb95ce7b135a3873411d"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">e</span></a><a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⊢</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#tConst"><span class="id" title="constructor">tConst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#kn:620"><span class="id" title="variable">kn</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⇓</span></a> <a class="idref" href="MetaCoq.Erasure.EAst.html#tConstruct"><span class="id" title="constructor">tConstruct</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#ind:621"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#c:622"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_masks_env"><span class="id" title="definition">valid_masks_env</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#im:623"><span class="id" title="variable">im</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#cm:624"><span class="id" title="variable">cm</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#62eb0b21c414bb95ce7b135a3873411d"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_expanded"><span class="id" title="definition">is_expanded</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#im:623"><span class="id" title="variable">im</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#cm:624"><span class="id" title="variable">cm</span></a> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tConst"><span class="id" title="constructor">tConst</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#kn:620"><span class="id" title="variable">kn</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">ev</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">depelim</span> <span class="id" title="var">ev</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_dearg_mask_constant"><span class="id" title="lemma">valid_dearg_mask_constant</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#valid_dearg_mask_spec"><span class="id" title="lemma">valid_dearg_mask_spec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">Γ</span> &amp; <span class="id" title="var">inner</span> &amp; &lt;- &amp; &lt;-).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">clear</span> -<span class="id" title="var">ev</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">Γ</span><a class="idref" href="MetaCoq.Utils.MCList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <span class="id" title="keyword">as</span> [|<span class="id" title="var">Γlen</span> <span class="id" title="var">IH</span>] <span class="id" title="var">eqn</span>:<span class="id" title="var">eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Γ</span>, <span class="id" title="var">inner</span>, <span class="id" title="var">ev</span> |- ×.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">Γ</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">Γ</span> <span class="id" title="keyword">as</span> [|[<span class="id" title="var">na</span> [<span class="id" title="var">body</span>|]] <span class="id" title="var">Γ</span>]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">depelim</span> <span class="id" title="var">ev</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">refold</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#subst_it_mkLambda_or_LetIn"><span class="id" title="lemma">subst_it_mkLambda_or_LetIn</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> &lt;- <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#vasses_subst_context"><span class="id" title="lemma">vasses_subst_context</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">IH</span>; [<span class="id" title="var">eassumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#length_subst_context"><span class="id" title="lemma">length_subst_context</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">depelim</span> <span class="id" title="var">ev</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="dearg_transform_correct" class="idref" href="#dearg_transform_correct"><span class="id" title="lemma">dearg_transform_correct</span></a> {<a id="wfl:625" class="idref" href="#wfl:625"><span class="id" title="binder">wfl</span></a> : <a class="idref" href="MetaCoq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">WcbvFlags</span></a>} <a id="overridden_masks:626" class="idref" href="#overridden_masks:626"><span class="id" title="binder">overridden_masks</span></a> <a id="do_trim_const_masks:627" class="idref" href="#do_trim_const_masks:627"><span class="id" title="binder">do_trim_const_masks</span></a> <a id="do_trim_ctor_masks:628" class="idref" href="#do_trim_ctor_masks:628"><span class="id" title="binder">do_trim_ctor_masks</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.Erasure.Typed.Transform.html#ExtractTransformCorrect"><span class="id" title="definition">ExtractTransformCorrect</span></a> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg_transform"><span class="id" title="definition">dearg_transform</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#overridden_masks:626"><span class="id" title="variable">overridden_masks</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#do_trim_const_masks:627"><span class="id" title="variable">do_trim_const_masks</span></a> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#do_trim_ctor_masks:628"><span class="id" title="variable">do_trim_ctor_masks</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Σopt</span> <span class="id" title="var">kn</span> <span class="id" title="var">ind</span> <span class="id" title="var">c</span> <span class="id" title="var">block</span> <span class="id" title="var">opt</span> <span class="id" title="var">ev</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">opt</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaCoq.Erasure.Typed.ClosedAux.html#env_closed"><span class="id" title="definition">env_closed</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">clos</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [|<span class="id" title="tactic">congruence</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#analyze_env"><span class="id" title="definition">analyze_env</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#is_expanded_env"><span class="id" title="definition">is_expanded_env</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">exp</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [|<span class="id" title="tactic">congruence</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#valid_masks_env"><span class="id" title="definition">valid_masks_env</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">valid</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [|<span class="id" title="tactic">congruence</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">injection</span> <span class="id" title="var">opt</span> <span class="id" title="keyword">as</span> &lt;-.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">im</span> := (<span class="id" title="keyword">if</span> <span class="id" title="var">do_trim_ctor_masks</span> <span class="id" title="keyword">then</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#trim_ind_masks"><span class="id" title="definition">trim_ind_masks</span></a> <span class="id" title="keyword">else</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#id"><span class="id" title="definition">id</span></a>) <span class="id" title="var">ind_masks</span>) <span class="id" title="tactic">in</span> *; <span class="id" title="var">clearbody</span> <span class="id" title="var">im</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">cm</span> := (<span class="id" title="keyword">if</span> <span class="id" title="var">do_trim_const_masks</span> <span class="id" title="keyword">then</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#trim_const_masks"><span class="id" title="definition">trim_const_masks</span></a> <span class="id" title="keyword">else</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#id"><span class="id" title="definition">id</span></a>) <span class="id" title="var">const_masks</span>) <span class="id" title="tactic">in</span> *; <span class="id" title="var">clearbody</span> <span class="id" title="var">cm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#eval_debox_env_types"><span class="id" title="lemma">eval_debox_env_types</span></a>;<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#eval_const_construct_expanded"><span class="id" title="lemma">eval_const_construct_expanded</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev</span> <span class="id" title="keyword">as</span> <span class="id" title="var">expanded_const</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#eval_is_expanded_aux"><span class="id" title="lemma">eval_is_expanded_aux</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev</span> <span class="id" title="keyword">as</span> <span class="id" title="var">empty_ctor_mask</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tConst"><span class="id" title="constructor">tConst</span></a> <span class="id" title="var">kn</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg"><span class="id" title="definition">dearg</span></a> <span class="id" title="var">im</span> <span class="id" title="var">cm</span> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tConst"><span class="id" title="constructor">tConst</span></a> <span class="id" title="var">kn</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tConstruct"><span class="id" title="constructor">tConstruct</span></a> <span class="id" title="var">ind</span> <span class="id" title="var">c</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>) <span class="id" title="keyword">with</span> (<a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#dearg"><span class="id" title="definition">dearg</span></a> <span class="id" title="var">im</span> <span class="id" title="var">cm</span> (<a class="idref" href="MetaCoq.Erasure.EAst.html#tConstruct"><span class="id" title="constructor">tConstruct</span></a> <span class="id" title="var">ind</span> <span class="id" title="var">c</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>)).<br/>
&nbsp;&nbsp;2-3: <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>; <span class="id" title="tactic">destruct</span> <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#get_const_mask"><span class="id" title="definition">get_const_mask</span></a>, <a class="idref" href="MetaCoq.Erasure.Typed.Optimize.html#get_ctor_mask"><span class="id" title="definition">get_ctor_mask</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaCoq.Erasure.Typed.OptimizeCorrectness.html#dearg_correct"><span class="id" title="lemma">dearg_correct</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
