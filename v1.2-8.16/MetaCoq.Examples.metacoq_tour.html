<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="../">Project Page</a>
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">Library MetaCoq.Examples.metacoq_tour</h1>

<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaCoq.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaCoq.Utils.utils.html#"><span class="id" title="library">utils</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaCoq.Common</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaCoq.Common.config.html#"><span class="id" title="library">config</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaCoq.Template</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaCoq.Template.All.html#"><span class="id" title="library">All</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaCoq.Template</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaCoq.Template.TemplateMonad.html#"><span class="id" title="library">TemplateMonad</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaCoq.PCUIC</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaCoq.PCUIC.PCUICAst.html#"><span class="id" title="library">PCUICAst</span></a> <a class="idref" href="MetaCoq.PCUIC.PCUICReduction.html#"><span class="id" title="library">PCUICReduction</span></a> <a class="idref" href="MetaCoq.PCUIC.PCUICCumulativity.html#"><span class="id" title="library">PCUICCumulativity</span></a> <a class="idref" href="MetaCoq.PCUIC.PCUICTyping.html#"><span class="id" title="library">PCUICTyping</span></a> <a class="idref" href="MetaCoq.PCUIC.PCUICSafeLemmata.html#"><span class="id" title="library">PCUICSafeLemmata</span></a>.<br/>

<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="MetaCoq.Utils.monad_utils.html#MCMonadNotation"><span class="id" title="module">MCMonadNotation</span></a>.<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">bs_scope</span>.<br/>

<br/>
</div>

<div class="doc">
MetaCoq is:

<div class="paragraph"> </div>

<ul class="doclist">
<li> The "template-coq" monad, dealing with reification of terms
    and environments.

</li>
<li> The PCUIC development of the syntactic metatheory of Coq.

</li>
<li> The SafeChecker package implementing reduction, conversion
    and typechecking in a sound and complete way.

</li>
<li> The Erasure package implementing verified extraction to
    untyped lambda-calculus

</li>
</ul>

</div>
<div class="code">

<br/>
<span class="comment">(*&nbsp;The&nbsp;Template&nbsp;monad&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Print</span> <a class="idref" href="MetaCoq.Template.Ast.html#term"><span class="id" title="inductive">Ast.term</span></a>.<br/>

<br/>
<span class="id" title="var">MetaCoq</span> <span class="id" title="var">Quote</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">reifx</span> := (<span class="id" title="keyword">fun</span> <a id="x:1" class="idref" href="#x:1"><span class="id" title="binder">x</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> ⇒ <a class="idref" href="MetaCoq.Examples.metacoq_tour.html#x:1"><span class="id" title="variable">x</span></a>).<br/>
<span class="id" title="keyword">Definition</span> <a id="foo" class="idref" href="#foo"><span class="id" title="definition">foo</span></a> := (<span class="id" title="keyword">fun</span> <a id="x:2" class="idref" href="#x:2"><span class="id" title="binder">x</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> ⇒ <span class="id" title="keyword">fun</span> <a id="x:3" class="idref" href="#x:3"><span class="id" title="binder">x</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> ⇒ <a class="idref" href="MetaCoq.Examples.metacoq_tour.html#x:3"><span class="id" title="variable">x</span></a>).<br/>
<span class="id" title="var">MetaCoq</span> <span class="id" title="var">Quote</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">reifx'</span> := <span class="id" title="keyword">Eval</span> <span class="id" title="tactic">compute</span> <span class="id" title="tactic">in</span> (<span class="id" title="keyword">fun</span> <a id="x:4" class="idref" href="#x:4"><span class="id" title="binder">x</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> ⇒ <span class="id" title="keyword">let</span> <a id="y:5" class="idref" href="#y:5"><span class="id" title="binder">y</span></a> := <a class="idref" href="MetaCoq.Examples.metacoq_tour.html#x:4"><span class="id" title="variable">x</span></a> <span class="id" title="tactic">in</span> <span class="id" title="keyword">fun</span> <a id="x:6" class="idref" href="#x:6"><span class="id" title="binder">x</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> ⇒ <a class="idref" href="MetaCoq.Examples.metacoq_tour.html#y:5"><span class="id" title="variable">y</span></a>).<br/>
<span class="id" title="keyword">Print</span> <a class="idref" href="MetaCoq.Examples.metacoq_tour.html#reifx'"><span class="id" title="definition">reifx'</span></a>.<br/>
<span class="id" title="var">MetaCoq</span> <span class="id" title="var">Unquote</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">x</span> :=<br/>
&nbsp;&nbsp;(<a class="idref" href="MetaCoq.Template.Ast.html#tConstruct"><span class="id" title="constructor">Ast.tConstruct</span></a> (<a class="idref" href="MetaCoq.Common.Kernames.html#mkInd"><span class="id" title="constructor">mkInd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaCoq.Common.Kernames.html#MPfile"><span class="id" title="constructor">MPfile</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a>"Datatypes"<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a> "Init"<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a> "Coq"<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> "nat"<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> 0) 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>).<br/>

<br/>
<span class="id" title="var">MetaCoq</span> <span class="id" title="var">Run</span> (<a class="idref" href="MetaCoq.Template.TemplateMonad.Core.html#tmBind"><span class="id" title="constructor">tmBind</span></a> (<a class="idref" href="MetaCoq.Template.TemplateMonad.Core.html#tmQuote"><span class="id" title="constructor">tmQuote</span></a> (3 <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> 3)) <a class="idref" href="MetaCoq.Template.TemplateMonad.Core.html#tmPrint"><span class="id" title="constructor">tmPrint</span></a>).<br/>

<br/>
<span class="id" title="var">MetaCoq</span> <span class="id" title="var">Run</span> (<a id="t:7" class="idref" href="#t:7"><span class="id" title="binder">t</span></a> <a class="idref" href="MetaCoq.Utils.monad_utils.html#6bec7af38cdf877f357faf8f1699c8f9"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="MetaCoq.Template.TemplateMonad.Core.html#tmLemma"><span class="id" title="constructor">tmLemma</span></a> "foo44" <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="MetaCoq.Utils.monad_utils.html#6bec7af38cdf877f357faf8f1699c8f9"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="qt:8" class="idref" href="#qt:8"><span class="id" title="binder">qt</span></a> <a class="idref" href="MetaCoq.Utils.monad_utils.html#6bec7af38cdf877f357faf8f1699c8f9"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="MetaCoq.Template.TemplateMonad.Core.html#tmQuote"><span class="id" title="constructor">tmQuote</span></a> <a class="idref" href="MetaCoq.Examples.metacoq_tour.html#t:7"><span class="id" title="variable">t</span></a> <a class="idref" href="MetaCoq.Utils.monad_utils.html#6bec7af38cdf877f357faf8f1699c8f9"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="t:9" class="idref" href="#t:9"><span class="id" title="binder">t</span></a> <a class="idref" href="MetaCoq.Utils.monad_utils.html#6bec7af38cdf877f357faf8f1699c8f9"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="MetaCoq.Template.TemplateMonad.Core.html#tmEval"><span class="id" title="constructor">tmEval</span></a> <a class="idref" href="MetaCoq.Template.TemplateMonad.Common.html#all"><span class="id" title="constructor">all</span></a> <a class="idref" href="MetaCoq.Examples.metacoq_tour.html#t:7"><span class="id" title="variable">t</span></a> <a class="idref" href="MetaCoq.Utils.monad_utils.html#6bec7af38cdf877f357faf8f1699c8f9"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaCoq.Template.TemplateMonad.Core.html#tmPrint"><span class="id" title="constructor">tmPrint</span></a> <a class="idref" href="MetaCoq.Examples.metacoq_tour.html#qt:8"><span class="id" title="variable">qt</span></a> <a class="idref" href="MetaCoq.Utils.monad_utils.html#ad6f5869610c58e6b1cafcdf52bb7ae3"><span class="id" title="notation">;;</span></a> <a class="idref" href="MetaCoq.Template.TemplateMonad.Core.html#tmPrint"><span class="id" title="constructor">tmPrint</span></a> <a class="idref" href="MetaCoq.Examples.metacoq_tour.html#t:9"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (3<a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a>2).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="comment">(*&nbsp;PCUIC:<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;Universes&nbsp;(with&nbsp;full&nbsp;algebraic&nbsp;universes&nbsp;supported&nbsp;everywhere)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;Universe&nbsp;polymorphism<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;Standard&nbsp;type&nbsp;theory&nbsp;with&nbsp;dependent&nbsp;products&nbsp;and&nbsp;let-ins<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;Inductive&nbsp;types&nbsp;and&nbsp;coinductive&nbsp;types<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;Constant&nbsp;and&nbsp;axiom&nbsp;declarations&nbsp;in&nbsp;a&nbsp;global&nbsp;environment&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Print</span> <a class="idref" href="MetaCoq.PCUIC.PCUICTyping.html#typing"><span class="id" title="inductive">typing</span></a>.<br/>

<br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="MetaCoq.PCUIC.PCUICTyping.html#type_Sort"><span class="id" title="constructor">type_Sort</span></a>.<br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="MetaCoq.PCUIC.PCUICTyping.html#type_LetIn"><span class="id" title="constructor">type_LetIn</span></a>.<br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="MetaCoq.PCUIC.PCUICTyping.html#type_Const"><span class="id" title="constructor">type_Const</span></a>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaCoq.PCUIC</span> <span class="id" title="keyword">Require</span> <a class="idref" href="MetaCoq.PCUIC.PCUICSR.html#"><span class="id" title="library">PCUICSR</span></a>.<br/>

<br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="MetaCoq.PCUIC.PCUICSR.html#subject_reduction"><span class="id" title="lemma">PCUICSR.subject_reduction</span></a>.<br/>

<br/>
</div>

<div class="doc">
Verified conversion and type-checking 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaCoq.SafeChecker</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaCoq.SafeChecker.PCUICErrors.html#"><span class="id" title="library">PCUICErrors</span></a> <a class="idref" href="MetaCoq.SafeChecker.PCUICWfEnv.html#"><span class="id" title="library">PCUICWfEnv</span></a> <a class="idref" href="MetaCoq.SafeChecker.PCUICWfEnvImpl.html#"><span class="id" title="library">PCUICWfEnvImpl</span></a> <a class="idref" href="MetaCoq.SafeChecker.PCUICTypeChecker.html#"><span class="id" title="library">PCUICTypeChecker</span></a> <a class="idref" href="MetaCoq.SafeChecker.PCUICSafeChecker.html#"><span class="id" title="library">PCUICSafeChecker</span></a> <a class="idref" href="MetaCoq.SafeChecker.PCUICSafeRetyping.html#"><span class="id" title="library">PCUICSafeRetyping</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaCoq.SafeCheckerPlugin</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">Loader</span>.<br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="MetaCoq.SafeChecker.PCUICSafeConversion.html#isconv_term_sound"><span class="id" title="lemma">PCUICSafeConversion.isconv_term_sound</span></a>.<br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="MetaCoq.SafeChecker.PCUICSafeConversion.html#isconv_term_complete"><span class="id" title="lemma">PCUICSafeConversion.isconv_term_complete</span></a>.<br/>

<br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="MetaCoq.SafeChecker.PCUICSafeChecker.html#infer_wf_env"><span class="id" title="definition">PCUICSafeChecker.infer_wf_env</span></a>.<br/>
</div>

<div class="doc">
Proof of completeness is near completion. 
<div class="paragraph"> </div>

 Verified retyping: from a term that is known to be well-typeable,
  compute its principal type. Very common in tactics to avoid retypechecking
  the whole term. 
</div>
<div class="code">
<span class="id" title="keyword">Check</span> <a class="idref" href="MetaCoq.SafeChecker.PCUICSafeRetyping.html#type_of"><span class="id" title="definition">type_of</span></a>.<br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="MetaCoq.SafeChecker.PCUICSafeRetyping.html#type_of_subtype"><span class="id" title="definition">type_of_subtype</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;Running&nbsp;the&nbsp;safe&nbsp;checker&nbsp;inside&nbsp;Coq&nbsp;*)</span><br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaCoq.Examples</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaCoq.Examples.metacoq_tour_prelude.html#"><span class="id" title="library">metacoq_tour_prelude</span></a>.<br/>

<br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="MetaCoq.Examples.metacoq_tour_prelude.html#check_inh"><span class="id" title="definition">check_inh</span></a>.<br/>

<br/>
</div>

<div class="doc">
We construct a proof of typing entirely within Coq, calling the typechecker to produce the derivation 
</div>
<div class="code">
<span class="comment">(*&nbsp;Lemma&nbsp;identity_typing&nbsp;(u&nbsp;:=&nbsp;Universe.make&nbsp;univ):<br/>
&nbsp;&nbsp;inh&nbsp;gctx_wf_env&nbsp;<span class="inlinecode"></span>&nbsp;(tProd&nbsp;(bNamed&nbsp;"s")&nbsp;(tSort&nbsp;u)&nbsp;(tImpl&nbsp;(tRel&nbsp;0)&nbsp;(tRel&nbsp;0))).<br/>
Proof.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;We&nbsp;construct&nbsp;a&nbsp;term&nbsp;*)</span><br/>
&nbsp;&nbsp;set&nbsp;(impl&nbsp;:=&nbsp;tLambda&nbsp;(bNamed&nbsp;"s")&nbsp;(tSort&nbsp;u)&nbsp;(tLambda&nbsp;bAnon&nbsp;(tRel&nbsp;0)&nbsp;(tRel&nbsp;0))).<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Show&nbsp;that&nbsp;the&nbsp;empty&nbsp;context&nbsp;is&nbsp;well-formed&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;assert&nbsp;(wfΓ&nbsp;:&nbsp;forall&nbsp;Σ0&nbsp;:&nbsp;global_env_ext,&nbsp;abstract_env_ext_rel&nbsp;gctx_wf_env&nbsp;Σ0&nbsp;-&gt;&nbsp;∥&nbsp;wf_local&nbsp;Σ0&nbsp;<span class="inlinecode"></span>&nbsp;∥)&nbsp;by&nbsp;do&nbsp;2&nbsp;constructor.<br/>
&nbsp;&nbsp;fill_inh&nbsp;impl.<br/>
Qed.&nbsp;*)</span><br/>

<br/>
</div>

<div class="doc">
The extracted typechecker also runs in OCaml 
</div>
<div class="code">
<span class="comment">(*&nbsp;FIXME:&nbsp;checker&nbsp;unusable&nbsp;in&nbsp;OCaml&nbsp;due&nbsp;to&nbsp;representation&nbsp;of&nbsp;universes&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;MetaCoq&nbsp;SafeCheck&nbsp;(fun&nbsp;x&nbsp;:&nbsp;nat&nbsp;=&gt;&nbsp;x&nbsp;+&nbsp;1).&nbsp;*)</span><br/>

<br/>
</div>

<div class="doc">
Erasure 
</div>
<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaCoq.ErasurePlugin</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaCoq.ErasurePlugin.Erasure.html#"><span class="id" title="library">Erasure</span></a> <a class="idref" href="MetaCoq.ErasurePlugin.Loader.html#"><span class="id" title="library">Loader</span></a>.<br/>

<br/>
</div>

<div class="doc">
Running erasure live in Coq 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a id="test" class="idref" href="#test"><span class="id" title="definition">test</span></a> (<a id="p:10" class="idref" href="#p:10"><span class="id" title="binder">p</span></a> : <a class="idref" href="MetaCoq.Template.Ast.html#Env.program"><span class="id" title="definition">Ast.Env.program</span></a>) : <a class="idref" href="MetaCoq.Utils.bytestring.html#string"><span class="id" title="abbreviation">string</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="MetaCoq.ErasurePlugin.Erasure.html#erase_and_print_template_program"><span class="id" title="definition">erase_and_print_template_program</span></a> <a class="idref" href="MetaCoq.Examples.metacoq_tour.html#p:10"><span class="id" title="variable">p</span></a>.<br/>

<br/>
<span class="id" title="var">MetaCoq</span> <span class="id" title="var">Quote</span> <span class="id" title="var">Recursively</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">zero</span> := 0.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="zerocst" class="idref" href="#zerocst"><span class="id" title="definition">zerocst</span></a> := <span class="id" title="keyword">Eval</span> <span class="id" title="tactic">lazy</span> <span class="id" title="tactic">in</span> <a class="idref" href="MetaCoq.Examples.metacoq_tour.html#test"><span class="id" title="definition">test</span></a> <a class="idref" href="MetaCoq.Examples.metacoq_tour.html#zero"><span class="id" title="definition">zero</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="singleton_elim" class="idref" href="#singleton_elim"><span class="id" title="definition">singleton_elim</span></a> :=<br/>
&nbsp;&nbsp;((<span class="id" title="keyword">fun</span> (<a id="X:11" class="idref" href="#X:11"><span class="id" title="binder">X</span></a> : <span class="id" title="keyword">Set</span>) (<a id="x:12" class="idref" href="#x:12"><span class="id" title="binder">x</span></a> : <a class="idref" href="MetaCoq.Examples.metacoq_tour.html#X:11"><span class="id" title="variable">X</span></a>) (<a id="e:13" class="idref" href="#e:13"><span class="id" title="binder">e</span></a> : <a class="idref" href="MetaCoq.Examples.metacoq_tour.html#x:12"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaCoq.Examples.metacoq_tour.html#x:12"><span class="id" title="variable">x</span></a>) ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="MetaCoq.Examples.metacoq_tour.html#e:13"><span class="id" title="variable">e</span></a> <span class="id" title="tactic">in</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <span class="id" title="var">_</span> <span class="id" title="var">x'</span> <span class="id" title="keyword">return</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Logic.html#eq_refl"><span class="id" title="constructor">eq_refl</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/V8.16.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>)).<br/>

<br/>
<span class="id" title="var">MetaCoq</span> <span class="id" title="var">Run</span> (<a class="idref" href="MetaCoq.Template.TemplateMonad.Core.html#tmEval"><span class="id" title="constructor">tmEval</span></a> <a class="idref" href="MetaCoq.Template.TemplateMonad.Common.html#lazy"><span class="id" title="constructor">lazy</span></a> <a class="idref" href="MetaCoq.Examples.metacoq_tour.html#singleton_elim"><span class="id" title="definition">singleton_elim</span></a> <a class="idref" href="MetaCoq.Utils.monad_utils.html#c0f7708df476ab63a78f53086f844619"><span class="id" title="notation">&gt;&gt;=</span></a> <a class="idref" href="MetaCoq.Template.TemplateMonad.Core.html#tmQuoteRec"><span class="id" title="definition">tmQuoteRec</span></a> <a class="idref" href="MetaCoq.Utils.monad_utils.html#c0f7708df476ab63a78f53086f844619"><span class="id" title="notation">&gt;&gt;=</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <a id="p:16" class="idref" href="#p:16"><span class="id" title="binder">p</span></a> ⇒ <a class="idref" href="MetaCoq.Template.TemplateMonad.Core.html#tmEval"><span class="id" title="constructor">tmEval</span></a> <a class="idref" href="MetaCoq.Template.TemplateMonad.Common.html#lazy"><span class="id" title="constructor">lazy</span></a> (<a class="idref" href="MetaCoq.Examples.metacoq_tour.html#test"><span class="id" title="definition">test</span></a> <a class="idref" href="MetaCoq.Examples.metacoq_tour.html#p:16"><span class="id" title="variable">p</span></a>) <a class="idref" href="MetaCoq.Utils.monad_utils.html#c0f7708df476ab63a78f53086f844619"><span class="id" title="notation">&gt;&gt;=</span></a> <a class="idref" href="MetaCoq.Template.TemplateMonad.Core.html#tmPrint"><span class="id" title="constructor">tmPrint</span></a>). <span class="comment">(*&nbsp;Optimized&nbsp;to&nbsp;remove&nbsp;match&nbsp;on&nbsp;Props&nbsp;*)</span><br/>

<br/>
<span class="id" title="var">MetaCoq</span> <span class="id" title="var">Erase</span> <a class="idref" href="MetaCoq.Examples.metacoq_tour.html#singleton_elim"><span class="id" title="definition">singleton_elim</span></a>.<br/>

<br/>
</div>

<div class="doc">
Conclusion: Status of MetaCoq

<div class="paragraph"> </div>

<ul class="doclist">
<li> Correctness and complete typechecker for (a large fragment of) Coq.

<div class="paragraph"> </div>


</li>
<li> All metatheory proofs are finished. Compared to Coq's implementation:

<div class="paragraph"> </div>

<ul class="doclist">
<li> full (max (i + k, j + l)) universe support (including a naïve acyclicity checking
      algorithm)

<div class="paragraph"> </div>


</li>
<li> partial support for SProp (in programs but not yet formalized typing rules)

<div class="paragraph"> </div>


</li>
<li> approximate cumulative inductive types checking (not yet up to reduction)

<div class="paragraph"> </div>


</li>
<li> missing eta-conversion: the plan is to use contravariant subtyping and eta-reduction,
      as in Coq CEP 47

    - missing template-polymorphism: we're studying a sort polymorphism extension
      (with G. Gilbert, K. Maillard and N. Tabareau) to subsume it completely.

    - missing modules and fast conversion machines.

  - Much work to come on the template-coq side to ease meta-programming.

  - Relation to CertiCoq: fast and verified correct erasure, not depending on type-checking
    (only retyping).

    + CertiCoq needs to have all constructors eta-expanded, a proof of the
      syntactic translation expanding constructors is in progress.

    + Otherwise the front-end part of CertiCoq is complete with proofs.

    + Future work: handling of primitive types (ints, floats, arrays, ...)



</li>
</ul>

</li>
</ul>
</div>
<div class="code">

<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
